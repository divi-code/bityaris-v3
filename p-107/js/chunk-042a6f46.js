import{U as P1}from"./app-a93d0564.js";import{dk as S1,dl as O1,dm as R1,dn as A1,dp as T1,dq as C1,dr as N1,ds as $1,dt as D1,du as F1,dv as L1,dw as eu,dx as qf,dy as ee,dz as Uf,dA as Bo,dB as j1,dC as zf,dD as M1,dE as Mo,dF as q1,dG as U1,dH as z1,dI as ds,dJ as k1,dK as kf,aA as Kr,aB as H1}from"./chunk-19a327d5.js";function tu(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function Hf(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?tu(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function zc(n,t){t||(t=n.reduce((a,u)=>a+u.length,0));const r=Hf(t);let s=0;for(const a of n)r.set(a,s),s+=a.length;return tu(r)}const yl={...S1,...O1,...R1,...A1,...T1,...C1,...N1,...$1,...D1,...F1};function Kf(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const vl=Kf("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),xc=Kf("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=Hf(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),Bf={utf8:vl,"utf-8":vl,hex:yl.base16,latin1:xc,ascii:xc,binary:xc,...yl};function dr(n,t="utf8"){const r=Bf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tu(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}function nr(n,t="utf8"){const r=Bf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):r.encoder.encode(n).substring(1)}const K1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Ut={},B1={get exports(){return Ut},set exports(n){Ut=n}},On=typeof Reflect=="object"?Reflect:null,ml=On&&typeof On.apply=="function"?On.apply:function(t,r,s){return Function.prototype.apply.call(t,r,s)},$o;On&&typeof On.ownKeys=="function"?$o=On.ownKeys:Object.getOwnPropertySymbols?$o=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:$o=function(t){return Object.getOwnPropertyNames(t)};function V1(n){console&&console.warn&&console.warn(n)}var Vf=Number.isNaN||function(t){return t!==t};function je(){je.init.call(this)}B1.exports=je;Ut.once=Q1;je.EventEmitter=je;je.prototype._events=void 0;je.prototype._eventsCount=0;je.prototype._maxListeners=void 0;var wl=10;function Vo(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(je,"defaultMaxListeners",{enumerable:!0,get:function(){return wl},set:function(n){if(typeof n!="number"||n<0||Vf(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");wl=n}});je.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};je.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Vf(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Gf(n){return n._maxListeners===void 0?je.defaultMaxListeners:n._maxListeners}je.prototype.getMaxListeners=function(){return Gf(this)};je.prototype.emit=function(t){for(var r=[],s=1;s<arguments.length;s++)r.push(arguments[s]);var a=t==="error",u=this._events;if(u!==void 0)a=a&&u.error===void 0;else if(!a)return!1;if(a){var f;if(r.length>0&&(f=r[0]),f instanceof Error)throw f;var g=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw g.context=f,g}var m=u[t];if(m===void 0)return!1;if(typeof m=="function")ml(m,this,r);else for(var y=m.length,E=Zf(m,y),s=0;s<y;++s)ml(E[s],this,r);return!0};function Wf(n,t,r,s){var a,u,f;if(Vo(r),u=n._events,u===void 0?(u=n._events=Object.create(null),n._eventsCount=0):(u.newListener!==void 0&&(n.emit("newListener",t,r.listener?r.listener:r),u=n._events),f=u[t]),f===void 0)f=u[t]=r,++n._eventsCount;else if(typeof f=="function"?f=u[t]=s?[r,f]:[f,r]:s?f.unshift(r):f.push(r),a=Gf(n),a>0&&f.length>a&&!f.warned){f.warned=!0;var g=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");g.name="MaxListenersExceededWarning",g.emitter=n,g.type=t,g.count=f.length,V1(g)}return n}je.prototype.addListener=function(t,r){return Wf(this,t,r,!1)};je.prototype.on=je.prototype.addListener;je.prototype.prependListener=function(t,r){return Wf(this,t,r,!0)};function G1(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Jf(n,t,r){var s={fired:!1,wrapFn:void 0,target:n,type:t,listener:r},a=G1.bind(s);return a.listener=r,s.wrapFn=a,a}je.prototype.once=function(t,r){return Vo(r),this.on(t,Jf(this,t,r)),this};je.prototype.prependOnceListener=function(t,r){return Vo(r),this.prependListener(t,Jf(this,t,r)),this};je.prototype.removeListener=function(t,r){var s,a,u,f,g;if(Vo(r),a=this._events,a===void 0)return this;if(s=a[t],s===void 0)return this;if(s===r||s.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete a[t],a.removeListener&&this.emit("removeListener",t,s.listener||r));else if(typeof s!="function"){for(u=-1,f=s.length-1;f>=0;f--)if(s[f]===r||s[f].listener===r){g=s[f].listener,u=f;break}if(u<0)return this;u===0?s.shift():W1(s,u),s.length===1&&(a[t]=s[0]),a.removeListener!==void 0&&this.emit("removeListener",t,g||r)}return this};je.prototype.off=je.prototype.removeListener;je.prototype.removeAllListeners=function(t){var r,s,a;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[t]),this;if(arguments.length===0){var u=Object.keys(s),f;for(a=0;a<u.length;++a)f=u[a],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=s[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(a=r.length-1;a>=0;a--)this.removeListener(t,r[a]);return this};function Qf(n,t,r){var s=n._events;if(s===void 0)return[];var a=s[t];return a===void 0?[]:typeof a=="function"?r?[a.listener||a]:[a]:r?J1(a):Zf(a,a.length)}je.prototype.listeners=function(t){return Qf(this,t,!0)};je.prototype.rawListeners=function(t){return Qf(this,t,!1)};je.listenerCount=function(n,t){return typeof n.listenerCount=="function"?n.listenerCount(t):Yf.call(n,t)};je.prototype.listenerCount=Yf;function Yf(n){var t=this._events;if(t!==void 0){var r=t[n];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}je.prototype.eventNames=function(){return this._eventsCount>0?$o(this._events):[]};function Zf(n,t){for(var r=new Array(t),s=0;s<t;++s)r[s]=n[s];return r}function W1(n,t){for(;t+1<n.length;t++)n[t]=n[t+1];n.pop()}function J1(n){for(var t=new Array(n.length),r=0;r<t.length;++r)t[r]=n[r].listener||n[r];return t}function Q1(n,t){return new Promise(function(r,s){function a(f){n.removeListener(t,u),s(f)}function u(){typeof n.removeListener=="function"&&n.removeListener("error",a),r([].slice.call(arguments))}Xf(n,t,u,{once:!0}),t!=="error"&&Y1(n,a,{once:!0})})}function Y1(n,t,r){typeof n.on=="function"&&Xf(n,"error",t,r)}function Xf(n,t,r,s){if(typeof n.on=="function")s.once?n.once(t,r):n.on(t,r);else if(typeof n.addEventListener=="function")n.addEventListener(t,function a(u){s.once&&n.removeEventListener(t,a),r(u)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}const Z1=":";function X1(n){const[t,r]=n.split(Z1);return{namespace:t,reference:r}}function ew(n,t=[]){const r=[];return Object.keys(n).forEach(s=>{if(t.length&&!t.includes(s))return;const a=n[s];r.push(...a.accounts)}),r}function ep(n,t){return n.includes(":")?[n]:t.chains||[]}const tp="base10",ir="base16",kc="base64pad",ru="utf8",rp=0,Zi=1,tw=0,bl=1,Hc=12,iu=32;function rw(){const n=Uf.generateKeyPair();return{privateKey:nr(n.secretKey,ir),publicKey:nr(n.publicKey,ir)}}function Kc(){const n=Bo.randomBytes(iu);return nr(n,ir)}function iw(n,t){const r=Uf.sharedKey(dr(n,ir),dr(t,ir),!0),s=new j1(eu.SHA256,r).expand(iu);return nr(s,ir)}function nw(n){const t=eu.hash(dr(n,ir));return nr(t,ir)}function Rn(n){const t=eu.hash(dr(n,ru));return nr(t,ir)}function sw(n){return dr(`${n}`,tp)}function gs(n){return Number(nr(n,tp))}function ow(n){const t=sw(typeof n.type<"u"?n.type:rp);if(gs(t)===Zi&&typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof n.senderPublicKey<"u"?dr(n.senderPublicKey,ir):void 0,s=typeof n.iv<"u"?dr(n.iv,ir):Bo.randomBytes(Hc),a=new zf.ChaCha20Poly1305(dr(n.symKey,ir)).seal(s,dr(n.message,ru));return cw({type:t,sealed:a,iv:s,senderPublicKey:r})}function aw(n){const t=new zf.ChaCha20Poly1305(dr(n.symKey,ir)),{sealed:r,iv:s}=qo(n.encoded),a=t.open(s,r);if(a===null)throw new Error("Failed to decrypt");return nr(a,ru)}function cw(n){if(gs(n.type)===Zi){if(typeof n.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return nr(zc([n.type,n.senderPublicKey,n.iv,n.sealed]),kc)}return nr(zc([n.type,n.iv,n.sealed]),kc)}function qo(n){const t=dr(n,kc),r=t.slice(tw,bl),s=bl;if(gs(r)===Zi){const g=s+iu,m=g+Hc,y=t.slice(s,g),E=t.slice(g,m),x=t.slice(m);return{type:r,sealed:x,iv:E,senderPublicKey:y}}const a=s+Hc,u=t.slice(s,a),f=t.slice(a);return{type:r,sealed:f,iv:u}}function uw(n,t){const r=qo(n);return ip({type:gs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?nr(r.senderPublicKey,ir):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function ip(n){const t=(n==null?void 0:n.type)||rp;if(t===Zi){if(typeof(n==null?void 0:n.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(n==null?void 0:n.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:n==null?void 0:n.senderPublicKey,receiverPublicKey:n==null?void 0:n.receiverPublicKey}}function _l(n){return n.type===Zi&&typeof n.senderPublicKey=="string"&&typeof n.receiverPublicKey=="string"}var hw=Object.defineProperty,El=Object.getOwnPropertySymbols,lw=Object.prototype.hasOwnProperty,fw=Object.prototype.propertyIsEnumerable,Il=(n,t,r)=>t in n?hw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,xl=(n,t)=>{for(var r in t||(t={}))lw.call(t,r)&&Il(n,r,t[r]);if(El)for(var r of El(t))fw.call(t,r)&&Il(n,r,t[r]);return n};const pw="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},dw="js";function nu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Cn(){return!M1()&&!!qf()&&navigator.product===pw}function Nn(){return!nu()&&!!qf()}function ys(){return Cn()?Er.reactNative:nu()?Er.node:Nn()?Er.browser:Er.unknown}function gw(){var n;try{return Cn()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(n=global.Application)==null?void 0:n.applicationId:void 0}catch{return}}function yw(n,t){let r=Mo.parse(n);return r=xl(xl({},r),t),n=Mo.stringify(r),n}function vw(){return L1()||{name:"",description:"",url:"",icons:[""]}}function mw(){if(ys()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:s}=global.Platform;return[r,s].join("-")}const n=q1();if(n===null)return"unknown";const t=n.os?n.os.replace(" ","").toLowerCase():"unknown";return n.type==="browser"?[t,n.name,n.version].join("-"):[t,n.version].join("-")}function ww(){var n;const t=ys();return t===Er.browser?[t,((n=U1())==null?void 0:n.host)||"unknown"].join(":"):t}function bw(n,t,r){const s=mw(),a=ww();return[[n,t].join("-"),[dw,r].join("-"),s,a].join("/")}function _w({protocol:n,version:t,relayUrl:r,sdkVersion:s,auth:a,projectId:u,useOnCloseEvent:f,bundleId:g}){const m=r.split("?"),y=bw(n,t,s),E={auth:a,ua:y,projectId:u,useOnCloseEvent:f||void 0,origin:g||void 0},x=yw(m[1]||"",E);return m[0]+"?"+x}function Qi(n,t){return n.filter(r=>t.includes(r)).length===n.length}function np(n){return Object.fromEntries(n.entries())}function sp(n){return new Map(Object.entries(n))}function Pn(n=ee.FIVE_MINUTES,t){const r=ee.toMiliseconds(n||ee.FIVE_MINUTES);let s,a,u;return{resolve:f=>{u&&s&&(clearTimeout(u),s(f))},reject:f=>{u&&a&&(clearTimeout(u),a(f))},done:()=>new Promise((f,g)=>{u=setTimeout(()=>{g(new Error(t))},r),s=f,a=g})}}function ls(n,t,r){return new Promise(async(s,a)=>{const u=setTimeout(()=>a(new Error(r)),t);try{const f=await n;s(f)}catch(f){a(f)}clearTimeout(u)})}function op(n,t){if(typeof t=="string"&&t.startsWith(`${n}:`))return t;if(n.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(n.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${n}`)}function Ew(n){return op("topic",n)}function Iw(n){return op("id",n)}function ap(n){const[t,r]=n.split(":"),s={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")s.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))s.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return s}function kr(n,t){return ee.fromMiliseconds((t||Date.now())+ee.toMiliseconds(n))}function Ti(n){return Date.now()>=ee.toMiliseconds(n)}function Ct(n,t){return`${n}${t?`:${t}`:""}`}function Pc(n=[],t=[]){return[...new Set([...n,...t])]}async function xw({id:n,topic:t,wcDeepLink:r}){try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r;let a=s==null?void 0:s.href;if(typeof a!="string")return;a.endsWith("/")&&(a=a.slice(0,-1));const u=`${a}/wc?requestId=${n}&sessionTopic=${t}`,f=ys();f===Er.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(s){console.error(s)}}async function Pw(n,t){try{return await n.getItem(t)||(Nn()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const Sw="irn";function Bc(n){return(n==null?void 0:n.relay)||{protocol:Sw}}function Do(n){const t=K1[n];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${n}`);return t}var Ow=Object.defineProperty,Pl=Object.getOwnPropertySymbols,Rw=Object.prototype.hasOwnProperty,Aw=Object.prototype.propertyIsEnumerable,Sl=(n,t,r)=>t in n?Ow(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Tw=(n,t)=>{for(var r in t||(t={}))Rw.call(t,r)&&Sl(n,r,t[r]);if(Pl)for(var r of Pl(t))Aw.call(t,r)&&Sl(n,r,t[r]);return n};function Cw(n,t="-"){const r={},s="relay"+t;return Object.keys(n).forEach(a=>{if(a.startsWith(s)){const u=a.replace(s,""),f=n[a];r[u]=f}}),r}function Ol(n){n=n.includes("wc://")?n.replace("wc://",""):n,n=n.includes("wc:")?n.replace("wc:",""):n;const t=n.indexOf(":"),r=n.indexOf("?")!==-1?n.indexOf("?"):void 0,s=n.substring(0,t),a=n.substring(t+1,r).split("@"),u=typeof r<"u"?n.substring(r):"",f=Mo.parse(u);return{protocol:s,topic:Nw(a[0]),version:parseInt(a[1],10),symKey:f.symKey,relay:Cw(f)}}function Nw(n){return n.startsWith("//")?n.substring(2):n}function $w(n,t="-"){const r="relay",s={};return Object.keys(n).forEach(a=>{const u=r+t+a;n[a]&&(s[u]=n[a])}),s}function Dw(n){return`${n.protocol}:${n.topic}@${n.version}?`+Mo.stringify(Tw({symKey:n.symKey},$w(n.relay)))}function $n(n){const t=[];return n.forEach(r=>{const[s,a]=r.split(":");t.push(`${s}:${a}`)}),t}function Fw(n){const t=[];return Object.values(n).forEach(r=>{t.push(...$n(r.accounts))}),t}function Lw(n,t){const r=[];return Object.values(n).forEach(s=>{$n(s.accounts).includes(t)&&r.push(...s.methods)}),r}function jw(n,t){const r=[];return Object.values(n).forEach(s=>{$n(s.accounts).includes(t)&&r.push(...s.events)}),r}function Mw(n,t){const r=Fo(n,t);if(r)throw new Error(r.message);const s={};for(const[a,u]of Object.entries(n))s[a]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return s}function su(n){return n.includes(":")}function as(n){return su(n)?n.split(":")[0]:n}const qw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Uw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function B(n,t){const{message:r,code:s}=Uw[n];return{message:t?`${r} ${t}`:r,code:s}}function bt(n,t){const{message:r,code:s}=qw[n];return{message:t?`${r} ${t}`:r,code:s}}function Xr(n,t){return Array.isArray(n)?typeof t<"u"&&n.length?n.every(t):!0:!1}function An(n){return Object.getPrototypeOf(n)===Object.prototype&&Object.keys(n).length}function rr(n){return typeof n>"u"}function qt(n,t){return t&&rr(n)?!0:typeof n=="string"&&!!n.trim().length}function ou(n,t){return t&&rr(n)?!0:typeof n=="number"&&!isNaN(n)}function zw(n,t){const{requiredNamespaces:r}=t,s=Object.keys(n.namespaces),a=Object.keys(r);let u=!0;return Qi(a,s)?(s.forEach(f=>{const{accounts:g,methods:m,events:y}=n.namespaces[f],E=$n(g),x=r[f];(!Qi(ep(f,x),E)||!Qi(x.methods,m)||!Qi(x.events,y))&&(u=!1)}),u):!1}function Uo(n){return qt(n,!1)&&n.includes(":")?n.split(":").length===2:!1}function kw(n){if(qt(n,!1)&&n.includes(":")){const t=n.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Uo(r)}}return!1}function Hw(n){if(qt(n,!1))try{return typeof new URL(n)<"u"}catch{return!1}return!1}function Kw(n){var t;return(t=n==null?void 0:n.proposer)==null?void 0:t.publicKey}function Bw(n){return n==null?void 0:n.topic}function Vw(n,t){let r=null;return qt(n==null?void 0:n.publicKey,!1)||(r=B("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Rl(n){let t=!0;return Xr(n)?n.length&&(t=n.every(r=>qt(r,!1))):t=!1,t}function Gw(n,t,r){let s=null;return Xr(t)&&t.length?t.forEach(a=>{s||Uo(a)||(s=bt("UNSUPPORTED_CHAINS",`${r}, chain ${a} should be a string and conform to "namespace:chainId" format`))}):Uo(n)||(s=bt("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function Ww(n,t,r){let s=null;return Object.entries(n).forEach(([a,u])=>{if(s)return;const f=Gw(a,ep(a,u),`${t} ${r}`);f&&(s=f)}),s}function Jw(n,t){let r=null;return Xr(n)?n.forEach(s=>{r||kw(s)||(r=bt("UNSUPPORTED_ACCOUNTS",`${t}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):r=bt("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Qw(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Jw(s==null?void 0:s.accounts,`${t} namespace`);a&&(r=a)}),r}function Yw(n,t){let r=null;return Rl(n==null?void 0:n.methods)?Rl(n==null?void 0:n.events)||(r=bt("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=bt("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function cp(n,t){let r=null;return Object.values(n).forEach(s=>{if(r)return;const a=Yw(s,`${t}, namespace`);a&&(r=a)}),r}function Zw(n,t,r){let s=null;if(n&&An(n)){const a=cp(n,t);a&&(s=a);const u=Ww(n,t,r);u&&(s=u)}else s=B("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return s}function Fo(n,t){let r=null;if(n&&An(n)){const s=cp(n,t);s&&(r=s);const a=Qw(n,t);a&&(r=a)}else r=B("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function up(n){return qt(n.protocol,!0)}function Xw(n,t){let r=!1;return t&&!n?r=!0:n&&Xr(n)&&n.length&&n.forEach(s=>{r=up(s)}),r}function eb(n){return typeof n=="number"}function pr(n){return typeof n<"u"&&typeof n!==null}function tb(n){return!(!n||typeof n!="object"||!n.code||!ou(n.code,!1)||!n.message||!qt(n.message,!1))}function rb(n){return!(rr(n)||!qt(n.method,!1))}function ib(n){return!(rr(n)||rr(n.result)&&rr(n.error)||!ou(n.id,!1)||!qt(n.jsonrpc,!1))}function nb(n){return!(rr(n)||!qt(n.name,!1))}function Al(n,t){return!(!Uo(t)||!Fw(n).includes(t))}function sb(n,t,r){return qt(r,!1)?Lw(n,t).includes(r):!1}function ob(n,t,r){return qt(r,!1)?jw(n,t).includes(r):!1}function Tl(n,t,r){let s=null;const a=ab(n),u=cb(t),f=Object.keys(a),g=Object.keys(u),m=Cl(Object.keys(n)),y=Cl(Object.keys(t)),E=m.filter(x=>!y.includes(x));return E.length&&(s=B("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${E.toString()}
      Received: ${Object.keys(t).toString()}`)),Qi(f,g)||(s=B("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(x=>{if(!x.includes(":")||s)return;const $=$n(t[x].accounts);$.includes(x)||(s=B("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${x}
        Required: ${x}
        Approved: ${$.toString()}`))}),f.forEach(x=>{s||(Qi(a[x].methods,u[x].methods)?Qi(a[x].events,u[x].events)||(s=B("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${x}`)):s=B("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${x}`))}),s}function ab(n){const t={};return Object.keys(n).forEach(r=>{var s;r.includes(":")?t[r]=n[r]:(s=n[r].chains)==null||s.forEach(a=>{t[a]={methods:n[r].methods,events:n[r].events}})}),t}function Cl(n){return[...new Set(n.map(t=>t.includes(":")?t.split(":")[0]:t))]}function cb(n){const t={};return Object.keys(n).forEach(r=>{if(r.includes(":"))t[r]=n[r];else{const s=$n(n[r].accounts);s==null||s.forEach(a=>{t[a]={accounts:n[r].accounts.filter(u=>u.includes(`${a}:`)),methods:n[r].methods,events:n[r].events}})}}),t}function ub(n,t){return ou(n,!1)&&n<=t.max&&n>=t.min}function Nl(){const n=ys();return new Promise(t=>{switch(n){case Er.browser:t(hb());break;case Er.reactNative:t(lb());break;case Er.node:t(fb());break;default:t(!0)}})}function hb(){return Nn()&&(navigator==null?void 0:navigator.onLine)}async function lb(){if(Cn()&&typeof global<"u"&&global!=null&&global.NetInfo){const n=await(global==null?void 0:global.NetInfo.fetch());return n==null?void 0:n.isConnected}return!0}function fb(){return!0}function pb(n){switch(ys()){case Er.browser:db(n);break;case Er.reactNative:gb(n);break}}function db(n){!Cn()&&Nn()&&(window.addEventListener("online",()=>n(!0)),window.addEventListener("offline",()=>n(!1)))}function gb(n){Cn()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>n(t==null?void 0:t.isConnected)))}const Sc={};let So=class{static get(t){return Sc[t]}static set(t,r){Sc[t]=r}static delete(t){delete Sc[t]}};const yb=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,vb=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,mb=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function wb(n,t){if(n==="__proto__"||n==="constructor"&&t&&typeof t=="object"&&"prototype"in t){bb(n);return}return t}function bb(n){console.warn(`[destr] Dropping "${n}" key to prevent prototype pollution.`)}function Oo(n,t={}){if(typeof n!="string")return n;const r=n.trim();if(n[0]==='"'&&n.endsWith('"')&&!n.includes("\\"))return r.slice(1,-1);if(r.length<=9){const s=r.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!mb.test(n)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return n}try{if(yb.test(n)||vb.test(n)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(n,wb)}return JSON.parse(n)}catch(s){if(t.strict)throw s;return n}}function _b(n){return!n||typeof n.then!="function"?Promise.resolve(n):n}function Mt(n,...t){try{return _b(n(...t))}catch(r){return Promise.reject(r)}}function Eb(n){const t=typeof n;return n===null||t!=="object"&&t!=="function"}function Ib(n){const t=Object.getPrototypeOf(n);return!t||t.isPrototypeOf(Object)}function Lo(n){if(Eb(n))return String(n);if(Ib(n)||Array.isArray(n))return JSON.stringify(n);if(typeof n.toJSON=="function")return Lo(n.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function hp(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Vc="base64:";function xb(n){if(typeof n=="string")return n;hp();const t=Buffer.from(n).toString("base64");return Vc+t}function Pb(n){return typeof n!="string"||!n.startsWith(Vc)?n:(hp(),Buffer.from(n.slice(Vc.length),"base64"))}function fr(n){return n?n.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Sb(...n){return fr(n.join(":"))}function Ro(n){return n=fr(n),n?n+":":""}const Ob="memory",Rb=()=>{const n=new Map;return{name:Ob,options:{},hasItem(t){return n.has(t)},getItem(t){return n.get(t)??null},getItemRaw(t){return n.get(t)??null},setItem(t,r){n.set(t,r)},setItemRaw(t,r){n.set(t,r)},removeItem(t){n.delete(t)},getKeys(){return Array.from(n.keys())},clear(){n.clear()},dispose(){n.clear()}}};function Ab(n={}){const t={mounts:{"":n.driver||Rb()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const E of t.mountpoints)if(y.startsWith(E))return{base:E,relativeKey:y.slice(E.length),driver:t.mounts[E]};return{base:"",relativeKey:y,driver:t.mounts[""]}},s=(y,E)=>t.mountpoints.filter(x=>x.startsWith(y)||E&&y.startsWith(x)).map(x=>({relativeBase:y.length>x.length?y.slice(x.length):void 0,mountpoint:x,driver:t.mounts[x]})),a=(y,E)=>{if(t.watching){E=fr(E);for(const x of t.watchListeners)x(y,E)}},u=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await $l(t.mounts[y],a,y)}},f=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},g=(y,E,x)=>{const $=new Map,L=T=>{let Y=$.get(T.base);return Y||(Y={driver:T.driver,base:T.base,items:[]},$.set(T.base,Y)),Y};for(const T of y){const Y=typeof T=="string",re=fr(Y?T:T.key),oe=Y?void 0:T.value,ce=Y||!T.options?E:{...E,...T.options},ae=r(re);L(ae).items.push({key:re,value:oe,relativeKey:ae.relativeKey,options:ce})}return Promise.all([...$.values()].map(T=>x(T))).then(T=>T.flat())},m={hasItem(y,E={}){y=fr(y);const{relativeKey:x,driver:$}=r(y);return Mt($.hasItem,x,E)},getItem(y,E={}){y=fr(y);const{relativeKey:x,driver:$}=r(y);return Mt($.getItem,x,E).then(L=>Oo(L))},getItems(y,E){return g(y,E,x=>x.driver.getItems?Mt(x.driver.getItems,x.items.map($=>({key:$.relativeKey,options:$.options})),E).then($=>$.map(L=>({key:Sb(x.base,L.key),value:Oo(L.value)}))):Promise.all(x.items.map($=>Mt(x.driver.getItem,$.relativeKey,$.options).then(L=>({key:$.key,value:Oo(L)})))))},getItemRaw(y,E={}){y=fr(y);const{relativeKey:x,driver:$}=r(y);return $.getItemRaw?Mt($.getItemRaw,x,E):Mt($.getItem,x,E).then(L=>Pb(L))},async setItem(y,E,x={}){if(E===void 0)return m.removeItem(y);y=fr(y);const{relativeKey:$,driver:L}=r(y);L.setItem&&(await Mt(L.setItem,$,Lo(E),x),L.watch||a("update",y))},async setItems(y,E){await g(y,E,async x=>{if(x.driver.setItems)return Mt(x.driver.setItems,x.items.map($=>({key:$.relativeKey,value:Lo($.value),options:$.options})),E);x.driver.setItem&&await Promise.all(x.items.map($=>Mt(x.driver.setItem,$.relativeKey,Lo($.value),$.options)))})},async setItemRaw(y,E,x={}){if(E===void 0)return m.removeItem(y,x);y=fr(y);const{relativeKey:$,driver:L}=r(y);if(L.setItemRaw)await Mt(L.setItemRaw,$,E,x);else if(L.setItem)await Mt(L.setItem,$,xb(E),x);else return;L.watch||a("update",y)},async removeItem(y,E={}){typeof E=="boolean"&&(E={removeMeta:E}),y=fr(y);const{relativeKey:x,driver:$}=r(y);$.removeItem&&(await Mt($.removeItem,x,E),(E.removeMeta||E.removeMata)&&await Mt($.removeItem,x+"$",E),$.watch||a("remove",y))},async getMeta(y,E={}){typeof E=="boolean"&&(E={nativeOnly:E}),y=fr(y);const{relativeKey:x,driver:$}=r(y),L=Object.create(null);if($.getMeta&&Object.assign(L,await Mt($.getMeta,x,E)),!E.nativeOnly){const T=await Mt($.getItem,x+"$",E).then(Y=>Oo(Y));T&&typeof T=="object"&&(typeof T.atime=="string"&&(T.atime=new Date(T.atime)),typeof T.mtime=="string"&&(T.mtime=new Date(T.mtime)),Object.assign(L,T))}return L},setMeta(y,E,x={}){return this.setItem(y+"$",E,x)},removeMeta(y,E={}){return this.removeItem(y+"$",E)},async getKeys(y,E={}){y=Ro(y);const x=s(y,!0);let $=[];const L=[];for(const T of x){const re=(await Mt(T.driver.getKeys,T.relativeBase,E)).map(oe=>T.mountpoint+fr(oe)).filter(oe=>!$.some(ce=>oe.startsWith(ce)));L.push(...re),$=[T.mountpoint,...$.filter(oe=>!oe.startsWith(T.mountpoint))]}return y?L.filter(T=>T.startsWith(y)&&!T.endsWith("$")):L.filter(T=>!T.endsWith("$"))},async clear(y,E={}){y=Ro(y),await Promise.all(s(y,!1).map(async x=>{if(x.driver.clear)return Mt(x.driver.clear,x.relativeBase,E);if(x.driver.removeItem){const $=await x.driver.getKeys(x.relativeBase||"",E);return Promise.all($.map(L=>x.driver.removeItem(L,E)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>Dl(y)))},async watch(y){return await u(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(E=>E!==y),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(y,E){if(y=Ro(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((x,$)=>$.length-x.length)),t.mounts[y]=E,t.watching&&Promise.resolve($l(E,a,y)).then(x=>{t.unwatch[y]=x}).catch(console.error),m},async unmount(y,E=!0){y=Ro(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&(t.unwatch[y](),delete t.unwatch[y]),E&&await Dl(t.mounts[y]),t.mountpoints=t.mountpoints.filter(x=>x!==y),delete t.mounts[y])},getMount(y=""){y=fr(y)+":";const E=r(y);return{driver:E.driver,base:E.base}},getMounts(y="",E={}){return y=fr(y),s(y,E.parents).map($=>({driver:$.driver,base:$.mountpoint}))}};return m}function $l(n,t,r){return n.watch?n.watch((s,a)=>t(s,r+a)):()=>{}}async function Dl(n){typeof n.dispose=="function"&&await Mt(n.dispose)}function Xi(n){return new Promise((t,r)=>{n.oncomplete=n.onsuccess=()=>t(n.result),n.onabort=n.onerror=()=>r(n.error)})}function lp(n,t){const r=indexedDB.open(n);r.onupgradeneeded=()=>r.result.createObjectStore(t);const s=Xi(r);return(a,u)=>s.then(f=>u(f.transaction(t,a).objectStore(t)))}let Oc;function vs(){return Oc||(Oc=lp("keyval-store","keyval")),Oc}function Fl(n,t=vs()){return t("readonly",r=>Xi(r.get(n)))}function Tb(n,t,r=vs()){return r("readwrite",s=>(s.put(t,n),Xi(s.transaction)))}function Cb(n,t=vs()){return t("readwrite",r=>(r.delete(n),Xi(r.transaction)))}function Nb(n=vs()){return n("readwrite",t=>(t.clear(),Xi(t.transaction)))}function $b(n,t){return n.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Xi(n.transaction)}function Db(n=vs()){return n("readonly",t=>{if(t.getAllKeys)return Xi(t.getAllKeys());const r=[];return $b(t,s=>r.push(s.key)).then(()=>r)})}const Fb=n=>JSON.stringify(n,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),Lb=n=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=n.replace(t,'$1"$2n"$3');return JSON.parse(r,(s,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function ms(n){if(typeof n!="string")throw new Error(`Cannot safe json parse value of type ${typeof n}`);try{return Lb(n)}catch{return n}}function Yi(n){return typeof n=="string"?n:Fb(n)||""}const jb="idb-keyval";var Mb=(n={})=>{const t=n.base&&n.base.length>0?`${n.base}:`:"",r=a=>t+a;let s;return n.dbName&&n.storeName&&(s=lp(n.dbName,n.storeName)),{name:jb,options:n,async hasItem(a){return!(typeof await Fl(r(a),s)>"u")},async getItem(a){return await Fl(r(a),s)??null},setItem(a,u){return Tb(r(a),u,s)},removeItem(a){return Cb(r(a),s)},getKeys(){return Db(s)},clear(){return Nb(s)}}};const qb="WALLET_CONNECT_V2_INDEXED_DB",Ub="keyvaluestorage";let zb=class{constructor(){this.indexedDb=Ab({driver:Mb({dbName:qb,storeName:Ub})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Yi(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Rc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},jo={exports:{}};(function(){let n;function t(){}n=t,n.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},n.prototype.setItem=function(r,s){this[r]=String(s)},n.prototype.removeItem=function(r){delete this[r]},n.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(s){r[s]=void 0,delete r[s]})},n.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},n.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Rc<"u"&&Rc.localStorage?jo.exports=Rc.localStorage:typeof window<"u"&&window.localStorage?jo.exports=window.localStorage:jo.exports=new t})();function kb(n){var t;return[n[0],ms((t=n[1])!=null?t:"")]}class Hb{constructor(){this.localStorage=jo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(kb)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ms(r)}async setItem(t,r){this.localStorage.setItem(t,Yi(r))}async removeItem(t){this.localStorage.removeItem(t)}}const Kb="wc_storage_version",Ll=1,Bb=async(n,t,r)=>{const s=Kb,a=await t.getItem(s);if(a&&a>=Ll){r(t);return}const u=await n.getKeys();if(!u.length){r(t);return}const f=[];for(;u.length;){const g=u.shift();if(!g)continue;const m=g.toLowerCase();if(m.includes("wc@")||m.includes("walletconnect")||m.includes("wc_")||m.includes("wallet_connect")){const y=await n.getItem(g);await t.setItem(g,y),f.push(g)}}await t.setItem(s,Ll),r(t),Vb(n,f)},Vb=async(n,t)=>{t.length&&t.forEach(async r=>{await n.removeItem(r)})};let Gb=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new Hb;this.storage=t;try{const r=new zb;Bb(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Dn={},es={},Ac={},ts={};class en{}const Wb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:en},Symbol.toStringTag,{value:"Module"})),Jb=z1(Wb);var jl;function Qb(){if(jl)return ts;jl=1,Object.defineProperty(ts,"__esModule",{value:!0}),ts.IHeartBeat=void 0;const n=Jb;class t extends n.IEvents{constructor(s){super()}}return ts.IHeartBeat=t,ts}var Ml;function fp(){return Ml||(Ml=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ds.__exportStar(Qb(),n)}(Ac)),Ac}var Tc={},Ji={},ql;function Yb(){if(ql)return Ji;ql=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.HEARTBEAT_EVENTS=Ji.HEARTBEAT_INTERVAL=void 0;const n=ee;return Ji.HEARTBEAT_INTERVAL=n.FIVE_SECONDS,Ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ji}var Ul;function pp(){return Ul||(Ul=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),ds.__exportStar(Yb(),n)}(Tc)),Tc}var zl;function Zb(){if(zl)return es;zl=1,Object.defineProperty(es,"__esModule",{value:!0}),es.HeartBeat=void 0;const n=ds,t=Ut,r=ee,s=fp(),a=pp();class u extends s.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||a.HEARTBEAT_INTERVAL}static init(g){return n.__awaiter(this,void 0,void 0,function*(){const m=new u(g);return yield m.init(),m})}init(){return n.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,m){this.events.on(g,m)}once(g,m){this.events.once(g,m)}off(g,m){this.events.off(g,m)}removeListener(g,m){this.events.removeListener(g,m)}initialize(){return n.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return es.HeartBeat=u,es}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ds;t.__exportStar(Zb(),n),t.__exportStar(fp(),n),t.__exportStar(pp(),n)})(Dn);function Xb(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}var e_=t_;function t_(n,t,r){var s=r&&r.stringify||Xb,a=1;if(typeof n=="object"&&n!==null){var u=t.length+a;if(u===1)return n;var f=new Array(u);f[0]=s(n);for(var g=1;g<u;g++)f[g]=s(t[g]);return f.join(" ")}if(typeof n!="string")return n;var m=t.length;if(m===0)return n;for(var y="",E=1-a,x=-1,$=n&&n.length||0,L=0;L<$;){if(n.charCodeAt(L)===37&&L+1<$){switch(x=x>-1?x:0,n.charCodeAt(L+1)){case 100:case 102:if(E>=m||t[E]==null)break;x<L&&(y+=n.slice(x,L)),y+=Number(t[E]),x=L+2,L++;break;case 105:if(E>=m||t[E]==null)break;x<L&&(y+=n.slice(x,L)),y+=Math.floor(Number(t[E])),x=L+2,L++;break;case 79:case 111:case 106:if(E>=m||t[E]===void 0)break;x<L&&(y+=n.slice(x,L));var T=typeof t[E];if(T==="string"){y+="'"+t[E]+"'",x=L+2,L++;break}if(T==="function"){y+=t[E].name||"<anonymous>",x=L+2,L++;break}y+=s(t[E]),x=L+2,L++;break;case 115:if(E>=m)break;x<L&&(y+=n.slice(x,L)),y+=String(t[E]),x=L+2,L++;break;case 37:x<L&&(y+=n.slice(x,L)),y+="%",x=L+2,L++,E--;break}++E}++L}return x===-1?n:(x<$&&(y+=n.slice(x)),y)}const kl=e_;var Go=Zr;const fs=l_().console||{},r_={mapHttpRequest:Ao,mapHttpResponse:Ao,wrapRequestSerializer:Cc,wrapResponseSerializer:Cc,wrapErrorSerializer:Cc,req:Ao,res:Ao,err:a_};function i_(n,t){return Array.isArray(n)?n.filter(function(s){return s!=="!stdSerializers.err"}):n===!0?Object.keys(t):!1}function Zr(n){n=n||{},n.browser=n.browser||{};const t=n.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=n.browser.write||fs;n.browser.write&&(n.browser.asObject=!0);const s=n.serializers||{},a=i_(n.browser.serialize,s);let u=n.browser.serialize;Array.isArray(n.browser.serialize)&&n.browser.serialize.indexOf("!stdSerializers.err")>-1&&(u=!1);const f=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),n.enabled===!1&&(n.level="silent");const g=n.level||"info",m=Object.create(r);m.log||(m.log=ps),Object.defineProperty(m,"levelVal",{get:E}),Object.defineProperty(m,"level",{get:x,set:$});const y={transmit:t,serialize:a,asObject:n.browser.asObject,levels:f,timestamp:c_(n)};m.levels=Zr.levels,m.level=g,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=ps,m.serializers=s,m._serialize=a,m._stdErrSerialize=u,m.child=L,t&&(m._logEvent=Gc());function E(){return this.level==="silent"?1/0:this.levels.values[this.level]}function x(){return this._level}function $(T){if(T!=="silent"&&!this.levels.values[T])throw Error("unknown level "+T);this._level=T,In(y,m,"error","log"),In(y,m,"fatal","error"),In(y,m,"warn","error"),In(y,m,"info","log"),In(y,m,"debug","log"),In(y,m,"trace","log")}function L(T,Y){if(!T)throw new Error("missing bindings for child Pino");Y=Y||{},a&&T.serializers&&(Y.serializers=T.serializers);const re=Y.serializers;if(a&&re){var oe=Object.assign({},s,re),ce=n.browser.serialize===!0?Object.keys(oe):a;delete T.serializers,Wo([T],ce,oe,this._stdErrSerialize)}function ae(te){this._childLevel=(te._childLevel|0)+1,this.error=xn(te,T,"error"),this.fatal=xn(te,T,"fatal"),this.warn=xn(te,T,"warn"),this.info=xn(te,T,"info"),this.debug=xn(te,T,"debug"),this.trace=xn(te,T,"trace"),oe&&(this.serializers=oe,this._serialize=ce),t&&(this._logEvent=Gc([].concat(te._logEvent.bindings,T)))}return ae.prototype=this,new ae(this)}return m}Zr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Zr.stdSerializers=r_;Zr.stdTimeFunctions=Object.assign({},{nullTime:dp,epochTime:gp,unixTime:u_,isoTime:h_});function In(n,t,r,s){const a=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?ps:a[r]?a[r]:fs[r]||fs[s]||ps,n_(n,t,r)}function n_(n,t,r){!n.transmit&&t[r]===ps||(t[r]=function(s){return function(){const u=n.timestamp(),f=new Array(arguments.length),g=Object.getPrototypeOf&&Object.getPrototypeOf(this)===fs?fs:this;for(var m=0;m<f.length;m++)f[m]=arguments[m];if(n.serialize&&!n.asObject&&Wo(f,this._serialize,this.serializers,this._stdErrSerialize),n.asObject?s.call(g,s_(this,r,f,u)):s.apply(g,f),n.transmit){const y=n.transmit.level||t.level,E=Zr.levels.values[y],x=Zr.levels.values[r];if(x<E)return;o_(this,{ts:u,methodLevel:r,methodValue:x,transmitLevel:y,transmitValue:Zr.levels.values[n.transmit.level||t.level],send:n.transmit.send,val:t.levelVal},f)}}}(t[r]))}function s_(n,t,r,s){n._serialize&&Wo(r,n._serialize,n.serializers,n._stdErrSerialize);const a=r.slice();let u=a[0];const f={};s&&(f.time=s),f.level=Zr.levels.values[t];let g=(n._childLevel|0)+1;if(g<1&&(g=1),u!==null&&typeof u=="object"){for(;g--&&typeof a[0]=="object";)Object.assign(f,a.shift());u=a.length?kl(a.shift(),a):void 0}else typeof u=="string"&&(u=kl(a.shift(),a));return u!==void 0&&(f.msg=u),f}function Wo(n,t,r,s){for(const a in n)if(s&&n[a]instanceof Error)n[a]=Zr.stdSerializers.err(n[a]);else if(typeof n[a]=="object"&&!Array.isArray(n[a]))for(const u in n[a])t&&t.indexOf(u)>-1&&u in r&&(n[a][u]=r[u](n[a][u]))}function xn(n,t,r){return function(){const s=new Array(1+arguments.length);s[0]=t;for(var a=1;a<s.length;a++)s[a]=arguments[a-1];return n[r].apply(this,s)}}function o_(n,t,r){const s=t.send,a=t.ts,u=t.methodLevel,f=t.methodValue,g=t.val,m=n._logEvent.bindings;Wo(r,n._serialize||Object.keys(n.serializers),n.serializers,n._stdErrSerialize===void 0?!0:n._stdErrSerialize),n._logEvent.ts=a,n._logEvent.messages=r.filter(function(y){return m.indexOf(y)===-1}),n._logEvent.level.label=u,n._logEvent.level.value=f,s(u,n._logEvent,g),n._logEvent=Gc(m)}function Gc(n){return{ts:0,messages:[],bindings:n||[],level:{label:"",value:0}}}function a_(n){const t={type:n.constructor.name,msg:n.message,stack:n.stack};for(const r in n)t[r]===void 0&&(t[r]=n[r]);return t}function c_(n){return typeof n.timestamp=="function"?n.timestamp:n.timestamp===!1?dp:gp}function Ao(){return{}}function Cc(n){return n}function ps(){}function dp(){return!1}function gp(){return Date.now()}function u_(){return Math.round(Date.now()/1e3)}function h_(){return new Date(Date.now()).toISOString()}function l_(){function n(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return n(self)||n(window)||n(this)||{}}}const f_={level:"info"},ws="custom_context";var p_=Object.defineProperty,d_=Object.defineProperties,g_=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,y_=Object.prototype.hasOwnProperty,v_=Object.prototype.propertyIsEnumerable,Kl=(n,t,r)=>t in n?p_(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,m_=(n,t)=>{for(var r in t||(t={}))y_.call(t,r)&&Kl(n,r,t[r]);if(Hl)for(var r of Hl(t))v_.call(t,r)&&Kl(n,r,t[r]);return n},w_=(n,t)=>d_(n,g_(t));function Jo(n){return w_(m_({},n),{level:(n==null?void 0:n.level)||f_.level})}function b_(n,t=ws){return n[t]||""}function __(n,t,r=ws){return n[r]=t,n}function gr(n,t=ws){let r="";return typeof n.bindings>"u"?r=b_(n,t):r=n.bindings().context||"",r}function E_(n,t,r=ws){const s=gr(n,r);return s.trim()?`${s}/${t}`:t}function Ir(n,t,r=ws){const s=E_(n,t,r),a=n.child({context:s});return __(a,s,r)}let I_=class extends en{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},x_=class extends en{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},P_=class{constructor(t,r){this.logger=t,this.core=r}},S_=class extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}},O_=class extends en{constructor(t){super()}},R_=class{constructor(t,r,s,a){this.core=t,this.logger=r,this.name=s}},A_=class extends en{constructor(t,r){super(),this.relayer=t,this.logger=r}},T_=class extends en{constructor(t,r){super(),this.core=t,this.logger=r}},C_=class{constructor(t,r){this.projectId=t,this.logger=r}},N_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},$_=class{constructor(t){this.client=t}};var au={},yp={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=k1,r=kf;n.DIGEST_LENGTH=64,n.BLOCK_SIZE=128;var s=function(){function g(){this.digestLength=n.DIGEST_LENGTH,this.blockSize=n.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(m,y){if(y===void 0&&(y=m.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var E=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<n.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=m[E++],y--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(E=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,m,E,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=m[E++],y--;return this},g.prototype.finish=function(m){if(!this._finished){var y=this._bytesHashed,E=this._bufferLength,x=y/536870912|0,$=y<<3,L=y%128<112?128:256;this._buffer[E]=128;for(var T=E+1;T<L-8;T++)this._buffer[T]=0;t.writeUint32BE(x,this._buffer,L-8),t.writeUint32BE($,this._buffer,L-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,L),this._finished=!0}for(var T=0;T<this.digestLength/8;T++)t.writeUint32BE(this._stateHi[T],m,T*8),t.writeUint32BE(this._stateLo[T],m,T*8+4);return this},g.prototype.digest=function(){var m=new Uint8Array(this.digestLength);return this.finish(m),m},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(m){return this._stateHi.set(m.stateHi),this._stateLo.set(m.stateLo),this._bufferLength=m.bufferLength,m.buffer&&this._buffer.set(m.buffer),this._bytesHashed=m.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(m){r.wipe(m.stateHi),r.wipe(m.stateLo),m.buffer&&r.wipe(m.buffer),m.bufferLength=0,m.bytesHashed=0},g}();n.SHA512=s;var a=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(g,m,y,E,x,$,L){for(var T=y[0],Y=y[1],re=y[2],oe=y[3],ce=y[4],ae=y[5],te=y[6],he=y[7],pe=E[0],Q=E[1],ve=E[2],_t=E[3],st=E[4],Ke=E[5],zt=E[6],kt=E[7],b,O,J,le,k,z,H,K;L>=128;){for(var et=0;et<16;et++){var ot=8*et+$;g[et]=t.readUint32BE(x,ot),m[et]=t.readUint32BE(x,ot+4)}for(var et=0;et<80;et++){var Di=T,Ee=Y,Dr=re,D=oe,N=ce,A=ae,h=te,I=he,Z=pe,ue=Q,me=ve,Oe=_t,Ae=st,Ie=Ke,Et=zt,gt=kt;if(b=he,O=kt,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=(ce>>>14|st<<32-14)^(ce>>>18|st<<32-18)^(st>>>41-32|ce<<32-(41-32)),O=(st>>>14|ce<<32-14)^(st>>>18|ce<<32-18)^(ce>>>41-32|st<<32-(41-32)),k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,b=ce&ae^~ce&te,O=st&Ke^~st&zt,k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,b=a[et*2],O=a[et*2+1],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,b=g[et%16],O=m[et%16],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,J=H&65535|K<<16,le=k&65535|z<<16,b=J,O=le,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=(T>>>28|pe<<32-28)^(pe>>>34-32|T<<32-(34-32))^(pe>>>39-32|T<<32-(39-32)),O=(pe>>>28|T<<32-28)^(T>>>34-32|pe<<32-(34-32))^(T>>>39-32|pe<<32-(39-32)),k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,b=T&Y^T&re^Y&re,O=pe&Q^pe&ve^Q&ve,k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,I=H&65535|K<<16,gt=k&65535|z<<16,b=D,O=Oe,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=J,O=le,k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,D=H&65535|K<<16,Oe=k&65535|z<<16,Y=Di,re=Ee,oe=Dr,ce=D,ae=N,te=A,he=h,T=I,Q=Z,ve=ue,_t=me,st=Oe,Ke=Ae,zt=Ie,kt=Et,pe=gt,et%16===15)for(var ot=0;ot<16;ot++)b=g[ot],O=m[ot],k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=g[(ot+9)%16],O=m[(ot+9)%16],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,J=g[(ot+1)%16],le=m[(ot+1)%16],b=(J>>>1|le<<32-1)^(J>>>8|le<<32-8)^J>>>7,O=(le>>>1|J<<32-1)^(le>>>8|J<<32-8)^(le>>>7|J<<32-7),k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,J=g[(ot+14)%16],le=m[(ot+14)%16],b=(J>>>19|le<<32-19)^(le>>>61-32|J<<32-(61-32))^J>>>6,O=(le>>>19|J<<32-19)^(J>>>61-32|le<<32-(61-32))^(le>>>6|J<<32-6),k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,g[ot]=H&65535|K<<16,m[ot]=k&65535|z<<16}b=T,O=pe,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[0],O=E[0],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[0]=T=H&65535|K<<16,E[0]=pe=k&65535|z<<16,b=Y,O=Q,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[1],O=E[1],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[1]=Y=H&65535|K<<16,E[1]=Q=k&65535|z<<16,b=re,O=ve,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[2],O=E[2],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[2]=re=H&65535|K<<16,E[2]=ve=k&65535|z<<16,b=oe,O=_t,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[3],O=E[3],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[3]=oe=H&65535|K<<16,E[3]=_t=k&65535|z<<16,b=ce,O=st,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[4],O=E[4],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[4]=ce=H&65535|K<<16,E[4]=st=k&65535|z<<16,b=ae,O=Ke,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[5],O=E[5],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[5]=ae=H&65535|K<<16,E[5]=Ke=k&65535|z<<16,b=te,O=zt,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[6],O=E[6],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[6]=te=H&65535|K<<16,E[6]=zt=k&65535|z<<16,b=he,O=kt,k=O&65535,z=O>>>16,H=b&65535,K=b>>>16,b=y[7],O=E[7],k+=O&65535,z+=O>>>16,H+=b&65535,K+=b>>>16,z+=k>>>16,H+=z>>>16,K+=H>>>16,y[7]=he=H&65535|K<<16,E[7]=kt=k&65535|z<<16,$+=128,L-=128}return $}function f(g){var m=new s;m.update(g);var y=m.digest();return m.clean(),y}n.hash=f})(yp);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.convertSecretKeyToX25519=n.convertPublicKeyToX25519=n.verify=n.sign=n.extractPublicKeyFromSecretKey=n.generateKeyPair=n.generateKeyPairFromSeed=n.SEED_LENGTH=n.SECRET_KEY_LENGTH=n.PUBLIC_KEY_LENGTH=n.SIGNATURE_LENGTH=void 0;const t=Bo,r=yp,s=kf;n.SIGNATURE_LENGTH=64,n.PUBLIC_KEY_LENGTH=32,n.SECRET_KEY_LENGTH=64,n.SEED_LENGTH=32;function a(D){const N=new Float64Array(16);if(D)for(let A=0;A<D.length;A++)N[A]=D[A];return N}const u=new Uint8Array(32);u[0]=9;const f=a(),g=a([1]),m=a([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=a([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),E=a([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=a([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$=a([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function L(D,N){for(let A=0;A<16;A++)D[A]=N[A]|0}function T(D){let N=1;for(let A=0;A<16;A++){let h=D[A]+N+65535;N=Math.floor(h/65536),D[A]=h-N*65536}D[0]+=N-1+37*(N-1)}function Y(D,N,A){const h=~(A-1);for(let I=0;I<16;I++){const Z=h&(D[I]^N[I]);D[I]^=Z,N[I]^=Z}}function re(D,N){const A=a(),h=a();for(let I=0;I<16;I++)h[I]=N[I];T(h),T(h),T(h);for(let I=0;I<2;I++){A[0]=h[0]-65517;for(let ue=1;ue<15;ue++)A[ue]=h[ue]-65535-(A[ue-1]>>16&1),A[ue-1]&=65535;A[15]=h[15]-32767-(A[14]>>16&1);const Z=A[15]>>16&1;A[14]&=65535,Y(h,A,1-Z)}for(let I=0;I<16;I++)D[2*I]=h[I]&255,D[2*I+1]=h[I]>>8}function oe(D,N){let A=0;for(let h=0;h<32;h++)A|=D[h]^N[h];return(1&A-1>>>8)-1}function ce(D,N){const A=new Uint8Array(32),h=new Uint8Array(32);return re(A,D),re(h,N),oe(A,h)}function ae(D){const N=new Uint8Array(32);return re(N,D),N[0]&1}function te(D,N){for(let A=0;A<16;A++)D[A]=N[2*A]+(N[2*A+1]<<8);D[15]&=32767}function he(D,N,A){for(let h=0;h<16;h++)D[h]=N[h]+A[h]}function pe(D,N,A){for(let h=0;h<16;h++)D[h]=N[h]-A[h]}function Q(D,N,A){let h,I,Z=0,ue=0,me=0,Oe=0,Ae=0,Ie=0,Et=0,gt=0,tt=0,Ce=0,Be=0,Ve=0,rt=0,Fe=0,Ge=0,Re=0,Me=0,at=0,$e=0,It=0,Nt=0,Ht=0,Kt=0,Ft=0,Qt=0,sr=0,Br=0,Yt=0,ei=0,wi=0,Fi=0,ct=A[0],Qe=A[1],ut=A[2],ht=A[3],it=A[4],Ye=A[5],xt=A[6],Pt=A[7],lt=A[8],St=A[9],ft=A[10],yt=A[11],pt=A[12],He=A[13],Ot=A[14],Rt=A[15];h=N[0],Z+=h*ct,ue+=h*Qe,me+=h*ut,Oe+=h*ht,Ae+=h*it,Ie+=h*Ye,Et+=h*xt,gt+=h*Pt,tt+=h*lt,Ce+=h*St,Be+=h*ft,Ve+=h*yt,rt+=h*pt,Fe+=h*He,Ge+=h*Ot,Re+=h*Rt,h=N[1],ue+=h*ct,me+=h*Qe,Oe+=h*ut,Ae+=h*ht,Ie+=h*it,Et+=h*Ye,gt+=h*xt,tt+=h*Pt,Ce+=h*lt,Be+=h*St,Ve+=h*ft,rt+=h*yt,Fe+=h*pt,Ge+=h*He,Re+=h*Ot,Me+=h*Rt,h=N[2],me+=h*ct,Oe+=h*Qe,Ae+=h*ut,Ie+=h*ht,Et+=h*it,gt+=h*Ye,tt+=h*xt,Ce+=h*Pt,Be+=h*lt,Ve+=h*St,rt+=h*ft,Fe+=h*yt,Ge+=h*pt,Re+=h*He,Me+=h*Ot,at+=h*Rt,h=N[3],Oe+=h*ct,Ae+=h*Qe,Ie+=h*ut,Et+=h*ht,gt+=h*it,tt+=h*Ye,Ce+=h*xt,Be+=h*Pt,Ve+=h*lt,rt+=h*St,Fe+=h*ft,Ge+=h*yt,Re+=h*pt,Me+=h*He,at+=h*Ot,$e+=h*Rt,h=N[4],Ae+=h*ct,Ie+=h*Qe,Et+=h*ut,gt+=h*ht,tt+=h*it,Ce+=h*Ye,Be+=h*xt,Ve+=h*Pt,rt+=h*lt,Fe+=h*St,Ge+=h*ft,Re+=h*yt,Me+=h*pt,at+=h*He,$e+=h*Ot,It+=h*Rt,h=N[5],Ie+=h*ct,Et+=h*Qe,gt+=h*ut,tt+=h*ht,Ce+=h*it,Be+=h*Ye,Ve+=h*xt,rt+=h*Pt,Fe+=h*lt,Ge+=h*St,Re+=h*ft,Me+=h*yt,at+=h*pt,$e+=h*He,It+=h*Ot,Nt+=h*Rt,h=N[6],Et+=h*ct,gt+=h*Qe,tt+=h*ut,Ce+=h*ht,Be+=h*it,Ve+=h*Ye,rt+=h*xt,Fe+=h*Pt,Ge+=h*lt,Re+=h*St,Me+=h*ft,at+=h*yt,$e+=h*pt,It+=h*He,Nt+=h*Ot,Ht+=h*Rt,h=N[7],gt+=h*ct,tt+=h*Qe,Ce+=h*ut,Be+=h*ht,Ve+=h*it,rt+=h*Ye,Fe+=h*xt,Ge+=h*Pt,Re+=h*lt,Me+=h*St,at+=h*ft,$e+=h*yt,It+=h*pt,Nt+=h*He,Ht+=h*Ot,Kt+=h*Rt,h=N[8],tt+=h*ct,Ce+=h*Qe,Be+=h*ut,Ve+=h*ht,rt+=h*it,Fe+=h*Ye,Ge+=h*xt,Re+=h*Pt,Me+=h*lt,at+=h*St,$e+=h*ft,It+=h*yt,Nt+=h*pt,Ht+=h*He,Kt+=h*Ot,Ft+=h*Rt,h=N[9],Ce+=h*ct,Be+=h*Qe,Ve+=h*ut,rt+=h*ht,Fe+=h*it,Ge+=h*Ye,Re+=h*xt,Me+=h*Pt,at+=h*lt,$e+=h*St,It+=h*ft,Nt+=h*yt,Ht+=h*pt,Kt+=h*He,Ft+=h*Ot,Qt+=h*Rt,h=N[10],Be+=h*ct,Ve+=h*Qe,rt+=h*ut,Fe+=h*ht,Ge+=h*it,Re+=h*Ye,Me+=h*xt,at+=h*Pt,$e+=h*lt,It+=h*St,Nt+=h*ft,Ht+=h*yt,Kt+=h*pt,Ft+=h*He,Qt+=h*Ot,sr+=h*Rt,h=N[11],Ve+=h*ct,rt+=h*Qe,Fe+=h*ut,Ge+=h*ht,Re+=h*it,Me+=h*Ye,at+=h*xt,$e+=h*Pt,It+=h*lt,Nt+=h*St,Ht+=h*ft,Kt+=h*yt,Ft+=h*pt,Qt+=h*He,sr+=h*Ot,Br+=h*Rt,h=N[12],rt+=h*ct,Fe+=h*Qe,Ge+=h*ut,Re+=h*ht,Me+=h*it,at+=h*Ye,$e+=h*xt,It+=h*Pt,Nt+=h*lt,Ht+=h*St,Kt+=h*ft,Ft+=h*yt,Qt+=h*pt,sr+=h*He,Br+=h*Ot,Yt+=h*Rt,h=N[13],Fe+=h*ct,Ge+=h*Qe,Re+=h*ut,Me+=h*ht,at+=h*it,$e+=h*Ye,It+=h*xt,Nt+=h*Pt,Ht+=h*lt,Kt+=h*St,Ft+=h*ft,Qt+=h*yt,sr+=h*pt,Br+=h*He,Yt+=h*Ot,ei+=h*Rt,h=N[14],Ge+=h*ct,Re+=h*Qe,Me+=h*ut,at+=h*ht,$e+=h*it,It+=h*Ye,Nt+=h*xt,Ht+=h*Pt,Kt+=h*lt,Ft+=h*St,Qt+=h*ft,sr+=h*yt,Br+=h*pt,Yt+=h*He,ei+=h*Ot,wi+=h*Rt,h=N[15],Re+=h*ct,Me+=h*Qe,at+=h*ut,$e+=h*ht,It+=h*it,Nt+=h*Ye,Ht+=h*xt,Kt+=h*Pt,Ft+=h*lt,Qt+=h*St,sr+=h*ft,Br+=h*yt,Yt+=h*pt,ei+=h*He,wi+=h*Ot,Fi+=h*Rt,Z+=38*Me,ue+=38*at,me+=38*$e,Oe+=38*It,Ae+=38*Nt,Ie+=38*Ht,Et+=38*Kt,gt+=38*Ft,tt+=38*Qt,Ce+=38*sr,Be+=38*Br,Ve+=38*Yt,rt+=38*ei,Fe+=38*wi,Ge+=38*Fi,I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Et+I+65535,I=Math.floor(h/65536),Et=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ge+I+65535,I=Math.floor(h/65536),Ge=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),I=1,h=Z+I+65535,I=Math.floor(h/65536),Z=h-I*65536,h=ue+I+65535,I=Math.floor(h/65536),ue=h-I*65536,h=me+I+65535,I=Math.floor(h/65536),me=h-I*65536,h=Oe+I+65535,I=Math.floor(h/65536),Oe=h-I*65536,h=Ae+I+65535,I=Math.floor(h/65536),Ae=h-I*65536,h=Ie+I+65535,I=Math.floor(h/65536),Ie=h-I*65536,h=Et+I+65535,I=Math.floor(h/65536),Et=h-I*65536,h=gt+I+65535,I=Math.floor(h/65536),gt=h-I*65536,h=tt+I+65535,I=Math.floor(h/65536),tt=h-I*65536,h=Ce+I+65535,I=Math.floor(h/65536),Ce=h-I*65536,h=Be+I+65535,I=Math.floor(h/65536),Be=h-I*65536,h=Ve+I+65535,I=Math.floor(h/65536),Ve=h-I*65536,h=rt+I+65535,I=Math.floor(h/65536),rt=h-I*65536,h=Fe+I+65535,I=Math.floor(h/65536),Fe=h-I*65536,h=Ge+I+65535,I=Math.floor(h/65536),Ge=h-I*65536,h=Re+I+65535,I=Math.floor(h/65536),Re=h-I*65536,Z+=I-1+37*(I-1),D[0]=Z,D[1]=ue,D[2]=me,D[3]=Oe,D[4]=Ae,D[5]=Ie,D[6]=Et,D[7]=gt,D[8]=tt,D[9]=Ce,D[10]=Be,D[11]=Ve,D[12]=rt,D[13]=Fe,D[14]=Ge,D[15]=Re}function ve(D,N){Q(D,N,N)}function _t(D,N){const A=a();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=253;h>=0;h--)ve(A,A),h!==2&&h!==4&&Q(A,A,N);for(h=0;h<16;h++)D[h]=A[h]}function st(D,N){const A=a();let h;for(h=0;h<16;h++)A[h]=N[h];for(h=250;h>=0;h--)ve(A,A),h!==1&&Q(A,A,N);for(h=0;h<16;h++)D[h]=A[h]}function Ke(D,N){const A=a(),h=a(),I=a(),Z=a(),ue=a(),me=a(),Oe=a(),Ae=a(),Ie=a();pe(A,D[1],D[0]),pe(Ie,N[1],N[0]),Q(A,A,Ie),he(h,D[0],D[1]),he(Ie,N[0],N[1]),Q(h,h,Ie),Q(I,D[3],N[3]),Q(I,I,y),Q(Z,D[2],N[2]),he(Z,Z,Z),pe(ue,h,A),pe(me,Z,I),he(Oe,Z,I),he(Ae,h,A),Q(D[0],ue,me),Q(D[1],Ae,Oe),Q(D[2],Oe,me),Q(D[3],ue,Ae)}function zt(D,N,A){for(let h=0;h<4;h++)Y(D[h],N[h],A)}function kt(D,N){const A=a(),h=a(),I=a();_t(I,N[2]),Q(A,N[0],I),Q(h,N[1],I),re(D,h),D[31]^=ae(A)<<7}function b(D,N,A){L(D[0],f),L(D[1],g),L(D[2],g),L(D[3],f);for(let h=255;h>=0;--h){const I=A[h/8|0]>>(h&7)&1;zt(D,N,I),Ke(N,D),Ke(D,D),zt(D,N,I)}}function O(D,N){const A=[a(),a(),a(),a()];L(A[0],E),L(A[1],x),L(A[2],g),Q(A[3],E,x),b(D,A,N)}function J(D){if(D.length!==n.SEED_LENGTH)throw new Error(`ed25519: seed must be ${n.SEED_LENGTH} bytes`);const N=(0,r.hash)(D);N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(32),h=[a(),a(),a(),a()];O(h,N),kt(A,h);const I=new Uint8Array(64);return I.set(D),I.set(A,32),{publicKey:A,secretKey:I}}n.generateKeyPairFromSeed=J;function le(D){const N=(0,t.randomBytes)(32,D),A=J(N);return(0,s.wipe)(N),A}n.generateKeyPair=le;function k(D){if(D.length!==n.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${n.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}n.extractPublicKeyFromSecretKey=k;const z=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function H(D,N){let A,h,I,Z;for(h=63;h>=32;--h){for(A=0,I=h-32,Z=h-12;I<Z;++I)N[I]+=A-16*N[h]*z[I-(h-32)],A=Math.floor((N[I]+128)/256),N[I]-=A*256;N[I]+=A,N[h]=0}for(A=0,I=0;I<32;I++)N[I]+=A-(N[31]>>4)*z[I],A=N[I]>>8,N[I]&=255;for(I=0;I<32;I++)N[I]-=A*z[I];for(h=0;h<32;h++)N[h+1]+=N[h]>>8,D[h]=N[h]&255}function K(D){const N=new Float64Array(64);for(let A=0;A<64;A++)N[A]=D[A];for(let A=0;A<64;A++)D[A]=0;H(D,N)}function et(D,N){const A=new Float64Array(64),h=[a(),a(),a(),a()],I=(0,r.hash)(D.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const Z=new Uint8Array(64);Z.set(I.subarray(32),32);const ue=new r.SHA512;ue.update(Z.subarray(32)),ue.update(N);const me=ue.digest();ue.clean(),K(me),O(h,me),kt(Z,h),ue.reset(),ue.update(Z.subarray(0,32)),ue.update(D.subarray(32)),ue.update(N);const Oe=ue.digest();K(Oe);for(let Ae=0;Ae<32;Ae++)A[Ae]=me[Ae];for(let Ae=0;Ae<32;Ae++)for(let Ie=0;Ie<32;Ie++)A[Ae+Ie]+=Oe[Ae]*I[Ie];return H(Z.subarray(32),A),Z}n.sign=et;function ot(D,N){const A=a(),h=a(),I=a(),Z=a(),ue=a(),me=a(),Oe=a();return L(D[2],g),te(D[1],N),ve(I,D[1]),Q(Z,I,m),pe(I,I,D[2]),he(Z,D[2],Z),ve(ue,Z),ve(me,ue),Q(Oe,me,ue),Q(A,Oe,I),Q(A,A,Z),st(A,A),Q(A,A,I),Q(A,A,Z),Q(A,A,Z),Q(D[0],A,Z),ve(h,D[0]),Q(h,h,Z),ce(h,I)&&Q(D[0],D[0],$),ve(h,D[0]),Q(h,h,Z),ce(h,I)?-1:(ae(D[0])===N[31]>>7&&pe(D[0],f,D[0]),Q(D[3],D[0],D[1]),0)}function Di(D,N,A){const h=new Uint8Array(32),I=[a(),a(),a(),a()],Z=[a(),a(),a(),a()];if(A.length!==n.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${n.SIGNATURE_LENGTH} bytes`);if(ot(Z,D))return!1;const ue=new r.SHA512;ue.update(A.subarray(0,32)),ue.update(D),ue.update(N);const me=ue.digest();return K(me),b(I,Z,me),O(Z,A.subarray(32)),Ke(I,Z),kt(h,I),!oe(A,h)}n.verify=Di;function Ee(D){let N=[a(),a(),a(),a()];if(ot(N,D))throw new Error("Ed25519: invalid public key");let A=a(),h=a(),I=N[1];he(A,g,I),pe(h,g,I),_t(h,h),Q(A,A,h);let Z=new Uint8Array(32);return re(Z,A),Z}n.convertPublicKeyToX25519=Ee;function Dr(D){const N=(0,r.hash)(D.subarray(0,32));N[0]&=248,N[31]&=127,N[31]|=64;const A=new Uint8Array(N.subarray(0,32));return(0,s.wipe)(N),A}n.convertSecretKeyToX25519=Dr})(au);const D_="EdDSA",F_="JWT",vp=".",mp="base64url",L_="utf8",j_="utf8",M_=":",q_="did",U_="key",Bl="base58btc",z_="z",k_="K36",H_=32;function zo(n){return nr(dr(Yi(n),L_),mp)}function wp(n){const t=dr(k_,Bl),r=z_+nr(zc([t,n]),Bl);return[q_,U_,r].join(M_)}function K_(n){return nr(n,mp)}function B_(n){return dr([zo(n.header),zo(n.payload)].join(vp),j_)}function V_(n){return[zo(n.header),zo(n.payload),K_(n.signature)].join(vp)}function Vl(n=Bo.randomBytes(H_)){return au.generateKeyPairFromSeed(n)}async function G_(n,t,r,s,a=ee.fromMiliseconds(Date.now())){const u={alg:D_,typ:F_},f=wp(s.publicKey),g=a+r,m={iss:f,sub:n,aud:t,iat:a,exp:g},y=B_({header:u,payload:m}),E=au.sign(s.secretKey,y);return V_({header:u,payload:m,signature:E})}const W_="PARSE_ERROR",J_="INVALID_REQUEST",Q_="METHOD_NOT_FOUND",Y_="INVALID_PARAMS",bp="INTERNAL_ERROR",cu="SERVER_ERROR",Z_=[-32700,-32600,-32601,-32602,-32603],hs={[W_]:{code:-32700,message:"Parse error"},[J_]:{code:-32600,message:"Invalid Request"},[Q_]:{code:-32601,message:"Method not found"},[Y_]:{code:-32602,message:"Invalid params"},[bp]:{code:-32603,message:"Internal error"},[cu]:{code:-32e3,message:"Server error"}},_p=cu;function X_(n){return Z_.includes(n)}function Gl(n){return Object.keys(hs).includes(n)?hs[n]:hs[_p]}function eE(n){const t=Object.values(hs).find(r=>r.code===n);return t||hs[_p]}function Ep(n,t,r){return n.message.includes("getaddrinfo ENOTFOUND")||n.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):n}var Ip={},fi={},Wl;function tE(){if(Wl)return fi;Wl=1,Object.defineProperty(fi,"__esModule",{value:!0}),fi.isBrowserCryptoAvailable=fi.getSubtleCrypto=fi.getBrowerCrypto=void 0;function n(){return(Kr===null||Kr===void 0?void 0:Kr.crypto)||(Kr===null||Kr===void 0?void 0:Kr.msCrypto)||{}}fi.getBrowerCrypto=n;function t(){const s=n();return s.subtle||s.webkitSubtle}fi.getSubtleCrypto=t;function r(){return!!n()&&!!t()}return fi.isBrowserCryptoAvailable=r,fi}var pi={},Jl;function rE(){if(Jl)return pi;Jl=1,Object.defineProperty(pi,"__esModule",{value:!0}),pi.isBrowser=pi.isNode=pi.isReactNative=void 0;function n(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}pi.isReactNative=n;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}pi.isNode=t;function r(){return!n()&&!t()}return pi.isBrowser=r,pi}(function(n){Object.defineProperty(n,"__esModule",{value:!0});const t=ds;t.__exportStar(tE(),n),t.__exportStar(rE(),n)})(Ip);function uu(n=3){const t=Date.now()*Math.pow(10,n),r=Math.floor(Math.random()*Math.pow(10,n));return t+r}function xp(n=6){return BigInt(uu(n))}function Tn(n,t,r){return{id:r||uu(),jsonrpc:"2.0",method:n,params:t}}function hu(n,t){return{id:n,jsonrpc:"2.0",result:t}}function Qo(n,t,r){return{id:n,jsonrpc:"2.0",error:iE(t,r)}}function iE(n,t){return typeof n>"u"?Gl(bp):(typeof n=="string"&&(n=Object.assign(Object.assign({},Gl(cu)),{message:n})),typeof t<"u"&&(n.data=t),X_(n.code)&&(n=eE(n.code)),n)}class nE{}class sE extends nE{constructor(){super()}}class oE extends sE{constructor(t){super()}}const aE="^https?:",cE="^wss?:";function uE(n){const t=n.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Pp(n,t){const r=uE(n);return typeof r>"u"?!1:new RegExp(t).test(r)}function Ql(n){return Pp(n,aE)}function Yl(n){return Pp(n,cE)}function hE(n){return new RegExp("wss?://localhost(:d{2,5})?").test(n)}function Sp(n){return typeof n=="object"&&"id"in n&&"jsonrpc"in n&&n.jsonrpc==="2.0"}function lu(n){return Sp(n)&&"method"in n}function Yo(n){return Sp(n)&&(yi(n)||Hr(n))}function yi(n){return"result"in n}function Hr(n){return"error"in n}class vi extends oE{constructor(t){super(t),this.events=new Ut.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(Tn(t.method,t.params||[],t.id||xp().toString()),r)}async requestStrict(t,r){return new Promise(async(s,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{Hr(u)?a(u.error):s(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Yo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const lE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),fE=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Zl=n=>n.split("?")[0],Xl=10,pE=lE();let dE=class{constructor(t){if(this.url=t,this.events=new Ut.EventEmitter,this.registering=!1,!Yl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Yi(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!Yl(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,s)=>{const a=new URLSearchParams(t).get("origin"),u=Ip.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!hE(t)},f=new pE(t,[],u);fE()?f.onerror=g=>{const m=g;s(this.emitError(m.error))}:f.on("error",g=>{s(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ms(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=Qo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Ep(t,Zl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Xl&&this.events.setMaxListeners(Xl)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Zl(this.url)}`));return this.events.emit("register_error",r),r}};var ko={},gE={get exports(){return ko},set exports(n){ko=n}};(function(n,t){var r=200,s="__lodash_hash_undefined__",a=1,u=2,f=9007199254740991,g="[object Arguments]",m="[object Array]",y="[object AsyncFunction]",E="[object Boolean]",x="[object Date]",$="[object Error]",L="[object Function]",T="[object GeneratorFunction]",Y="[object Map]",re="[object Number]",oe="[object Null]",ce="[object Object]",ae="[object Promise]",te="[object Proxy]",he="[object RegExp]",pe="[object Set]",Q="[object String]",ve="[object Symbol]",_t="[object Undefined]",st="[object WeakMap]",Ke="[object ArrayBuffer]",zt="[object DataView]",kt="[object Float32Array]",b="[object Float64Array]",O="[object Int8Array]",J="[object Int16Array]",le="[object Int32Array]",k="[object Uint8Array]",z="[object Uint8ClampedArray]",H="[object Uint16Array]",K="[object Uint32Array]",et=/[\\^$.*+?()[\]{}|]/g,ot=/^\[object .+?Constructor\]$/,Di=/^(?:0|[1-9]\d*)$/,Ee={};Ee[kt]=Ee[b]=Ee[O]=Ee[J]=Ee[le]=Ee[k]=Ee[z]=Ee[H]=Ee[K]=!0,Ee[g]=Ee[m]=Ee[Ke]=Ee[E]=Ee[zt]=Ee[x]=Ee[$]=Ee[L]=Ee[Y]=Ee[re]=Ee[ce]=Ee[he]=Ee[pe]=Ee[Q]=Ee[st]=!1;var Dr=typeof Kr=="object"&&Kr&&Kr.Object===Object&&Kr,D=typeof self=="object"&&self&&self.Object===Object&&self,N=Dr||D||Function("return this")(),A=t&&!t.nodeType&&t,h=A&&!0&&n&&!n.nodeType&&n,I=h&&h.exports===A,Z=I&&Dr.process,ue=function(){try{return Z&&Z.binding&&Z.binding("util")}catch{}}(),me=ue&&ue.isTypedArray;function Oe(v,P){for(var q=-1,G=v==null?0:v.length,Ue=0,de=[];++q<G;){var We=v[q];P(We,q,v)&&(de[Ue++]=We)}return de}function Ae(v,P){for(var q=-1,G=P.length,Ue=v.length;++q<G;)v[Ue+q]=P[q];return v}function Ie(v,P){for(var q=-1,G=v==null?0:v.length;++q<G;)if(P(v[q],q,v))return!0;return!1}function Et(v,P){for(var q=-1,G=Array(v);++q<v;)G[q]=P(q);return G}function gt(v){return function(P){return v(P)}}function tt(v,P){return v.has(P)}function Ce(v,P){return v==null?void 0:v[P]}function Be(v){var P=-1,q=Array(v.size);return v.forEach(function(G,Ue){q[++P]=[Ue,G]}),q}function Ve(v,P){return function(q){return v(P(q))}}function rt(v){var P=-1,q=Array(v.size);return v.forEach(function(G){q[++P]=G}),q}var Fe=Array.prototype,Ge=Function.prototype,Re=Object.prototype,Me=N["__core-js_shared__"],at=Ge.toString,$e=Re.hasOwnProperty,It=function(){var v=/[^.]+$/.exec(Me&&Me.keys&&Me.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Nt=Re.toString,Ht=RegExp("^"+at.call($e).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kt=I?N.Buffer:void 0,Ft=N.Symbol,Qt=N.Uint8Array,sr=Re.propertyIsEnumerable,Br=Fe.splice,Yt=Ft?Ft.toStringTag:void 0,ei=Object.getOwnPropertySymbols,wi=Kt?Kt.isBuffer:void 0,Fi=Ve(Object.keys,Object),ct=yr(N,"DataView"),Qe=yr(N,"Map"),ut=yr(N,"Promise"),ht=yr(N,"Set"),it=yr(N,"WeakMap"),Ye=yr(Object,"create"),xt=ri(ct),Pt=ri(Qe),lt=ri(ut),St=ri(ht),ft=ri(it),yt=Ft?Ft.prototype:void 0,pt=yt?yt.valueOf:void 0;function He(v){var P=-1,q=v==null?0:v.length;for(this.clear();++P<q;){var G=v[P];this.set(G[0],G[1])}}function Ot(){this.__data__=Ye?Ye(null):{},this.size=0}function Rt(v){var P=this.has(v)&&delete this.__data__[v];return this.size-=P?1:0,P}function ea(v){var P=this.__data__;if(Ye){var q=P[v];return q===s?void 0:q}return $e.call(P,v)?P[v]:void 0}function ta(v){var P=this.__data__;return Ye?P[v]!==void 0:$e.call(P,v)}function ra(v,P){var q=this.__data__;return this.size+=this.has(v)?0:1,q[v]=Ye&&P===void 0?s:P,this}He.prototype.clear=Ot,He.prototype.delete=Rt,He.prototype.get=ea,He.prototype.has=ta,He.prototype.set=ra;function xr(v){var P=-1,q=v==null?0:v.length;for(this.clear();++P<q;){var G=v[P];this.set(G[0],G[1])}}function ia(){this.__data__=[],this.size=0}function na(v){var P=this.__data__,q=Li(P,v);if(q<0)return!1;var G=P.length-1;return q==G?P.pop():Br.call(P,q,1),--this.size,!0}function sa(v){var P=this.__data__,q=Li(P,v);return q<0?void 0:P[q][1]}function oa(v){return Li(this.__data__,v)>-1}function aa(v,P){var q=this.__data__,G=Li(q,v);return G<0?(++this.size,q.push([v,P])):q[G][1]=P,this}xr.prototype.clear=ia,xr.prototype.delete=na,xr.prototype.get=sa,xr.prototype.has=oa,xr.prototype.set=aa;function ti(v){var P=-1,q=v==null?0:v.length;for(this.clear();++P<q;){var G=v[P];this.set(G[0],G[1])}}function rn(){this.size=0,this.__data__={hash:new He,map:new(Qe||xr),string:new He}}function ca(v){var P=bi(this,v).delete(v);return this.size-=P?1:0,P}function nn(v){return bi(this,v).get(v)}function ua(v){return bi(this,v).has(v)}function ha(v,P){var q=bi(this,v),G=q.size;return q.set(v,P),this.size+=q.size==G?0:1,this}ti.prototype.clear=rn,ti.prototype.delete=ca,ti.prototype.get=nn,ti.prototype.has=ua,ti.prototype.set=ha;function sn(v){var P=-1,q=v==null?0:v.length;for(this.__data__=new ti;++P<q;)this.add(v[P])}function _s(v){return this.__data__.set(v,s),this}function Es(v){return this.__data__.has(v)}sn.prototype.add=sn.prototype.push=_s,sn.prototype.has=Es;function Fr(v){var P=this.__data__=new xr(v);this.size=P.size}function la(){this.__data__=new xr,this.size=0}function fa(v){var P=this.__data__,q=P.delete(v);return this.size=P.size,q}function pa(v){return this.__data__.get(v)}function da(v){return this.__data__.has(v)}function Is(v,P){var q=this.__data__;if(q instanceof xr){var G=q.__data__;if(!Qe||G.length<r-1)return G.push([v,P]),this.size=++q.size,this;q=this.__data__=new ti(G)}return q.set(v,P),this.size=q.size,this}Fr.prototype.clear=la,Fr.prototype.delete=fa,Fr.prototype.get=pa,Fr.prototype.has=da,Fr.prototype.set=Is;function xs(v,P){var q=cn(v),G=!q&&Ls(v),Ue=!q&&!G&&jn(v),de=!q&&!G&&!Ue&&qs(v),We=q||G||Ue||de,At=We?Et(v.length,String):[],Pe=At.length;for(var ze in v)(P||$e.call(v,ze))&&!(We&&(ze=="length"||Ue&&(ze=="offset"||ze=="parent")||de&&(ze=="buffer"||ze=="byteLength"||ze=="byteOffset")||Cs(ze,Pe)))&&At.push(ze);return At}function Li(v,P){for(var q=v.length;q--;)if(Fs(v[q][0],P))return q;return-1}function Fn(v,P,q){var G=P(v);return cn(v)?G:Ae(G,q(v))}function ji(v){return v==null?v===void 0?_t:oe:Yt&&Yt in Object(v)?As(v):va(v)}function Ln(v){return qi(v)&&ji(v)==g}function Mi(v,P,q,G,Ue){return v===P?!0:v==null||P==null||!qi(v)&&!qi(P)?v!==v&&P!==P:Ps(v,P,q,G,Mi,Ue)}function Ps(v,P,q,G,Ue,de){var We=cn(v),At=cn(P),Pe=We?m:Vr(v),ze=At?m:Vr(P);Pe=Pe==g?ce:Pe,ze=ze==g?ce:ze;var vt=Pe==ce,or=ze==ce,Tt=Pe==ze;if(Tt&&jn(v)){if(!jn(P))return!1;We=!0,vt=!1}if(Tt&&!vt)return de||(de=new Fr),We||qs(v)?on(v,P,q,G,Ue,de):ya(v,P,Pe,q,G,Ue,de);if(!(q&a)){var Je=vt&&$e.call(v,"__wrapped__"),Zt=or&&$e.call(P,"__wrapped__");if(Je||Zt){var Lr=Je?v.value():v,Pr=Zt?P.value():P;return de||(de=new Fr),Ue(Lr,Pr,q,G,de)}}return Tt?(de||(de=new Fr),Rs(v,P,q,G,Ue,de)):!1}function ga(v){if(!Ms(v)||$s(v))return!1;var P=un(v)?Ht:ot;return P.test(ri(v))}function Ss(v){return qi(v)&&js(v.length)&&!!Ee[ji(v)]}function Os(v){if(!Ds(v))return Fi(v);var P=[];for(var q in Object(v))$e.call(v,q)&&q!="constructor"&&P.push(q);return P}function on(v,P,q,G,Ue,de){var We=q&a,At=v.length,Pe=P.length;if(At!=Pe&&!(We&&Pe>At))return!1;var ze=de.get(v);if(ze&&de.get(P))return ze==P;var vt=-1,or=!0,Tt=q&u?new sn:void 0;for(de.set(v,P),de.set(P,v);++vt<At;){var Je=v[vt],Zt=P[vt];if(G)var Lr=We?G(Zt,Je,vt,P,v,de):G(Je,Zt,vt,v,P,de);if(Lr!==void 0){if(Lr)continue;or=!1;break}if(Tt){if(!Ie(P,function(Pr,Gr){if(!tt(Tt,Gr)&&(Je===Pr||Ue(Je,Pr,q,G,de)))return Tt.push(Gr)})){or=!1;break}}else if(!(Je===Zt||Ue(Je,Zt,q,G,de))){or=!1;break}}return de.delete(v),de.delete(P),or}function ya(v,P,q,G,Ue,de,We){switch(q){case zt:if(v.byteLength!=P.byteLength||v.byteOffset!=P.byteOffset)return!1;v=v.buffer,P=P.buffer;case Ke:return!(v.byteLength!=P.byteLength||!de(new Qt(v),new Qt(P)));case E:case x:case re:return Fs(+v,+P);case $:return v.name==P.name&&v.message==P.message;case he:case Q:return v==P+"";case Y:var At=Be;case pe:var Pe=G&a;if(At||(At=rt),v.size!=P.size&&!Pe)return!1;var ze=We.get(v);if(ze)return ze==P;G|=u,We.set(v,P);var vt=on(At(v),At(P),G,Ue,de,We);return We.delete(v),vt;case ve:if(pt)return pt.call(v)==pt.call(P)}return!1}function Rs(v,P,q,G,Ue,de){var We=q&a,At=an(v),Pe=At.length,ze=an(P),vt=ze.length;if(Pe!=vt&&!We)return!1;for(var or=Pe;or--;){var Tt=At[or];if(!(We?Tt in P:$e.call(P,Tt)))return!1}var Je=de.get(v);if(Je&&de.get(P))return Je==P;var Zt=!0;de.set(v,P),de.set(P,v);for(var Lr=We;++or<Pe;){Tt=At[or];var Pr=v[Tt],Gr=P[Tt];if(G)var Mn=We?G(Gr,Pr,Tt,P,v,de):G(Pr,Gr,Tt,v,P,de);if(!(Mn===void 0?Pr===Gr||Ue(Pr,Gr,q,G,de):Mn)){Zt=!1;break}Lr||(Lr=Tt=="constructor")}if(Zt&&!Lr){var Ui=v.constructor,Lt=P.constructor;Ui!=Lt&&"constructor"in v&&"constructor"in P&&!(typeof Ui=="function"&&Ui instanceof Ui&&typeof Lt=="function"&&Lt instanceof Lt)&&(Zt=!1)}return de.delete(v),de.delete(P),Zt}function an(v){return Fn(v,ba,Ts)}function bi(v,P){var q=v.__data__;return Ns(P)?q[typeof P=="string"?"string":"hash"]:q.map}function yr(v,P){var q=Ce(v,P);return ga(q)?q:void 0}function As(v){var P=$e.call(v,Yt),q=v[Yt];try{v[Yt]=void 0;var G=!0}catch{}var Ue=Nt.call(v);return G&&(P?v[Yt]=q:delete v[Yt]),Ue}var Ts=ei?function(v){return v==null?[]:(v=Object(v),Oe(ei(v),function(P){return sr.call(v,P)}))}:qe,Vr=ji;(ct&&Vr(new ct(new ArrayBuffer(1)))!=zt||Qe&&Vr(new Qe)!=Y||ut&&Vr(ut.resolve())!=ae||ht&&Vr(new ht)!=pe||it&&Vr(new it)!=st)&&(Vr=function(v){var P=ji(v),q=P==ce?v.constructor:void 0,G=q?ri(q):"";if(G)switch(G){case xt:return zt;case Pt:return Y;case lt:return ae;case St:return pe;case ft:return st}return P});function Cs(v,P){return P=P??f,!!P&&(typeof v=="number"||Di.test(v))&&v>-1&&v%1==0&&v<P}function Ns(v){var P=typeof v;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?v!=="__proto__":v===null}function $s(v){return!!It&&It in v}function Ds(v){var P=v&&v.constructor,q=typeof P=="function"&&P.prototype||Re;return v===q}function va(v){return Nt.call(v)}function ri(v){if(v!=null){try{return at.call(v)}catch{}try{return v+""}catch{}}return""}function Fs(v,P){return v===P||v!==v&&P!==P}var Ls=Ln(function(){return arguments}())?Ln:function(v){return qi(v)&&$e.call(v,"callee")&&!sr.call(v,"callee")},cn=Array.isArray;function ma(v){return v!=null&&js(v.length)&&!un(v)}var jn=wi||Le;function wa(v,P){return Mi(v,P)}function un(v){if(!Ms(v))return!1;var P=ji(v);return P==L||P==T||P==y||P==te}function js(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function Ms(v){var P=typeof v;return v!=null&&(P=="object"||P=="function")}function qi(v){return v!=null&&typeof v=="object"}var qs=me?gt(me):Ss;function ba(v){return ma(v)?xs(v):Os(v)}function qe(){return[]}function Le(){return!1}n.exports=wa})(gE,ko);function yE(n,t){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),s=0;s<r.length;s++)r[s]=255;for(var a=0;a<n.length;a++){var u=n.charAt(a),f=u.charCodeAt(0);if(r[f]!==255)throw new TypeError(u+" is ambiguous");r[f]=a}var g=n.length,m=n.charAt(0),y=Math.log(g)/Math.log(256),E=Math.log(256)/Math.log(g);function x(T){if(T instanceof Uint8Array||(ArrayBuffer.isView(T)?T=new Uint8Array(T.buffer,T.byteOffset,T.byteLength):Array.isArray(T)&&(T=Uint8Array.from(T))),!(T instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(T.length===0)return"";for(var Y=0,re=0,oe=0,ce=T.length;oe!==ce&&T[oe]===0;)oe++,Y++;for(var ae=(ce-oe)*E+1>>>0,te=new Uint8Array(ae);oe!==ce;){for(var he=T[oe],pe=0,Q=ae-1;(he!==0||pe<re)&&Q!==-1;Q--,pe++)he+=256*te[Q]>>>0,te[Q]=he%g>>>0,he=he/g>>>0;if(he!==0)throw new Error("Non-zero carry");re=pe,oe++}for(var ve=ae-re;ve!==ae&&te[ve]===0;)ve++;for(var _t=m.repeat(Y);ve<ae;++ve)_t+=n.charAt(te[ve]);return _t}function $(T){if(typeof T!="string")throw new TypeError("Expected String");if(T.length===0)return new Uint8Array;var Y=0;if(T[Y]!==" "){for(var re=0,oe=0;T[Y]===m;)re++,Y++;for(var ce=(T.length-Y)*y+1>>>0,ae=new Uint8Array(ce);T[Y];){var te=r[T.charCodeAt(Y)];if(te===255)return;for(var he=0,pe=ce-1;(te!==0||he<oe)&&pe!==-1;pe--,he++)te+=g*ae[pe]>>>0,ae[pe]=te%256>>>0,te=te/256>>>0;if(te!==0)throw new Error("Non-zero carry");oe=he,Y++}if(T[Y]!==" "){for(var Q=ce-oe;Q!==ce&&ae[Q]===0;)Q++;for(var ve=new Uint8Array(re+(ce-Q)),_t=re;Q!==ce;)ve[_t++]=ae[Q++];return ve}}}function L(T){var Y=$(T);if(Y)return Y;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:$,decode:L}}var vE=yE,mE=vE;const Op=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},wE=n=>new TextEncoder().encode(n),bE=n=>new TextDecoder().decode(n);class _E{constructor(t,r,s){this.name=t,this.prefix=r,this.baseEncode=s}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class EE{constructor(t,r,s){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=s}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Rp(this,t)}}let IE=class{constructor(t){this.decoders=t}or(t){return Rp(this,t)}decode(t){const r=t[0],s=this.decoders[r];if(s)return s.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Rp=(n,t)=>new IE({...n.decoders||{[n.prefix]:n},...t.decoders||{[t.prefix]:t}});class xE{constructor(t,r,s,a){this.name=t,this.prefix=r,this.baseEncode=s,this.baseDecode=a,this.encoder=new _E(t,r,s),this.decoder=new EE(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Zo=({name:n,prefix:t,encode:r,decode:s})=>new xE(n,t,r,s),bs=({prefix:n,name:t,alphabet:r})=>{const{encode:s,decode:a}=mE(r,t);return Zo({prefix:n,name:t,encode:s,decode:u=>Op(a(u))})},PE=(n,t,r,s)=>{const a={};for(let E=0;E<t.length;++E)a[t[E]]=E;let u=n.length;for(;n[u-1]==="=";)--u;const f=new Uint8Array(u*r/8|0);let g=0,m=0,y=0;for(let E=0;E<u;++E){const x=a[n[E]];if(x===void 0)throw new SyntaxError(`Non-${s} character`);m=m<<r|x,g+=r,g>=8&&(g-=8,f[y++]=255&m>>g)}if(g>=r||255&m<<8-g)throw new SyntaxError("Unexpected end of data");return f},SE=(n,t,r)=>{const s=t[t.length-1]==="=",a=(1<<r)-1;let u="",f=0,g=0;for(let m=0;m<n.length;++m)for(g=g<<8|n[m],f+=8;f>r;)f-=r,u+=t[a&g>>f];if(f&&(u+=t[a&g<<r-f]),s)for(;u.length*r&7;)u+="=";return u},Vt=({name:n,prefix:t,bitsPerChar:r,alphabet:s})=>Zo({prefix:t,name:n,encode(a){return SE(a,s,r)},decode(a){return PE(a,s,r,n)}}),OE=Zo({prefix:"\0",name:"identity",encode:n=>bE(n),decode:n=>wE(n)});var RE=Object.freeze({__proto__:null,identity:OE});const AE=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var TE=Object.freeze({__proto__:null,base2:AE});const CE=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var NE=Object.freeze({__proto__:null,base8:CE});const $E=bs({prefix:"9",name:"base10",alphabet:"0123456789"});var DE=Object.freeze({__proto__:null,base10:$E});const FE=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),LE=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var jE=Object.freeze({__proto__:null,base16:FE,base16upper:LE});const ME=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),qE=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),UE=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),zE=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),kE=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),HE=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),KE=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),BE=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),VE=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var GE=Object.freeze({__proto__:null,base32:ME,base32upper:qE,base32pad:UE,base32padupper:zE,base32hex:kE,base32hexupper:HE,base32hexpad:KE,base32hexpadupper:BE,base32z:VE});const WE=bs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),JE=bs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var QE=Object.freeze({__proto__:null,base36:WE,base36upper:JE});const YE=bs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ZE=bs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var XE=Object.freeze({__proto__:null,base58btc:YE,base58flickr:ZE});const eI=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),tI=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),rI=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),iI=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var nI=Object.freeze({__proto__:null,base64:eI,base64pad:tI,base64url:rI,base64urlpad:iI});const Ap=Array.from(""),sI=Ap.reduce((n,t,r)=>(n[r]=t,n),[]),oI=Ap.reduce((n,t,r)=>(n[t.codePointAt(0)]=r,n),[]);function aI(n){return n.reduce((t,r)=>(t+=sI[r],t),"")}function cI(n){const t=[];for(const r of n){const s=oI[r.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(s)}return new Uint8Array(t)}const uI=Zo({prefix:"",name:"base256emoji",encode:aI,decode:cI});var hI=Object.freeze({__proto__:null,base256emoji:uI}),lI=Tp,ef=128,fI=127,pI=~fI,dI=Math.pow(2,31);function Tp(n,t,r){t=t||[],r=r||0;for(var s=r;n>=dI;)t[r++]=n&255|ef,n/=128;for(;n&pI;)t[r++]=n&255|ef,n>>>=7;return t[r]=n|0,Tp.bytes=r-s+1,t}var gI=Wc,yI=128,tf=127;function Wc(n,s){var r=0,s=s||0,a=0,u=s,f,g=n.length;do{if(u>=g)throw Wc.bytes=0,new RangeError("Could not decode varint");f=n[u++],r+=a<28?(f&tf)<<a:(f&tf)*Math.pow(2,a),a+=7}while(f>=yI);return Wc.bytes=u-s,r}var vI=Math.pow(2,7),mI=Math.pow(2,14),wI=Math.pow(2,21),bI=Math.pow(2,28),_I=Math.pow(2,35),EI=Math.pow(2,42),II=Math.pow(2,49),xI=Math.pow(2,56),PI=Math.pow(2,63),SI=function(n){return n<vI?1:n<mI?2:n<wI?3:n<bI?4:n<_I?5:n<EI?6:n<II?7:n<xI?8:n<PI?9:10},OI={encode:lI,decode:gI,encodingLength:SI},Cp=OI;const rf=(n,t,r=0)=>(Cp.encode(n,t,r),t),nf=n=>Cp.encodingLength(n),Jc=(n,t)=>{const r=t.byteLength,s=nf(n),a=s+nf(r),u=new Uint8Array(a+r);return rf(n,u,0),rf(r,u,s),u.set(t,a),new RI(n,r,t,u)};class RI{constructor(t,r,s,a){this.code=t,this.size=r,this.digest=s,this.bytes=a}}const Np=({name:n,code:t,encode:r})=>new AI(n,t,r);class AI{constructor(t,r,s){this.name=t,this.code=r,this.encode=s}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Jc(this.code,r):r.then(s=>Jc(this.code,s))}else throw Error("Unknown type, must be binary type")}}const $p=n=>async t=>new Uint8Array(await crypto.subtle.digest(n,t)),TI=Np({name:"sha2-256",code:18,encode:$p("SHA-256")}),CI=Np({name:"sha2-512",code:19,encode:$p("SHA-512")});var NI=Object.freeze({__proto__:null,sha256:TI,sha512:CI});const Dp=0,$I="identity",Fp=Op,DI=n=>Jc(Dp,Fp(n)),FI={code:Dp,name:$I,encode:Fp,digest:DI};var LI=Object.freeze({__proto__:null,identity:FI});new TextEncoder,new TextDecoder;const sf={...RE,...TE,...NE,...DE,...jE,...GE,...QE,...XE,...nI,...hI};({...NI,...LI});function Lp(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function jI(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Lp(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function jp(n,t,r,s){return{name:n,prefix:t,encoder:{name:n,prefix:t,encode:r},decoder:{decode:s}}}const of=jp("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),Nc=jp("ascii","a",n=>{let t="a";for(let r=0;r<n.length;r++)t+=String.fromCharCode(n[r]);return t},n=>{n=n.substring(1);const t=jI(n.length);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}),MI={utf8:of,"utf-8":of,hex:sf.base16,latin1:Nc,ascii:Nc,binary:Nc,...sf};function qI(n,t="utf8"){const r=MI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Lp(globalThis.Buffer.from(n,"utf-8")):r.decoder.decode(`${r.prefix}${n}`)}const Mp="wc",UI=2,fu="core",Ci=`${Mp}@2:${fu}:`,zI={name:fu,logger:"error"},kI={database:":memory:"},HI="crypto",af="client_ed25519_seed",KI=ee.ONE_DAY,BI="keychain",VI="0.3",GI="messages",WI="0.3",JI=ee.SIX_HOURS,QI="publisher",qp="irn",YI="error",Up="wss://relay.walletconnect.com",cf="wss://relay.walletconnect.org",ZI="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},XI="_subscription",di={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ex=ee.ONE_SECOND,tx="2.10.6",rx=1e4,ix="0.3",nx="WALLETCONNECT_CLIENT_ID",zr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},sx="subscription",ox="0.3",ax=ee.FIVE_SECONDS*1e3,cx="pairing",ux="0.3",rs={wc_pairingDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:0},res:{ttl:ee.ONE_DAY,prompt:!1,tag:0}}},cs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Yr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},hx="history",lx="0.3",fx="expirer",$r={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},px="0.3",$c="verify-api",Sn="https://verify.walletconnect.com",Qc="https://verify.walletconnect.org",dx=[Sn,Qc];class gx{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=BI,this.version=VI,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,a)=>{this.isInitialized(),this.keychain.set(s,a),await this.persist()},this.get=s=>{this.isInitialized();const a=this.keychain.get(s);if(typeof a>"u"){const{message:u}=B("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(u)}return a},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=t,this.logger=Ir(r,this.name)}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,np(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?sp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class yx{constructor(t,r,s){this.core=t,this.logger=r,this.name=HI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=Vl(a);return wp(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=rw();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),f=Vl(u),g=Kc();return await G_(g,a,KI,f)},this.generateSharedKey=(a,u,f)=>{this.isInitialized();const g=this.getPrivateKey(a),m=iw(g,u);return this.setSymKey(m,f)},this.setSymKey=async(a,u)=>{this.isInitialized();const f=u||nw(a);return await this.keychain.set(f,a),f},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,f)=>{this.isInitialized();const g=ip(f),m=Yi(u);if(_l(g)){const $=g.senderPublicKey,L=g.receiverPublicKey;a=await this.generateSharedKey($,L)}const y=this.getSymKey(a),{type:E,senderPublicKey:x}=g;return ow({type:E,symKey:y,message:m,senderPublicKey:x})},this.decode=async(a,u,f)=>{this.isInitialized();const g=uw(u,f);if(_l(g)){const m=g.receiverPublicKey,y=g.senderPublicKey;a=await this.generateSharedKey(m,y)}try{const m=this.getSymKey(a),y=aw({symKey:m,encoded:u});return ms(y)}catch(m){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(m)}},this.getPayloadType=a=>{const u=qo(a);return gs(u.type)},this.getPayloadSenderPublicKey=a=>{const u=qo(a);return u.senderPublicKey?nr(u.senderPublicKey,ir):void 0},this.core=t,this.logger=Ir(r,this.name),this.keychain=s||new gx(this.core,this.logger)}get context(){return gr(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(af)}catch{t=Kc(),await this.keychain.set(af,t)}return qI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class vx extends P_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=GI,this.version=WI,this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,a)=>{this.isInitialized();const u=Rn(a);let f=this.messages.get(s);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=a,this.messages.set(s,f),await this.persist()),u},this.get=s=>{this.isInitialized();let a=this.messages.get(s);return typeof a>"u"&&(a={}),a},this.has=(s,a)=>{this.isInitialized();const u=this.get(s),f=Rn(a);return typeof u[f]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=Ir(t,this.name),this.core=r}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,np(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?sp(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class mx extends S_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Ut.EventEmitter,this.name=QI,this.queue=new Map,this.publishTimeout=ee.toMiliseconds(ee.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,a,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}});try{const g=(u==null?void 0:u.ttl)||JI,m=Bc(u),y=(u==null?void 0:u.prompt)||!1,E=(u==null?void 0:u.tag)||0,x=(u==null?void 0:u.id)||xp().toString(),$={topic:s,message:a,opts:{ttl:g,relay:m,prompt:y,tag:E,id:x}},L=setTimeout(()=>this.queue.set(x,$),this.publishTimeout);try{await await ls(this.rpcPublish(s,a,g,m,y,E,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(Jt.publish,$)}catch(T){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(x),T;return}finally{clearTimeout(L)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:a,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.relayer=t,this.logger=Ir(r,this.name),this.registerEventListeners()}get context(){return gr(this.logger)}rpcPublish(t,r,s,a,u,f,g){var m,y,E,x;const $={method:Do(a.protocol).publish,params:{topic:t,message:r,ttl:s,prompt:u,tag:f},id:g};return rr((m=$.params)==null?void 0:m.prompt)&&((y=$.params)==null||delete y.prompt),rr((E=$.params)==null?void 0:E.tag)&&((x=$.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:$}),this.relayer.request($)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:s,opts:a}=t;await this.publish(r,s,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class wx{constructor(){this.map=new Map,this.set=(t,r)=>{const s=this.get(t);this.exists(t,r)||this.map.set(t,[...s,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const s=this.get(t);if(!this.exists(t,r))return;const a=s.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var bx=Object.defineProperty,_x=Object.defineProperties,Ex=Object.getOwnPropertyDescriptors,uf=Object.getOwnPropertySymbols,Ix=Object.prototype.hasOwnProperty,xx=Object.prototype.propertyIsEnumerable,hf=(n,t,r)=>t in n?bx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,is=(n,t)=>{for(var r in t||(t={}))Ix.call(t,r)&&hf(n,r,t[r]);if(uf)for(var r of uf(t))xx.call(t,r)&&hf(n,r,t[r]);return n},Dc=(n,t)=>_x(n,Ex(t));class Px extends A_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new wx,this.events=new Ut.EventEmitter,this.name=sx,this.version=ox,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Ci,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}});try{const u=Bc(a),f={topic:s,relay:u};this.pending.set(s,f);const g=await this.rpcSubscribe(s,u);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:a}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(s,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(s,a.id,a):await this.unsubscribeByTopic(s,a)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((a,u)=>{const f=new ee.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),a(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=ax&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ir(r,this.name),this.clientId=""}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let s=!1;try{s=this.getSubscription(t).topic===r}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const s=this.topicMap.get(t);await Promise.all(s.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}});try{const a=Bc(s);await this.rpcUnsubscribe(t,r,a);const u=bt("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:s}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const s={method:Do(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return Rn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,s={method:Do(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await ls(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,s){const a={method:Do(s.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Dc(is({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,is({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,s){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,s),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,is({},r)),this.topicMap.set(r.topic,t),this.events.emit(zr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:s}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const s=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(s.topic,t),this.events.emit(zr.deleted,Dc(is({},s),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(zr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(zr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Xr(r)&&this.onBatchSubscribe(r.map((s,a)=>Dc(is({},t[a]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(zr.created,async t=>{const r=zr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(zr.deleted,async t=>{const r=zr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var Sx=Object.defineProperty,lf=Object.getOwnPropertySymbols,Ox=Object.prototype.hasOwnProperty,Rx=Object.prototype.propertyIsEnumerable,ff=(n,t,r)=>t in n?Sx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Ax=(n,t)=>{for(var r in t||(t={}))Ox.call(t,r)&&ff(n,r,t[r]);if(lf)for(var r of lf(t))Rx.call(t,r)&&ff(n,r,t[r]);return n};class Tx extends O_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Ut.EventEmitter,this.name=ZI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(di.payload,this.onPayloadHandler),this.provider.on(di.connect,this.onConnectHandler),this.provider.on(di.disconnect,this.onDisconnectHandler),this.provider.on(di.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ir(t.logger,this.name):Go(Jo({level:t.logger||YI})),this.messages=new vx(this.logger,t.core),this.subscriber=new Px(this,this.logger),this.publisher=new mx(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Up,this.projectId=t.projectId,this.bundleId=gw(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${cf}...`),await this.restartTransport(cf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},rx)}get context(){return gr(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,s){this.isInitialized(),await this.publisher.publish(t,r,s),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var s;this.isInitialized();let a=((s=this.subscriber.topicMap.get(t))==null?void 0:s[0])||"";if(a)return a;let u;const f=g=>{g.topic===t&&(this.subscriber.off(zr.created,f),u())};return await Promise.all([new Promise(g=>{u=g,this.subscriber.on(zr.created,f)}),new Promise(async g=>{a=await this.subscriber.subscribe(t,r),g()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ls(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(zr.resubscribed,()=>{r()})}),new Promise(async(r,s)=>{try{await ls(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){s(a);return}r()})])}catch(r){this.logger.error(r);const s=r;if(!this.isConnectionStalled(s.message))throw r;this.provider.events.emit(di.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Nl())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new vi(new dE(_w({sdkVersion:tx,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:s}=t;await this.messages.set(r,s)}async shouldIgnoreMessageEvent(t){const{topic:r,message:s}=t;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,s);return a&&this.logger.debug(`Ignoring duplicate message: ${s}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),lu(t)){if(!t.method.endsWith(XI))return;const r=t.params,{topic:s,message:a,publishedAt:u}=r.data,f={topic:s,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ax({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Yo(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=hu(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(di.payload,this.onPayloadHandler),this.provider.off(di.connect,this.onConnectHandler),this.provider.off(di.disconnect,this.onDisconnectHandler),this.provider.off(di.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Nl();pb(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ee.toMiliseconds(ex)))}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Cx=Object.defineProperty,pf=Object.getOwnPropertySymbols,Nx=Object.prototype.hasOwnProperty,$x=Object.prototype.propertyIsEnumerable,df=(n,t,r)=>t in n?Cx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,gf=(n,t)=>{for(var r in t||(t={}))Nx.call(t,r)&&df(n,r,t[r]);if(pf)for(var r of pf(t))$x.call(t,r)&&df(n,r,t[r]);return n};class Xo extends R_{constructor(t,r,s,a=Ci,u=void 0){super(t,r,s,a),this.core=t,this.logger=r,this.name=s,this.map=new Map,this.version=ix,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!rr(f)?this.map.set(this.getKey(f),f):Kw(f)?this.map.set(f.id,f):Bw(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(m=>ko(g[m],f[m]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const m=gf(gf({},this.getData(f)),g);this.map.set(f,m),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ir(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:s}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Dx{constructor(t,r){this.core=t,this.logger=r,this.name=cx,this.version=ux,this.events=new Ut,this.initialized=!1,this.storagePrefix=Ci,this.ignoredPayloadTypes=[Zi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Kc(),a=await this.core.crypto.setSymKey(s),u=kr(ee.FIVE_MINUTES),f={protocol:qp},g={topic:a,expiry:u,relay:f,active:!1},m=Dw({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:f});return await this.pairings.set(a,g),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:m}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:a,symKey:u,relay:f}=Ol(s.uri);let g;if(this.pairings.keys.includes(a)&&(g=this.pairings.get(a),g.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const m=kr(ee.FIVE_MINUTES),y={topic:a,relay:f,expiry:m,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,m),s.activatePairing&&await this.activate({topic:a}),this.events.emit(cs.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:f})),y},this.activate=async({topic:s})=>{this.isInitialized();const a=kr(ee.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:a}),this.core.expirer.set(s,a)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:a}=s;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:f,resolve:g,reject:m}=Pn();this.events.once(Ct("pairing_ping",u),({error:y})=>{y?m(y):g()}),await f()}},this.updateExpiry=async({topic:s,expiry:a})=>{this.isInitialized(),await this.pairings.update(s,{expiry:a})},this.updateMetadata=async({topic:s,metadata:a})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:a}=s;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",bt("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(s,a,u)=>{const f=Tn(a,u),g=await this.core.crypto.encode(s,f),m=rs[a].req;return this.core.history.set(s,f),this.core.relayer.publish(s,g,m),f.id},this.sendResult=async(s,a,u)=>{const f=hu(s,u),g=await this.core.crypto.encode(a,f),m=await this.core.history.get(a,s),y=rs[m.request.method].res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.sendError=async(s,a,u)=>{const f=Qo(s,u),g=await this.core.crypto.encode(a,f),m=await this.core.history.get(a,s),y=rs[m.request.method]?rs[m.request.method].res:rs.unregistered_method.res;await this.core.relayer.publish(a,g,y),await this.core.history.resolve(f)},this.deletePairing=async(s,a)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,bt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),a?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(a=>Ti(a.expiry));await Promise.all(s.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=s=>{const{topic:a,payload:u}=s;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async s=>{const{topic:a,payload:u}=s,f=(await this.core.history.get(a,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(s,a)=>{const{id:u}=a;try{this.isValidPing({topic:s}),await this.sendResult(u,s,!0),this.events.emit(cs.ping,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onPairingPingResponse=(s,a)=>{const{id:u}=a;setTimeout(()=>{yi(a)?this.events.emit(Ct("pairing_ping",u),{}):Hr(a)&&this.events.emit(Ct("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(s,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit(cs.delete,{id:u,topic:s})}catch(f){await this.sendError(u,s,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(s,a)=>{const{id:u,method:f}=a;try{if(this.registeredMethods.includes(f))return;const g=bt("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,s,g),this.logger.error(g)}catch(g){await this.sendError(u,s,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error(bt("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{var a;if(!pr(s)){const{message:f}=B("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(f)}if(!Hw(s.uri)){const{message:f}=B("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(f)}const u=Ol(s.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:f}=B("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=B("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async s=>{if(!pr(s)){const{message:u}=B("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidDisconnect=async s=>{if(!pr(s)){const{message:u}=B("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(u)}const{topic:a}=s;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async s=>{if(!qt(s,!1)){const{message:a}=B("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(a)}if(!this.pairings.keys.includes(s)){const{message:a}=B("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(a)}if(Ti(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:a}=B("EXPIRED",`pairing topic: ${s}`);throw new Error(a)}},this.core=t,this.logger=Ir(r,this.name),this.pairings=new Xo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return gr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const a=await this.core.crypto.decode(r,s);try{lu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Yo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on($r.expired,async t=>{const{topic:r}=ap(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(cs.expire,{topic:r}))})}}class Fx extends x_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Ut.EventEmitter,this.name=hx,this.version=lx,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:a,chainId:u}),this.records.has(a.id))return;const f={id:a.id,topic:s,request:{method:a.method,params:a.params||null},chainId:u,expiry:kr(ee.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Yr.created,f)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const a=await this.getRecord(s.id);typeof a.response>"u"&&(a.response=Hr(s)?{error:s.error}:{result:s.result},this.records.set(a.id,a),this.events.emit(Yr.updated,a))},this.get=async(s,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:a}),await this.getRecord(a)),this.delete=(s,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===s){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(Yr.deleted,u)}})},this.exists=async(s,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===s:!1),this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ir(r,this.name)}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const s={topic:r.topic,request:Tn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(s)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:s}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(s)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Yr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Yr.created,t=>{const r=Yr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.updated,t=>{const r=Yr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Yr.deleted,t=>{const r=Yr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ee.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Lx extends T_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Ut.EventEmitter,this.name=fx,this.version=px,this.cached=[],this.initialized=!1,this.storagePrefix=Ci,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const a=this.formatTarget(s);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(s,a)=>{this.isInitialized();const u=this.formatTarget(s),f={target:u,expiry:a};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit($r.created,{target:u,expiration:f})},this.get=s=>{this.isInitialized();const a=this.formatTarget(s);return this.getExpiration(a)},this.del=s=>{if(this.isInitialized(),this.has(s)){const a=this.formatTarget(s),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit($r.deleted,{target:a,expiration:u})}},this.on=(s,a)=>{this.events.on(s,a)},this.once=(s,a)=>{this.events.once(s,a)},this.off=(s,a)=>{this.events.off(s,a)},this.removeListener=(s,a)=>{this.events.removeListener(s,a)},this.logger=Ir(r,this.name)}get context(){return gr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Ew(t);if(typeof t=="number")return Iw(t);const{message:r}=B("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit($r.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=B("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:s}=B("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}return r}checkExpiry(t,r){const{expiry:s}=r;ee.toMiliseconds(s)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit($r.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Dn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on($r.created,t=>{const r=$r.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on($r.expired,t=>{const r=$r.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on($r.deleted,t=>{const r=$r.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}}}class jx extends C_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=$c,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||Cn()||!Nn())return;const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Qc;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(s==null?void 0:s.verifyUrl);let u;try{u=await this.fetchAttestation(s.attestationId,a)}catch(f){this.logger.info(`failed to resolve attestation: ${s.attestationId} from url: ${a}`),this.logger.info(f),u=await this.fetchAttestation(s.attestationId,Qc)}return u},this.fetchAttestation=async(s,a)=>{this.logger.info(`resolving attestation: ${s} from url: ${a}`);const u=this.startAbortTimer(ee.ONE_SECOND*2),f=await fetch(`${a}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),s())};await Promise.race([new Promise(u=>{if(document.getElementById($c))return u();window.addEventListener("message",a);const f=document.createElement("iframe");f.id=$c,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,s=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",a),f("verify iframe load timeout")},ee.toMiliseconds(ee.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=s=>{let a=s||Sn;return dx.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${Sn}`),a=Sn),a},this.logger=Ir(r,this.name),this.verifyUrl=Sn,this.abortController=new AbortController,this.isDevEnv=nu()&&{}.IS_VITEST}get context(){return gr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ee.toMiliseconds(t))}}var Mx=Object.defineProperty,yf=Object.getOwnPropertySymbols,qx=Object.prototype.hasOwnProperty,Ux=Object.prototype.propertyIsEnumerable,vf=(n,t,r)=>t in n?Mx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,mf=(n,t)=>{for(var r in t||(t={}))qx.call(t,r)&&vf(n,r,t[r]);if(yf)for(var r of yf(t))Ux.call(t,r)&&vf(n,r,t[r]);return n};class pu extends I_{constructor(t){super(t),this.protocol=Mp,this.version=UI,this.name=fu,this.events=new Ut.EventEmitter,this.initialized=!1,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Up,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Go(Jo({level:(t==null?void 0:t.logger)||zI.logger}));this.logger=Ir(r,this.name),this.heartbeat=new Dn.HeartBeat,this.crypto=new yx(this,this.logger,t==null?void 0:t.keychain),this.history=new Fx(this,this.logger),this.expirer=new Lx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Gb(mf(mf({},kI),t==null?void 0:t.storageOptions)),this.relayer=new Tx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Dx(this,this.logger),this.verify=new jx(this.projectId||"",this.logger)}static async init(t){const r=new pu(t);await r.initialize();const s=await r.crypto.getClientId();return await r.storage.setItem(nx,s),r}get context(){return gr(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const zx=pu,zp="wc",kp=2,Hp="client",du=`${zp}@${kp}:${Hp}:`,Fc={name:Hp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},wf="WALLETCONNECT_DEEPLINK_CHOICE",kx="proposal",Kp="Proposal expired",Hx="session",To=ee.SEVEN_DAYS,Kx="engine",ns={wc_sessionPropose:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ee.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ee.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ee.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ee.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ee.THIRTY_SECONDS,prompt:!1,tag:1115}}},Lc={min:ee.FIVE_MINUTES,max:ee.SEVEN_DAYS},gi={idle:"IDLE",active:"ACTIVE"},Bx="request",Vx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Gx=Object.defineProperty,Wx=Object.defineProperties,Jx=Object.getOwnPropertyDescriptors,bf=Object.getOwnPropertySymbols,Qx=Object.prototype.hasOwnProperty,Yx=Object.prototype.propertyIsEnumerable,_f=(n,t,r)=>t in n?Gx(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,lr=(n,t)=>{for(var r in t||(t={}))Qx.call(t,r)&&_f(n,r,t[r]);if(bf)for(var r of bf(t))Yx.call(t,r)&&_f(n,r,t[r]);return n},ss=(n,t)=>Wx(n,Jx(t));class Zx extends $_{constructor(t){super(t),this.name=Kx,this.events=new Ut,this.initialized=!1,this.ignoredPayloadTypes=[Zi],this.requestQueue={state:gi.idle,queue:[]},this.sessionRequestQueue={state:gi.idle,queue:[]},this.requestQueueDelay=ee.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(ns)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ee.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const s=ss(lr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:g,relays:m}=s;let y=a,E,x=!1;if(y&&(x=this.client.core.pairing.pairings.get(y).active),!y||!x){const{topic:ae,uri:te}=await this.client.core.pairing.create();y=ae,E=te}const $=await this.client.core.crypto.generateKeyPair(),L=lr({requiredNamespaces:u,optionalNamespaces:f,relays:m??[{protocol:qp}],proposer:{publicKey:$,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:T,resolve:Y,done:re}=Pn(ee.FIVE_MINUTES,Kp);if(this.events.once(Ct("session_connect"),async({error:ae,session:te})=>{if(ae)T(ae);else if(te){te.self.publicKey=$;const he=ss(lr({},te),{requiredNamespaces:te.requiredNamespaces,optionalNamespaces:te.optionalNamespaces});await this.client.session.set(te.topic,he),await this.setExpiry(te.topic,te.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:te.peer.metadata}),Y(he)}}),!y){const{message:ae}=B("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(ae)}const oe=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:L}),ce=kr(ee.FIVE_MINUTES);return await this.setProposal(oe,lr({id:oe,expiry:ce},L)),{uri:E,approval:re}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:s,relayProtocol:a,namespaces:u,sessionProperties:f}=r,g=this.client.proposal.get(s);let{pairingTopic:m,proposer:y,requiredNamespaces:E,optionalNamespaces:x}=g;m=m||"",An(E)||(E=Mw(u,"approve()"));const $=await this.client.core.crypto.generateKeyPair(),L=y.publicKey,T=await this.client.core.crypto.generateSharedKey($,L);m&&s&&(await this.client.core.pairing.updateMetadata({topic:m,metadata:y.metadata}),await this.sendResult({id:s,topic:m,result:{relay:{protocol:a??"irn"},responderPublicKey:$}}),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:m}));const Y=lr({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:E,optionalNamespaces:x,pairingTopic:m,controller:{publicKey:$,metadata:this.client.metadata},expiry:kr(To)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(T),await this.sendRequest({topic:T,method:"wc_sessionSettle",params:Y,throwOnFailedPublish:!0});const re=ss(lr({},Y),{topic:T,pairingTopic:m,acknowledged:!1,self:Y.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:$});return await this.client.session.set(T,re),await this.setExpiry(T,kr(To)),{topic:T,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(T)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:s,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(s);u&&(await this.sendError(s,u,a),await this.client.proposal.delete(s,bt("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:s,namespaces:a}=r,u=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:f,resolve:g,reject:m}=Pn();return this.events.once(Ct("session_update",u),({error:y})=>{y?m(y):g()}),await this.client.session.update(s,{namespaces:a}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:s}=r,a=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:u,resolve:f,reject:g}=Pn();return this.events.once(Ct("session_extend",a),({error:m})=>{m?g(m):f()}),await this.setExpiry(s,kr(To)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:s,request:a,topic:u,expiry:f}=r,g=uu(),{done:m,resolve:y,reject:E}=Pn(f,"Request expired. Please try again.");return this.events.once(Ct("session_request",g),({error:x,result:$})=>{x?E(x):y($)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:s},expiry:f,throwOnFailedPublish:!0}).catch($=>E($)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:s,id:g}),x()}),new Promise(async x=>{const $=await Pw(this.client.core.storage,wf);xw({id:g,topic:u,wcDeepLink:$}),x()}),m()]).then(x=>x[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:s,response:a}=r,{id:u}=a;yi(a)?await this.sendResult({id:u,topic:s,result:a.result,throwOnFailedPublish:!0}):Hr(a)&&await this.sendError(u,s,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:s}=r;if(this.client.session.keys.includes(s)){const a=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:u,resolve:f,reject:g}=Pn();this.events.once(Ct("session_ping",a),({error:m})=>{m?g(m):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:s,event:a,chainId:u}=r;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:bt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(s=>zw(s,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const s=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var f,g;return((f=u.peerMetadata)==null?void 0:f.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==s.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(r,s)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,bt("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),s||this.client.core.expirer.del(r),this.client.core.storage.removeItem(wf).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(r,s)=>{await Promise.all([this.client.proposal.delete(r,bt("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,s,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,s),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=gi.idle)},this.setExpiry=async(r,s)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:s}),this.client.core.expirer.set(r,s)},this.setProposal=async(r,s)=>{await this.client.proposal.set(r,s),this.client.core.expirer.set(r,s.expiry)},this.setPendingSessionRequest=async r=>{const s=ns.wc_sessionRequest.req.ttl,{id:a,topic:u,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:f,verifyContext:g}),s&&this.client.core.expirer.set(a,kr(s))},this.sendRequest=async r=>{const{topic:s,method:a,params:u,expiry:f,relayRpcId:g,clientRpcId:m,throwOnFailedPublish:y}=r,E=Tn(a,u,m);if(Nn()&&Vx.includes(a)){const L=Rn(JSON.stringify(E));this.client.core.verify.register({attestationId:L})}const x=await this.client.core.crypto.encode(s,E),$=ns[a].req;return f&&($.ttl=f),g&&($.id=g),this.client.core.history.set(s,E),y?($.internal=ss(lr({},$.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,x,$)):this.client.core.relayer.publish(s,x,$).catch(L=>this.client.logger.error(L)),E.id},this.sendResult=async r=>{const{id:s,topic:a,result:u,throwOnFailedPublish:f}=r,g=hu(s,u),m=await this.client.core.crypto.encode(a,g),y=await this.client.core.history.get(a,s),E=ns[y.request.method].res;f?(E.internal=ss(lr({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,m,E)):this.client.core.relayer.publish(a,m,E).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(g)},this.sendError=async(r,s,a)=>{const u=Qo(r,a),f=await this.client.core.crypto.encode(s,u),g=await this.client.core.history.get(s,r),m=ns[g.request.method].res;this.client.core.relayer.publish(s,f,m),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],s=[];this.client.session.getAll().forEach(a=>{Ti(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{Ti(a.expiry)&&s.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...s.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===gi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=gi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=gi.idle},this.processRequest=r=>{const{topic:s,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(s,a);case"wc_sessionSettle":return this.onSessionSettleRequest(s,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,a);case"wc_sessionExtend":return this.onSessionExtendRequest(s,a);case"wc_sessionPing":return this.onSessionPingRequest(s,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,a);case"wc_sessionRequest":return this.onSessionRequest(s,a);case"wc_sessionEvent":return this.onSessionEventRequest(s,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:s,payload:a}=r,u=(await this.client.core.history.get(s,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(s,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,a);case"wc_sessionExtend":return this.onSessionExtendResponse(s,a);case"wc_sessionPing":return this.onSessionPingResponse(s,a);case"wc_sessionRequest":return this.onSessionRequestResponse(s,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:s}=r,{message:a}=B("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,s)=>{const{params:a,id:u}=s;try{this.isValidConnect(lr({},s.params));const f=kr(ee.FIVE_MINUTES),g=lr({id:u,pairingTopic:r,expiry:f},a);await this.setProposal(u,g);const m=Rn(JSON.stringify(s)),y=await this.getVerifyContext(m,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:y})}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,s)=>{const{id:a}=s;if(yi(s)){const{result:u}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const m=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:m});const y=await this.client.core.crypto.generateSharedKey(g,m);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const E=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:E}),await this.client.core.pairing.activate({topic:r})}else Hr(s)&&(await this.client.proposal.delete(a,bt("USER_DISCONNECTED")),this.events.emit(Ct("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:g,expiry:m,namespaces:y,requiredNamespaces:E,optionalNamespaces:x,sessionProperties:$,pairingTopic:L}=s.params,T=lr({topic:r,relay:f,expiry:m,namespaces:y,acknowledged:!0,pairingTopic:L,requiredNamespaces:E,optionalNamespaces:x,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},$&&{sessionProperties:$});await this.sendResult({id:s.id,topic:r,result:!0}),this.events.emit(Ct("session_connect"),{session:T}),this.cleanupDuplicatePairings(T)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,s)=>{const{id:a}=s;yi(s)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ct("session_approve",a),{})):Hr(s)&&(await this.client.session.delete(r,bt("USER_DISCONNECTED")),this.events.emit(Ct("session_approve",a),{error:s.error}))},this.onSessionUpdateRequest=async(r,s)=>{const{params:a,id:u}=s;try{const f=`${r}_session_update`,g=So.get(f);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(lr({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),So.set(f,u)}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Ct("session_update",a),{}):Hr(s)&&this.events.emit(Ct("session_update",a),{error:s.error})},this.onSessionExtendRequest=async(r,s)=>{const{id:a}=s;try{this.isValidExtend({topic:r}),await this.setExpiry(r,kr(To)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Ct("session_extend",a),{}):Hr(s)&&this.events.emit(Ct("session_extend",a),{error:s.error})},this.onSessionPingRequest=async(r,s)=>{const{id:a}=s;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,s)=>{const{id:a}=s;setTimeout(()=>{yi(s)?this.events.emit(Ct("session_ping",a),{}):Hr(s)&&this.events.emit(Ct("session_ping",a),{error:s.error})},500)},this.onSessionDeleteRequest=async(r,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:r,reason:s.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Jt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,s)=>{const{id:a,params:u}=s;try{this.isValidRequest(lr({topic:r},u));const f=Rn(JSON.stringify(Tn("wc_sessionRequest",u,a))),g=this.client.session.get(r),m=await this.getVerifyContext(f,g.peer.metadata),y={id:a,topic:r,params:u,verifyContext:m};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,s)=>{const{id:a}=s;yi(s)?this.events.emit(Ct("session_request",a),{result:s.result}):Hr(s)&&this.events.emit(Ct("session_request",a),{error:s.error})},this.onSessionEventRequest=async(r,s)=>{const{id:a,params:u}=s;try{const f=`${r}_session_event_${u.event.name}`,g=So.get(f);if(g&&this.isRequestOutOfSync(g,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(lr({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),So.set(f,a)}catch(f){await this.sendError(a,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=gi.idle,this.processSessionRequestQueue()},ee.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===gi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=gi.active,this.client.events.emit("session_request",r)}catch(s){this.client.logger.error(s)}},this.onPairingCreated=r=>{if(r.active)return;const s=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);s&&this.onSessionProposeRequest(r.topic,Tn("wc_sessionPropose",{requiredNamespaces:s.requiredNamespaces,optionalNamespaces:s.optionalNamespaces,relays:s.relays,proposer:s.proposer,sessionProperties:s.sessionProperties},s.id))},this.isValidConnect=async r=>{if(!pr(r)){const{message:m}=B("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(m)}const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:f,relays:g}=r;if(rr(s)||await this.isValidPairingTopic(s),!Xw(g,!0)){const{message:m}=B("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(m)}!rr(a)&&An(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!rr(u)&&An(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),rr(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,s)=>{const a=Zw(r,"connect()",s);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!pr(r))throw new Error(B("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:s,namespaces:a,relayProtocol:u,sessionProperties:f}=r;await this.isValidProposalId(s);const g=this.client.proposal.get(s),m=Fo(a,"approve()");if(m)throw new Error(m.message);const y=Tl(g.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!qt(u,!0)){const{message:E}=B("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(E)}rr(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!pr(r)){const{message:u}=B("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:s,reason:a}=r;if(await this.isValidProposalId(s),!tb(a)){const{message:u}=B("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!pr(r)){const{message:y}=B("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:s,controller:a,namespaces:u,expiry:f}=r;if(!up(s)){const{message:y}=B("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const g=Vw(a,"onSessionSettleRequest()");if(g)throw new Error(g.message);const m=Fo(u,"onSessionSettleRequest()");if(m)throw new Error(m.message);if(Ti(f)){const{message:y}=B("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!pr(r)){const{message:m}=B("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(m)}const{topic:s,namespaces:a}=r;await this.isValidSessionTopic(s);const u=this.client.session.get(s),f=Fo(a,"update()");if(f)throw new Error(f.message);const g=Tl(u.requiredNamespaces,a,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!pr(r)){const{message:a}=B("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionTopic(s)},this.isValidRequest=async r=>{if(!pr(r)){const{message:m}=B("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(m)}const{topic:s,request:a,chainId:u,expiry:f}=r;await this.isValidSessionTopic(s);const{namespaces:g}=this.client.session.get(s);if(!Al(g,u)){const{message:m}=B("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(m)}if(!rb(a)){const{message:m}=B("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(m)}if(!sb(g,u,a.method)){const{message:m}=B("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(m)}if(f&&!ub(f,Lc)){const{message:m}=B("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${Lc.min} and ${Lc.max}`);throw new Error(m)}},this.isValidRespond=async r=>{if(!pr(r)){const{message:u}=B("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:s,response:a}=r;if(await this.isValidSessionTopic(s),!ib(a)){const{message:u}=B("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!pr(r)){const{message:a}=B("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async r=>{if(!pr(r)){const{message:g}=B("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:s,event:a,chainId:u}=r;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!Al(f,u)){const{message:g}=B("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!nb(a)){const{message:g}=B("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}if(!ob(f,u,a.name)){const{message:g}=B("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!pr(r)){const{message:a}=B("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:s}=r;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(r,s)=>{const a={verified:{verifyUrl:s.verifyUrl||Sn,validation:"UNKNOWN",origin:s.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:s.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,s)=>{Object.values(r).forEach(a=>{if(!qt(a,!1)){const{message:u}=B("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=B("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:s}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const a=await this.client.core.crypto.decode(r,s);try{lu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Yo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on($r.expired,async t=>{const{topic:r,id:s}=ap(t.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,B("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}registerPairingEvents(){this.client.core.pairing.events.on(cs.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!qt(t,!1)){const{message:r}=B("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=B("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=B("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!qt(t,!1)){const{message:r}=B("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=B("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=B("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(qt(t,!1)){const{message:r}=B("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=B("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!eb(t)){const{message:r}=B("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=B("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Ti(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=B("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class Xx extends Xo{constructor(t,r){super(t,r,kx,du),this.core=t,this.logger=r}}class eP extends Xo{constructor(t,r){super(t,r,Hx,du),this.core=t,this.logger=r}}class tP extends Xo{constructor(t,r){super(t,r,Bx,du,s=>s.id),this.core=t,this.logger=r}}let rP=class Bp extends N_{constructor(t){super(t),this.protocol=zp,this.version=kp,this.name=Fc.name,this.events=new Ut.EventEmitter,this.on=(s,a)=>this.events.on(s,a),this.once=(s,a)=>this.events.once(s,a),this.off=(s,a)=>this.events.off(s,a),this.removeListener=(s,a)=>this.events.removeListener(s,a),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(a){throw this.logger.error(a.message),a}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(a){throw this.logger.error(a.message),a}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(a){throw this.logger.error(a.message),a}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(a){throw this.logger.error(a.message),a}},this.update=async s=>{try{return await this.engine.update(s)}catch(a){throw this.logger.error(a.message),a}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(a){throw this.logger.error(a.message),a}},this.request=async s=>{try{return await this.engine.request(s)}catch(a){throw this.logger.error(a.message),a}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(a){throw this.logger.error(a.message),a}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(a){throw this.logger.error(a.message),a}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(a){throw this.logger.error(a.message),a}},this.find=s=>{try{return this.engine.find(s)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Fc.name,this.metadata=(t==null?void 0:t.metadata)||vw();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Go(Jo({level:(t==null?void 0:t.logger)||Fc.logger}));this.core=(t==null?void 0:t.core)||new zx(t),this.logger=Ir(r,this.name),this.session=new eP(this.core,this.logger),this.proposal=new Xx(this.core,this.logger),this.pendingRequest=new tP(this.core,this.logger),this.engine=new Zx(this)}static async init(t){const r=new Bp(t);return await r.initialize(),r}get context(){return gr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Ho={},iP={get exports(){return Ho},set exports(n){Ho=n}};(function(n,t){var r=typeof self<"u"?self:Kr,s=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(f){var g={searchParams:"URLSearchParams"in u,iterable:"Symbol"in u&&"iterator"in Symbol,blob:"FileReader"in u&&"Blob"in u&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in u,arrayBuffer:"ArrayBuffer"in u};function m(b){return b&&DataView.prototype.isPrototypeOf(b)}if(g.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],E=ArrayBuffer.isView||function(b){return b&&y.indexOf(Object.prototype.toString.call(b))>-1};function x(b){if(typeof b!="string"&&(b=String(b)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(b))throw new TypeError("Invalid character in header field name");return b.toLowerCase()}function $(b){return typeof b!="string"&&(b=String(b)),b}function L(b){var O={next:function(){var J=b.shift();return{done:J===void 0,value:J}}};return g.iterable&&(O[Symbol.iterator]=function(){return O}),O}function T(b){this.map={},b instanceof T?b.forEach(function(O,J){this.append(J,O)},this):Array.isArray(b)?b.forEach(function(O){this.append(O[0],O[1])},this):b&&Object.getOwnPropertyNames(b).forEach(function(O){this.append(O,b[O])},this)}T.prototype.append=function(b,O){b=x(b),O=$(O);var J=this.map[b];this.map[b]=J?J+", "+O:O},T.prototype.delete=function(b){delete this.map[x(b)]},T.prototype.get=function(b){return b=x(b),this.has(b)?this.map[b]:null},T.prototype.has=function(b){return this.map.hasOwnProperty(x(b))},T.prototype.set=function(b,O){this.map[x(b)]=$(O)},T.prototype.forEach=function(b,O){for(var J in this.map)this.map.hasOwnProperty(J)&&b.call(O,this.map[J],J,this)},T.prototype.keys=function(){var b=[];return this.forEach(function(O,J){b.push(J)}),L(b)},T.prototype.values=function(){var b=[];return this.forEach(function(O){b.push(O)}),L(b)},T.prototype.entries=function(){var b=[];return this.forEach(function(O,J){b.push([J,O])}),L(b)},g.iterable&&(T.prototype[Symbol.iterator]=T.prototype.entries);function Y(b){if(b.bodyUsed)return Promise.reject(new TypeError("Already read"));b.bodyUsed=!0}function re(b){return new Promise(function(O,J){b.onload=function(){O(b.result)},b.onerror=function(){J(b.error)}})}function oe(b){var O=new FileReader,J=re(O);return O.readAsArrayBuffer(b),J}function ce(b){var O=new FileReader,J=re(O);return O.readAsText(b),J}function ae(b){for(var O=new Uint8Array(b),J=new Array(O.length),le=0;le<O.length;le++)J[le]=String.fromCharCode(O[le]);return J.join("")}function te(b){if(b.slice)return b.slice(0);var O=new Uint8Array(b.byteLength);return O.set(new Uint8Array(b)),O.buffer}function he(){return this.bodyUsed=!1,this._initBody=function(b){this._bodyInit=b,b?typeof b=="string"?this._bodyText=b:g.blob&&Blob.prototype.isPrototypeOf(b)?this._bodyBlob=b:g.formData&&FormData.prototype.isPrototypeOf(b)?this._bodyFormData=b:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)?this._bodyText=b.toString():g.arrayBuffer&&g.blob&&m(b)?(this._bodyArrayBuffer=te(b.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(b)||E(b))?this._bodyArrayBuffer=te(b):this._bodyText=b=Object.prototype.toString.call(b):this._bodyText="",this.headers.get("content-type")||(typeof b=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(b)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var b=Y(this);if(b)return b;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?Y(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(oe)}),this.text=function(){var b=Y(this);if(b)return b;if(this._bodyBlob)return ce(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ae(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(_t)}),this.json=function(){return this.text().then(JSON.parse)},this}var pe=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function Q(b){var O=b.toUpperCase();return pe.indexOf(O)>-1?O:b}function ve(b,O){O=O||{};var J=O.body;if(b instanceof ve){if(b.bodyUsed)throw new TypeError("Already read");this.url=b.url,this.credentials=b.credentials,O.headers||(this.headers=new T(b.headers)),this.method=b.method,this.mode=b.mode,this.signal=b.signal,!J&&b._bodyInit!=null&&(J=b._bodyInit,b.bodyUsed=!0)}else this.url=String(b);if(this.credentials=O.credentials||this.credentials||"same-origin",(O.headers||!this.headers)&&(this.headers=new T(O.headers)),this.method=Q(O.method||this.method||"GET"),this.mode=O.mode||this.mode||null,this.signal=O.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&J)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(J)}ve.prototype.clone=function(){return new ve(this,{body:this._bodyInit})};function _t(b){var O=new FormData;return b.trim().split("&").forEach(function(J){if(J){var le=J.split("="),k=le.shift().replace(/\+/g," "),z=le.join("=").replace(/\+/g," ");O.append(decodeURIComponent(k),decodeURIComponent(z))}}),O}function st(b){var O=new T,J=b.replace(/\r?\n[\t ]+/g," ");return J.split(/\r?\n/).forEach(function(le){var k=le.split(":"),z=k.shift().trim();if(z){var H=k.join(":").trim();O.append(z,H)}}),O}he.call(ve.prototype);function Ke(b,O){O||(O={}),this.type="default",this.status=O.status===void 0?200:O.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in O?O.statusText:"OK",this.headers=new T(O.headers),this.url=O.url||"",this._initBody(b)}he.call(Ke.prototype),Ke.prototype.clone=function(){return new Ke(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new T(this.headers),url:this.url})},Ke.error=function(){var b=new Ke(null,{status:0,statusText:""});return b.type="error",b};var zt=[301,302,303,307,308];Ke.redirect=function(b,O){if(zt.indexOf(O)===-1)throw new RangeError("Invalid status code");return new Ke(null,{status:O,headers:{location:b}})},f.DOMException=u.DOMException;try{new f.DOMException}catch{f.DOMException=function(O,J){this.message=O,this.name=J;var le=Error(O);this.stack=le.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function kt(b,O){return new Promise(function(J,le){var k=new ve(b,O);if(k.signal&&k.signal.aborted)return le(new f.DOMException("Aborted","AbortError"));var z=new XMLHttpRequest;function H(){z.abort()}z.onload=function(){var K={status:z.status,statusText:z.statusText,headers:st(z.getAllResponseHeaders()||"")};K.url="responseURL"in z?z.responseURL:K.headers.get("X-Request-URL");var et="response"in z?z.response:z.responseText;J(new Ke(et,K))},z.onerror=function(){le(new TypeError("Network request failed"))},z.ontimeout=function(){le(new TypeError("Network request failed"))},z.onabort=function(){le(new f.DOMException("Aborted","AbortError"))},z.open(k.method,k.url,!0),k.credentials==="include"?z.withCredentials=!0:k.credentials==="omit"&&(z.withCredentials=!1),"responseType"in z&&g.blob&&(z.responseType="blob"),k.headers.forEach(function(K,et){z.setRequestHeader(et,K)}),k.signal&&(k.signal.addEventListener("abort",H),z.onreadystatechange=function(){z.readyState===4&&k.signal.removeEventListener("abort",H)}),z.send(typeof k._bodyInit>"u"?null:k._bodyInit)})}return kt.polyfill=!0,u.fetch||(u.fetch=kt,u.Headers=T,u.Request=ve,u.Response=Ke),f.Headers=T,f.Request=ve,f.Response=Ke,f.fetch=kt,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(s),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var a=s;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,n.exports=t})(iP,Ho);const Ef=H1(Ho);var nP=Object.defineProperty,sP=Object.defineProperties,oP=Object.getOwnPropertyDescriptors,If=Object.getOwnPropertySymbols,aP=Object.prototype.hasOwnProperty,cP=Object.prototype.propertyIsEnumerable,xf=(n,t,r)=>t in n?nP(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Pf=(n,t)=>{for(var r in t||(t={}))aP.call(t,r)&&xf(n,r,t[r]);if(If)for(var r of If(t))cP.call(t,r)&&xf(n,r,t[r]);return n},Sf=(n,t)=>sP(n,oP(t));const uP={Accept:"application/json","Content-Type":"application/json"},hP="POST",Of={headers:uP,method:hP},Rf=10;let $i=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Ut.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ql(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Yi(t),s=await(await Ef(this.url,Sf(Pf({},Of),{body:r}))).json();this.onPayload({data:s})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!Ql(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((s,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));s()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Yi({id:1,jsonrpc:"2.0",method:"test",params:[]});await Ef(t,Sf(Pf({},Of),{body:r}))}this.onOpen()}catch(r){const s=this.parseError(r);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ms(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const s=this.parseError(r),a=s.message||s.toString(),u=Qo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Ep(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Rf&&this.events.setMaxListeners(Rf)}};const Af="error",lP="wss://relay.walletconnect.com",fP="wc",pP="universal_provider",Tf=`${fP}@2:${pP}:`,dP="https://rpc.walletconnect.com/v1/",mi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var os=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Yc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(n,t){(function(){var r,s="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",y=500,E="__lodash_placeholder__",x=1,$=2,L=4,T=1,Y=2,re=1,oe=2,ce=4,ae=8,te=16,he=32,pe=64,Q=128,ve=256,_t=512,st=30,Ke="...",zt=800,kt=16,b=1,O=2,J=3,le=1/0,k=9007199254740991,z=17976931348623157e292,H=0/0,K=4294967295,et=K-1,ot=K>>>1,Di=[["ary",Q],["bind",re],["bindKey",oe],["curry",ae],["curryRight",te],["flip",_t],["partial",he],["partialRight",pe],["rearg",ve]],Ee="[object Arguments]",Dr="[object Array]",D="[object AsyncFunction]",N="[object Boolean]",A="[object Date]",h="[object DOMException]",I="[object Error]",Z="[object Function]",ue="[object GeneratorFunction]",me="[object Map]",Oe="[object Number]",Ae="[object Null]",Ie="[object Object]",Et="[object Promise]",gt="[object Proxy]",tt="[object RegExp]",Ce="[object Set]",Be="[object String]",Ve="[object Symbol]",rt="[object Undefined]",Fe="[object WeakMap]",Ge="[object WeakSet]",Re="[object ArrayBuffer]",Me="[object DataView]",at="[object Float32Array]",$e="[object Float64Array]",It="[object Int8Array]",Nt="[object Int16Array]",Ht="[object Int32Array]",Kt="[object Uint8Array]",Ft="[object Uint8ClampedArray]",Qt="[object Uint16Array]",sr="[object Uint32Array]",Br=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,ei=/(__e\(.*?\)|\b__t\)) \+\n'';/g,wi=/&(?:amp|lt|gt|quot|#39);/g,Fi=/[&<>"']/g,ct=RegExp(wi.source),Qe=RegExp(Fi.source),ut=/<%-([\s\S]+?)%>/g,ht=/<%([\s\S]+?)%>/g,it=/<%=([\s\S]+?)%>/g,Ye=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,xt=/^\w*$/,Pt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lt=/[\\^$.*+?()[\]{}|]/g,St=RegExp(lt.source),ft=/^\s+/,yt=/\s/,pt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,He=/\{\n\/\* \[wrapped with (.+)\] \*/,Ot=/,? & /,Rt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ea=/[()=,{}\[\]\/\s]/,ta=/\\(\\)?/g,ra=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xr=/\w*$/,ia=/^[-+]0x[0-9a-f]+$/i,na=/^0b[01]+$/i,sa=/^\[object .+?Constructor\]$/,oa=/^0o[0-7]+$/i,aa=/^(?:0|[1-9]\d*)$/,ti=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rn=/($^)/,ca=/['\n\r\u2028\u2029\\]/g,nn="\\ud800-\\udfff",ua="\\u0300-\\u036f",ha="\\ufe20-\\ufe2f",sn="\\u20d0-\\u20ff",_s=ua+ha+sn,Es="\\u2700-\\u27bf",Fr="a-z\\xdf-\\xf6\\xf8-\\xff",la="\\xac\\xb1\\xd7\\xf7",fa="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",pa="\\u2000-\\u206f",da=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Is="A-Z\\xc0-\\xd6\\xd8-\\xde",xs="\\ufe0e\\ufe0f",Li=la+fa+pa+da,Fn="[']",ji="["+nn+"]",Ln="["+Li+"]",Mi="["+_s+"]",Ps="\\d+",ga="["+Es+"]",Ss="["+Fr+"]",Os="[^"+nn+Li+Ps+Es+Fr+Is+"]",on="\\ud83c[\\udffb-\\udfff]",ya="(?:"+Mi+"|"+on+")",Rs="[^"+nn+"]",an="(?:\\ud83c[\\udde6-\\uddff]){2}",bi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+Is+"]",As="\\u200d",Ts="(?:"+Ss+"|"+Os+")",Vr="(?:"+yr+"|"+Os+")",Cs="(?:"+Fn+"(?:d|ll|m|re|s|t|ve))?",Ns="(?:"+Fn+"(?:D|LL|M|RE|S|T|VE))?",$s=ya+"?",Ds="["+xs+"]?",va="(?:"+As+"(?:"+[Rs,an,bi].join("|")+")"+Ds+$s+")*",ri="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Fs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ls=Ds+$s+va,cn="(?:"+[ga,an,bi].join("|")+")"+Ls,ma="(?:"+[Rs+Mi+"?",Mi,an,bi,ji].join("|")+")",jn=RegExp(Fn,"g"),wa=RegExp(Mi,"g"),un=RegExp(on+"(?="+on+")|"+ma+Ls,"g"),js=RegExp([yr+"?"+Ss+"+"+Cs+"(?="+[Ln,yr,"$"].join("|")+")",Vr+"+"+Ns+"(?="+[Ln,yr+Ts,"$"].join("|")+")",yr+"?"+Ts+"+"+Cs,yr+"+"+Ns,Fs,ri,Ps,cn].join("|"),"g"),Ms=RegExp("["+As+nn+_s+xs+"]"),qi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,qs=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ba=-1,qe={};qe[at]=qe[$e]=qe[It]=qe[Nt]=qe[Ht]=qe[Kt]=qe[Ft]=qe[Qt]=qe[sr]=!0,qe[Ee]=qe[Dr]=qe[Re]=qe[N]=qe[Me]=qe[A]=qe[I]=qe[Z]=qe[me]=qe[Oe]=qe[Ie]=qe[tt]=qe[Ce]=qe[Be]=qe[Fe]=!1;var Le={};Le[Ee]=Le[Dr]=Le[Re]=Le[Me]=Le[N]=Le[A]=Le[at]=Le[$e]=Le[It]=Le[Nt]=Le[Ht]=Le[me]=Le[Oe]=Le[Ie]=Le[tt]=Le[Ce]=Le[Be]=Le[Ve]=Le[Kt]=Le[Ft]=Le[Qt]=Le[sr]=!0,Le[I]=Le[Z]=Le[Fe]=!1;var v={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},G={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ue=parseFloat,de=parseInt,We=typeof os=="object"&&os&&os.Object===Object&&os,At=typeof self=="object"&&self&&self.Object===Object&&self,Pe=We||At||Function("return this")(),ze=t&&!t.nodeType&&t,vt=ze&&!0&&n&&!n.nodeType&&n,or=vt&&vt.exports===ze,Tt=or&&We.process,Je=function(){try{var S=vt&&vt.require&&vt.require("util").types;return S||Tt&&Tt.binding&&Tt.binding("util")}catch{}}(),Zt=Je&&Je.isArrayBuffer,Lr=Je&&Je.isDate,Pr=Je&&Je.isMap,Gr=Je&&Je.isRegExp,Mn=Je&&Je.isSet,Ui=Je&&Je.isTypedArray;function Lt(S,F,C){switch(C.length){case 0:return S.call(F);case 1:return S.call(F,C[0]);case 2:return S.call(F,C[0],C[1]);case 3:return S.call(F,C[0],C[1],C[2])}return S.apply(F,C)}function Wp(S,F,C,W){for(var fe=-1,Te=S==null?0:S.length;++fe<Te;){var $t=S[fe];F(W,$t,C($t),S)}return W}function Sr(S,F){for(var C=-1,W=S==null?0:S.length;++C<W&&F(S[C],C,S)!==!1;);return S}function Jp(S,F){for(var C=S==null?0:S.length;C--&&F(S[C],C,S)!==!1;);return S}function vu(S,F){for(var C=-1,W=S==null?0:S.length;++C<W;)if(!F(S[C],C,S))return!1;return!0}function _i(S,F){for(var C=-1,W=S==null?0:S.length,fe=0,Te=[];++C<W;){var $t=S[C];F($t,C,S)&&(Te[fe++]=$t)}return Te}function Us(S,F){var C=S==null?0:S.length;return!!C&&hn(S,F,0)>-1}function _a(S,F,C){for(var W=-1,fe=S==null?0:S.length;++W<fe;)if(C(F,S[W]))return!0;return!1}function Ze(S,F){for(var C=-1,W=S==null?0:S.length,fe=Array(W);++C<W;)fe[C]=F(S[C],C,S);return fe}function Ei(S,F){for(var C=-1,W=F.length,fe=S.length;++C<W;)S[fe+C]=F[C];return S}function Ea(S,F,C,W){var fe=-1,Te=S==null?0:S.length;for(W&&Te&&(C=S[++fe]);++fe<Te;)C=F(C,S[fe],fe,S);return C}function Qp(S,F,C,W){var fe=S==null?0:S.length;for(W&&fe&&(C=S[--fe]);fe--;)C=F(C,S[fe],fe,S);return C}function Ia(S,F){for(var C=-1,W=S==null?0:S.length;++C<W;)if(F(S[C],C,S))return!0;return!1}var Yp=xa("length");function Zp(S){return S.split("")}function Xp(S){return S.match(Rt)||[]}function mu(S,F,C){var W;return C(S,function(fe,Te,$t){if(F(fe,Te,$t))return W=Te,!1}),W}function zs(S,F,C,W){for(var fe=S.length,Te=C+(W?1:-1);W?Te--:++Te<fe;)if(F(S[Te],Te,S))return Te;return-1}function hn(S,F,C){return F===F?ld(S,F,C):zs(S,wu,C)}function ed(S,F,C,W){for(var fe=C-1,Te=S.length;++fe<Te;)if(W(S[fe],F))return fe;return-1}function wu(S){return S!==S}function bu(S,F){var C=S==null?0:S.length;return C?Sa(S,F)/C:H}function xa(S){return function(F){return F==null?r:F[S]}}function Pa(S){return function(F){return S==null?r:S[F]}}function _u(S,F,C,W,fe){return fe(S,function(Te,$t,ke){C=W?(W=!1,Te):F(C,Te,$t,ke)}),C}function td(S,F){var C=S.length;for(S.sort(F);C--;)S[C]=S[C].value;return S}function Sa(S,F){for(var C,W=-1,fe=S.length;++W<fe;){var Te=F(S[W]);Te!==r&&(C=C===r?Te:C+Te)}return C}function Oa(S,F){for(var C=-1,W=Array(S);++C<S;)W[C]=F(C);return W}function rd(S,F){return Ze(F,function(C){return[C,S[C]]})}function Eu(S){return S&&S.slice(0,Su(S)+1).replace(ft,"")}function vr(S){return function(F){return S(F)}}function Ra(S,F){return Ze(F,function(C){return S[C]})}function qn(S,F){return S.has(F)}function Iu(S,F){for(var C=-1,W=S.length;++C<W&&hn(F,S[C],0)>-1;);return C}function xu(S,F){for(var C=S.length;C--&&hn(F,S[C],0)>-1;);return C}function id(S,F){for(var C=S.length,W=0;C--;)S[C]===F&&++W;return W}var nd=Pa(v),sd=Pa(P);function od(S){return"\\"+G[S]}function ad(S,F){return S==null?r:S[F]}function ln(S){return Ms.test(S)}function cd(S){return qi.test(S)}function ud(S){for(var F,C=[];!(F=S.next()).done;)C.push(F.value);return C}function Aa(S){var F=-1,C=Array(S.size);return S.forEach(function(W,fe){C[++F]=[fe,W]}),C}function Pu(S,F){return function(C){return S(F(C))}}function Ii(S,F){for(var C=-1,W=S.length,fe=0,Te=[];++C<W;){var $t=S[C];($t===F||$t===E)&&(S[C]=E,Te[fe++]=C)}return Te}function ks(S){var F=-1,C=Array(S.size);return S.forEach(function(W){C[++F]=W}),C}function hd(S){var F=-1,C=Array(S.size);return S.forEach(function(W){C[++F]=[W,W]}),C}function ld(S,F,C){for(var W=C-1,fe=S.length;++W<fe;)if(S[W]===F)return W;return-1}function fd(S,F,C){for(var W=C+1;W--;)if(S[W]===F)return W;return W}function fn(S){return ln(S)?dd(S):Yp(S)}function jr(S){return ln(S)?gd(S):Zp(S)}function Su(S){for(var F=S.length;F--&&yt.test(S.charAt(F)););return F}var pd=Pa(q);function dd(S){for(var F=un.lastIndex=0;un.test(S);)++F;return F}function gd(S){return S.match(un)||[]}function yd(S){return S.match(js)||[]}var vd=function S(F){F=F==null?Pe:pn.defaults(Pe.Object(),F,pn.pick(Pe,qs));var C=F.Array,W=F.Date,fe=F.Error,Te=F.Function,$t=F.Math,ke=F.Object,Ta=F.RegExp,md=F.String,Or=F.TypeError,Hs=C.prototype,wd=Te.prototype,dn=ke.prototype,Ks=F["__core-js_shared__"],Bs=wd.toString,De=dn.hasOwnProperty,bd=0,Ou=function(){var e=/[^.]+$/.exec(Ks&&Ks.keys&&Ks.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Vs=dn.toString,_d=Bs.call(ke),Ed=Pe._,Id=Ta("^"+Bs.call(De).replace(lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Gs=or?F.Buffer:r,xi=F.Symbol,Ws=F.Uint8Array,Ru=Gs?Gs.allocUnsafe:r,Js=Pu(ke.getPrototypeOf,ke),Au=ke.create,Tu=dn.propertyIsEnumerable,Qs=Hs.splice,Cu=xi?xi.isConcatSpreadable:r,Un=xi?xi.iterator:r,zi=xi?xi.toStringTag:r,Ys=function(){try{var e=Vi(ke,"defineProperty");return e({},"",{}),e}catch{}}(),xd=F.clearTimeout!==Pe.clearTimeout&&F.clearTimeout,Pd=W&&W.now!==Pe.Date.now&&W.now,Sd=F.setTimeout!==Pe.setTimeout&&F.setTimeout,Zs=$t.ceil,Xs=$t.floor,Ca=ke.getOwnPropertySymbols,Od=Gs?Gs.isBuffer:r,Nu=F.isFinite,Rd=Hs.join,Ad=Pu(ke.keys,ke),Dt=$t.max,Gt=$t.min,Td=W.now,Cd=F.parseInt,$u=$t.random,Nd=Hs.reverse,Na=Vi(F,"DataView"),zn=Vi(F,"Map"),$a=Vi(F,"Promise"),gn=Vi(F,"Set"),kn=Vi(F,"WeakMap"),Hn=Vi(ke,"create"),eo=kn&&new kn,yn={},$d=Gi(Na),Dd=Gi(zn),Fd=Gi($a),Ld=Gi(gn),jd=Gi(kn),to=xi?xi.prototype:r,Kn=to?to.valueOf:r,Du=to?to.toString:r;function p(e){if(dt(e)&&!ge(e)&&!(e instanceof xe)){if(e instanceof Rr)return e;if(De.call(e,"__wrapped__"))return Fh(e)}return new Rr(e)}var vn=function(){function e(){}return function(i){if(!nt(i))return{};if(Au)return Au(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function ro(){}function Rr(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}p.templateSettings={escape:ut,evaluate:ht,interpolate:it,variable:"",imports:{_:p}},p.prototype=ro.prototype,p.prototype.constructor=p,Rr.prototype=vn(ro.prototype),Rr.prototype.constructor=Rr;function xe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=K,this.__views__=[]}function Md(){var e=new xe(this.__wrapped__);return e.__actions__=ar(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ar(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ar(this.__views__),e}function qd(){if(this.__filtered__){var e=new xe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ud(){var e=this.__wrapped__.value(),i=this.__dir__,o=ge(e),c=i<0,l=o?e.length:0,d=Zg(0,l,this.__views__),w=d.start,_=d.end,R=_-w,j=c?_:w-1,M=this.__iteratees__,U=M.length,V=0,X=Gt(R,this.__takeCount__);if(!o||!c&&l==R&&X==R)return nh(e,this.__actions__);var ne=[];e:for(;R--&&V<X;){j+=i;for(var we=-1,se=e[j];++we<U;){var _e=M[we],Se=_e.iteratee,br=_e.type,tr=Se(se);if(br==O)se=tr;else if(!tr){if(br==b)continue e;break e}}ne[V++]=se}return ne}xe.prototype=vn(ro.prototype),xe.prototype.constructor=xe;function ki(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function zd(){this.__data__=Hn?Hn(null):{},this.size=0}function kd(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Hd(e){var i=this.__data__;if(Hn){var o=i[e];return o===m?r:o}return De.call(i,e)?i[e]:r}function Kd(e){var i=this.__data__;return Hn?i[e]!==r:De.call(i,e)}function Bd(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Hn&&i===r?m:i,this}ki.prototype.clear=zd,ki.prototype.delete=kd,ki.prototype.get=Hd,ki.prototype.has=Kd,ki.prototype.set=Bd;function ii(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Vd(){this.__data__=[],this.size=0}function Gd(e){var i=this.__data__,o=io(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Qs.call(i,o,1),--this.size,!0}function Wd(e){var i=this.__data__,o=io(i,e);return o<0?r:i[o][1]}function Jd(e){return io(this.__data__,e)>-1}function Qd(e,i){var o=this.__data__,c=io(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}ii.prototype.clear=Vd,ii.prototype.delete=Gd,ii.prototype.get=Wd,ii.prototype.has=Jd,ii.prototype.set=Qd;function ni(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Yd(){this.size=0,this.__data__={hash:new ki,map:new(zn||ii),string:new ki}}function Zd(e){var i=yo(this,e).delete(e);return this.size-=i?1:0,i}function Xd(e){return yo(this,e).get(e)}function eg(e){return yo(this,e).has(e)}function tg(e,i){var o=yo(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}ni.prototype.clear=Yd,ni.prototype.delete=Zd,ni.prototype.get=Xd,ni.prototype.has=eg,ni.prototype.set=tg;function Hi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new ni;++i<o;)this.add(e[i])}function rg(e){return this.__data__.set(e,m),this}function ig(e){return this.__data__.has(e)}Hi.prototype.add=Hi.prototype.push=rg,Hi.prototype.has=ig;function Mr(e){var i=this.__data__=new ii(e);this.size=i.size}function ng(){this.__data__=new ii,this.size=0}function sg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function og(e){return this.__data__.get(e)}function ag(e){return this.__data__.has(e)}function cg(e,i){var o=this.__data__;if(o instanceof ii){var c=o.__data__;if(!zn||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new ni(c)}return o.set(e,i),this.size=o.size,this}Mr.prototype.clear=ng,Mr.prototype.delete=sg,Mr.prototype.get=og,Mr.prototype.has=ag,Mr.prototype.set=cg;function Fu(e,i){var o=ge(e),c=!o&&Wi(e),l=!o&&!c&&Ai(e),d=!o&&!c&&!l&&_n(e),w=o||c||l||d,_=w?Oa(e.length,md):[],R=_.length;for(var j in e)(i||De.call(e,j))&&!(w&&(j=="length"||l&&(j=="offset"||j=="parent")||d&&(j=="buffer"||j=="byteLength"||j=="byteOffset")||ci(j,R)))&&_.push(j);return _}function Lu(e){var i=e.length;return i?e[Ka(0,i-1)]:r}function ug(e,i){return vo(ar(e),Ki(i,0,e.length))}function hg(e){return vo(ar(e))}function Da(e,i,o){(o!==r&&!qr(e[i],o)||o===r&&!(i in e))&&si(e,i,o)}function Bn(e,i,o){var c=e[i];(!(De.call(e,i)&&qr(c,o))||o===r&&!(i in e))&&si(e,i,o)}function io(e,i){for(var o=e.length;o--;)if(qr(e[o][0],i))return o;return-1}function lg(e,i,o,c){return Pi(e,function(l,d,w){i(c,l,o(l),w)}),c}function ju(e,i){return e&&Jr(i,jt(i),e)}function fg(e,i){return e&&Jr(i,ur(i),e)}function si(e,i,o){i=="__proto__"&&Ys?Ys(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Fa(e,i){for(var o=-1,c=i.length,l=C(c),d=e==null;++o<c;)l[o]=d?r:gc(e,i[o]);return l}function Ki(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Ar(e,i,o,c,l,d){var w,_=i&x,R=i&$,j=i&L;if(o&&(w=l?o(e,c,l,d):o(e)),w!==r)return w;if(!nt(e))return e;var M=ge(e);if(M){if(w=ey(e),!_)return ar(e,w)}else{var U=Wt(e),V=U==Z||U==ue;if(Ai(e))return ah(e,_);if(U==Ie||U==Ee||V&&!l){if(w=R||V?{}:Sh(e),!_)return R?Hg(e,fg(w,e)):kg(e,ju(w,e))}else{if(!Le[U])return l?e:{};w=ty(e,U,_)}}d||(d=new Mr);var X=d.get(e);if(X)return X;d.set(e,w),tl(e)?e.forEach(function(se){w.add(Ar(se,i,o,se,e,d))}):Xh(e)&&e.forEach(function(se,_e){w.set(_e,Ar(se,i,o,_e,e,d))});var ne=j?R?tc:ec:R?ur:jt,we=M?r:ne(e);return Sr(we||e,function(se,_e){we&&(_e=se,se=e[_e]),Bn(w,_e,Ar(se,i,o,_e,e,d))}),w}function pg(e){var i=jt(e);return function(o){return Mu(o,e,i)}}function Mu(e,i,o){var c=o.length;if(e==null)return!c;for(e=ke(e);c--;){var l=o[c],d=i[l],w=e[l];if(w===r&&!(l in e)||!d(w))return!1}return!0}function qu(e,i,o){if(typeof e!="function")throw new Or(f);return Zn(function(){e.apply(r,o)},i)}function Vn(e,i,o,c){var l=-1,d=Us,w=!0,_=e.length,R=[],j=i.length;if(!_)return R;o&&(i=Ze(i,vr(o))),c?(d=_a,w=!1):i.length>=a&&(d=qn,w=!1,i=new Hi(i));e:for(;++l<_;){var M=e[l],U=o==null?M:o(M);if(M=c||M!==0?M:0,w&&U===U){for(var V=j;V--;)if(i[V]===U)continue e;R.push(M)}else d(i,U,c)||R.push(M)}return R}var Pi=fh(Wr),Uu=fh(ja,!0);function dg(e,i){var o=!0;return Pi(e,function(c,l,d){return o=!!i(c,l,d),o}),o}function no(e,i,o){for(var c=-1,l=e.length;++c<l;){var d=e[c],w=i(d);if(w!=null&&(_===r?w===w&&!wr(w):o(w,_)))var _=w,R=d}return R}function gg(e,i,o,c){var l=e.length;for(o=ye(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:ye(c),c<0&&(c+=l),c=o>c?0:il(c);o<c;)e[o++]=i;return e}function zu(e,i){var o=[];return Pi(e,function(c,l,d){i(c,l,d)&&o.push(c)}),o}function Bt(e,i,o,c,l){var d=-1,w=e.length;for(o||(o=iy),l||(l=[]);++d<w;){var _=e[d];i>0&&o(_)?i>1?Bt(_,i-1,o,c,l):Ei(l,_):c||(l[l.length]=_)}return l}var La=ph(),ku=ph(!0);function Wr(e,i){return e&&La(e,i,jt)}function ja(e,i){return e&&ku(e,i,jt)}function so(e,i){return _i(i,function(o){return ui(e[o])})}function Bi(e,i){i=Oi(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[Qr(i[o++])];return o&&o==c?e:r}function Hu(e,i,o){var c=i(e);return ge(e)?c:Ei(c,o(e))}function Xt(e){return e==null?e===r?rt:Ae:zi&&zi in ke(e)?Yg(e):hy(e)}function Ma(e,i){return e>i}function yg(e,i){return e!=null&&De.call(e,i)}function vg(e,i){return e!=null&&i in ke(e)}function mg(e,i,o){return e>=Gt(i,o)&&e<Dt(i,o)}function qa(e,i,o){for(var c=o?_a:Us,l=e[0].length,d=e.length,w=d,_=C(d),R=1/0,j=[];w--;){var M=e[w];w&&i&&(M=Ze(M,vr(i))),R=Gt(M.length,R),_[w]=!o&&(i||l>=120&&M.length>=120)?new Hi(w&&M):r}M=e[0];var U=-1,V=_[0];e:for(;++U<l&&j.length<R;){var X=M[U],ne=i?i(X):X;if(X=o||X!==0?X:0,!(V?qn(V,ne):c(j,ne,o))){for(w=d;--w;){var we=_[w];if(!(we?qn(we,ne):c(e[w],ne,o)))continue e}V&&V.push(ne),j.push(X)}}return j}function wg(e,i,o,c){return Wr(e,function(l,d,w){i(c,o(l),d,w)}),c}function Gn(e,i,o){i=Oi(i,e),e=Th(e,i);var c=e==null?e:e[Qr(Cr(i))];return c==null?r:Lt(c,e,o)}function Ku(e){return dt(e)&&Xt(e)==Ee}function bg(e){return dt(e)&&Xt(e)==Re}function _g(e){return dt(e)&&Xt(e)==A}function Wn(e,i,o,c,l){return e===i?!0:e==null||i==null||!dt(e)&&!dt(i)?e!==e&&i!==i:Eg(e,i,o,c,Wn,l)}function Eg(e,i,o,c,l,d){var w=ge(e),_=ge(i),R=w?Dr:Wt(e),j=_?Dr:Wt(i);R=R==Ee?Ie:R,j=j==Ee?Ie:j;var M=R==Ie,U=j==Ie,V=R==j;if(V&&Ai(e)){if(!Ai(i))return!1;w=!0,M=!1}if(V&&!M)return d||(d=new Mr),w||_n(e)?Ih(e,i,o,c,l,d):Jg(e,i,R,o,c,l,d);if(!(o&T)){var X=M&&De.call(e,"__wrapped__"),ne=U&&De.call(i,"__wrapped__");if(X||ne){var we=X?e.value():e,se=ne?i.value():i;return d||(d=new Mr),l(we,se,o,c,d)}}return V?(d||(d=new Mr),Qg(e,i,o,c,l,d)):!1}function Ig(e){return dt(e)&&Wt(e)==me}function Ua(e,i,o,c){var l=o.length,d=l,w=!c;if(e==null)return!d;for(e=ke(e);l--;){var _=o[l];if(w&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<d;){_=o[l];var R=_[0],j=e[R],M=_[1];if(w&&_[2]){if(j===r&&!(R in e))return!1}else{var U=new Mr;if(c)var V=c(j,M,R,e,i,U);if(!(V===r?Wn(M,j,T|Y,c,U):V))return!1}}return!0}function Bu(e){if(!nt(e)||sy(e))return!1;var i=ui(e)?Id:sa;return i.test(Gi(e))}function xg(e){return dt(e)&&Xt(e)==tt}function Pg(e){return dt(e)&&Wt(e)==Ce}function Sg(e){return dt(e)&&Io(e.length)&&!!qe[Xt(e)]}function Vu(e){return typeof e=="function"?e:e==null?hr:typeof e=="object"?ge(e)?Ju(e[0],e[1]):Wu(e):dl(e)}function za(e){if(!Yn(e))return Ad(e);var i=[];for(var o in ke(e))De.call(e,o)&&o!="constructor"&&i.push(o);return i}function Og(e){if(!nt(e))return uy(e);var i=Yn(e),o=[];for(var c in e)c=="constructor"&&(i||!De.call(e,c))||o.push(c);return o}function ka(e,i){return e<i}function Gu(e,i){var o=-1,c=cr(e)?C(e.length):[];return Pi(e,function(l,d,w){c[++o]=i(l,d,w)}),c}function Wu(e){var i=ic(e);return i.length==1&&i[0][2]?Rh(i[0][0],i[0][1]):function(o){return o===e||Ua(o,e,i)}}function Ju(e,i){return sc(e)&&Oh(i)?Rh(Qr(e),i):function(o){var c=gc(o,e);return c===r&&c===i?yc(o,e):Wn(i,c,T|Y)}}function oo(e,i,o,c,l){e!==i&&La(i,function(d,w){if(l||(l=new Mr),nt(d))Rg(e,i,w,o,oo,c,l);else{var _=c?c(ac(e,w),d,w+"",e,i,l):r;_===r&&(_=d),Da(e,w,_)}},ur)}function Rg(e,i,o,c,l,d,w){var _=ac(e,o),R=ac(i,o),j=w.get(R);if(j){Da(e,o,j);return}var M=d?d(_,R,o+"",e,i,w):r,U=M===r;if(U){var V=ge(R),X=!V&&Ai(R),ne=!V&&!X&&_n(R);M=R,V||X||ne?ge(_)?M=_:mt(_)?M=ar(_):X?(U=!1,M=ah(R,!0)):ne?(U=!1,M=ch(R,!0)):M=[]:Xn(R)||Wi(R)?(M=_,Wi(_)?M=nl(_):(!nt(_)||ui(_))&&(M=Sh(R))):U=!1}U&&(w.set(R,M),l(M,R,c,d,w),w.delete(R)),Da(e,o,M)}function Qu(e,i){var o=e.length;if(o)return i+=i<0?o:0,ci(i,o)?e[i]:r}function Yu(e,i,o){i.length?i=Ze(i,function(d){return ge(d)?function(w){return Bi(w,d.length===1?d[0]:d)}:d}):i=[hr];var c=-1;i=Ze(i,vr(ie()));var l=Gu(e,function(d,w,_){var R=Ze(i,function(j){return j(d)});return{criteria:R,index:++c,value:d}});return td(l,function(d,w){return zg(d,w,o)})}function Ag(e,i){return Zu(e,i,function(o,c){return yc(e,c)})}function Zu(e,i,o){for(var c=-1,l=i.length,d={};++c<l;){var w=i[c],_=Bi(e,w);o(_,w)&&Jn(d,Oi(w,e),_)}return d}function Tg(e){return function(i){return Bi(i,e)}}function Ha(e,i,o,c){var l=c?ed:hn,d=-1,w=i.length,_=e;for(e===i&&(i=ar(i)),o&&(_=Ze(e,vr(o)));++d<w;)for(var R=0,j=i[d],M=o?o(j):j;(R=l(_,M,R,c))>-1;)_!==e&&Qs.call(_,R,1),Qs.call(e,R,1);return e}function Xu(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==d){var d=l;ci(l)?Qs.call(e,l,1):Ga(e,l)}}return e}function Ka(e,i){return e+Xs($u()*(i-e+1))}function Cg(e,i,o,c){for(var l=-1,d=Dt(Zs((i-e)/(o||1)),0),w=C(d);d--;)w[c?d:++l]=e,e+=o;return w}function Ba(e,i){var o="";if(!e||i<1||i>k)return o;do i%2&&(o+=e),i=Xs(i/2),i&&(e+=e);while(i);return o}function be(e,i){return cc(Ah(e,i,hr),e+"")}function Ng(e){return Lu(En(e))}function $g(e,i){var o=En(e);return vo(o,Ki(i,0,o.length))}function Jn(e,i,o,c){if(!nt(e))return e;i=Oi(i,e);for(var l=-1,d=i.length,w=d-1,_=e;_!=null&&++l<d;){var R=Qr(i[l]),j=o;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var M=_[R];j=c?c(M,R,_):r,j===r&&(j=nt(M)?M:ci(i[l+1])?[]:{})}Bn(_,R,j),_=_[R]}return e}var eh=eo?function(e,i){return eo.set(e,i),e}:hr,Dg=Ys?function(e,i){return Ys(e,"toString",{configurable:!0,enumerable:!1,value:mc(i),writable:!0})}:hr;function Fg(e){return vo(En(e))}function Tr(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var d=C(l);++c<l;)d[c]=e[c+i];return d}function Lg(e,i){var o;return Pi(e,function(c,l,d){return o=i(c,l,d),!o}),!!o}function ao(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=ot){for(;c<l;){var d=c+l>>>1,w=e[d];w!==null&&!wr(w)&&(o?w<=i:w<i)?c=d+1:l=d}return l}return Va(e,i,hr,o)}function Va(e,i,o,c){var l=0,d=e==null?0:e.length;if(d===0)return 0;i=o(i);for(var w=i!==i,_=i===null,R=wr(i),j=i===r;l<d;){var M=Xs((l+d)/2),U=o(e[M]),V=U!==r,X=U===null,ne=U===U,we=wr(U);if(w)var se=c||ne;else j?se=ne&&(c||V):_?se=ne&&V&&(c||!X):R?se=ne&&V&&!X&&(c||!we):X||we?se=!1:se=c?U<=i:U<i;se?l=M+1:d=M}return Gt(d,et)}function th(e,i){for(var o=-1,c=e.length,l=0,d=[];++o<c;){var w=e[o],_=i?i(w):w;if(!o||!qr(_,R)){var R=_;d[l++]=w===0?0:w}}return d}function rh(e){return typeof e=="number"?e:wr(e)?H:+e}function mr(e){if(typeof e=="string")return e;if(ge(e))return Ze(e,mr)+"";if(wr(e))return Du?Du.call(e):"";var i=e+"";return i=="0"&&1/e==-le?"-0":i}function Si(e,i,o){var c=-1,l=Us,d=e.length,w=!0,_=[],R=_;if(o)w=!1,l=_a;else if(d>=a){var j=i?null:Gg(e);if(j)return ks(j);w=!1,l=qn,R=new Hi}else R=i?[]:_;e:for(;++c<d;){var M=e[c],U=i?i(M):M;if(M=o||M!==0?M:0,w&&U===U){for(var V=R.length;V--;)if(R[V]===U)continue e;i&&R.push(U),_.push(M)}else l(R,U,o)||(R!==_&&R.push(U),_.push(M))}return _}function Ga(e,i){return i=Oi(i,e),e=Th(e,i),e==null||delete e[Qr(Cr(i))]}function ih(e,i,o,c){return Jn(e,i,o(Bi(e,i)),c)}function co(e,i,o,c){for(var l=e.length,d=c?l:-1;(c?d--:++d<l)&&i(e[d],d,e););return o?Tr(e,c?0:d,c?d+1:l):Tr(e,c?d+1:0,c?l:d)}function nh(e,i){var o=e;return o instanceof xe&&(o=o.value()),Ea(i,function(c,l){return l.func.apply(l.thisArg,Ei([c],l.args))},o)}function Wa(e,i,o){var c=e.length;if(c<2)return c?Si(e[0]):[];for(var l=-1,d=C(c);++l<c;)for(var w=e[l],_=-1;++_<c;)_!=l&&(d[l]=Vn(d[l]||w,e[_],i,o));return Si(Bt(d,1),i,o)}function sh(e,i,o){for(var c=-1,l=e.length,d=i.length,w={};++c<l;){var _=c<d?i[c]:r;o(w,e[c],_)}return w}function Ja(e){return mt(e)?e:[]}function Qa(e){return typeof e=="function"?e:hr}function Oi(e,i){return ge(e)?e:sc(e,i)?[e]:Dh(Ne(e))}var jg=be;function Ri(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Tr(e,i,o)}var oh=xd||function(e){return Pe.clearTimeout(e)};function ah(e,i){if(i)return e.slice();var o=e.length,c=Ru?Ru(o):new e.constructor(o);return e.copy(c),c}function Ya(e){var i=new e.constructor(e.byteLength);return new Ws(i).set(new Ws(e)),i}function Mg(e,i){var o=i?Ya(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function qg(e){var i=new e.constructor(e.source,xr.exec(e));return i.lastIndex=e.lastIndex,i}function Ug(e){return Kn?ke(Kn.call(e)):{}}function ch(e,i){var o=i?Ya(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function uh(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,d=wr(e),w=i!==r,_=i===null,R=i===i,j=wr(i);if(!_&&!j&&!d&&e>i||d&&w&&R&&!_&&!j||c&&w&&R||!o&&R||!l)return 1;if(!c&&!d&&!j&&e<i||j&&o&&l&&!c&&!d||_&&o&&l||!w&&l||!R)return-1}return 0}function zg(e,i,o){for(var c=-1,l=e.criteria,d=i.criteria,w=l.length,_=o.length;++c<w;){var R=uh(l[c],d[c]);if(R){if(c>=_)return R;var j=o[c];return R*(j=="desc"?-1:1)}}return e.index-i.index}function hh(e,i,o,c){for(var l=-1,d=e.length,w=o.length,_=-1,R=i.length,j=Dt(d-w,0),M=C(R+j),U=!c;++_<R;)M[_]=i[_];for(;++l<w;)(U||l<d)&&(M[o[l]]=e[l]);for(;j--;)M[_++]=e[l++];return M}function lh(e,i,o,c){for(var l=-1,d=e.length,w=-1,_=o.length,R=-1,j=i.length,M=Dt(d-_,0),U=C(M+j),V=!c;++l<M;)U[l]=e[l];for(var X=l;++R<j;)U[X+R]=i[R];for(;++w<_;)(V||l<d)&&(U[X+o[w]]=e[l++]);return U}function ar(e,i){var o=-1,c=e.length;for(i||(i=C(c));++o<c;)i[o]=e[o];return i}function Jr(e,i,o,c){var l=!o;o||(o={});for(var d=-1,w=i.length;++d<w;){var _=i[d],R=c?c(o[_],e[_],_,o,e):r;R===r&&(R=e[_]),l?si(o,_,R):Bn(o,_,R)}return o}function kg(e,i){return Jr(e,nc(e),i)}function Hg(e,i){return Jr(e,xh(e),i)}function uo(e,i){return function(o,c){var l=ge(o)?Wp:lg,d=i?i():{};return l(o,e,ie(c,2),d)}}function mn(e){return be(function(i,o){var c=-1,l=o.length,d=l>1?o[l-1]:r,w=l>2?o[2]:r;for(d=e.length>3&&typeof d=="function"?(l--,d):r,w&&er(o[0],o[1],w)&&(d=l<3?r:d,l=1),i=ke(i);++c<l;){var _=o[c];_&&e(i,_,c,d)}return i})}function fh(e,i){return function(o,c){if(o==null)return o;if(!cr(o))return e(o,c);for(var l=o.length,d=i?l:-1,w=ke(o);(i?d--:++d<l)&&c(w[d],d,w)!==!1;);return o}}function ph(e){return function(i,o,c){for(var l=-1,d=ke(i),w=c(i),_=w.length;_--;){var R=w[e?_:++l];if(o(d[R],R,d)===!1)break}return i}}function Kg(e,i,o){var c=i&re,l=Qn(e);function d(){var w=this&&this!==Pe&&this instanceof d?l:e;return w.apply(c?o:this,arguments)}return d}function dh(e){return function(i){i=Ne(i);var o=ln(i)?jr(i):r,c=o?o[0]:i.charAt(0),l=o?Ri(o,1).join(""):i.slice(1);return c[e]()+l}}function wn(e){return function(i){return Ea(fl(ll(i).replace(jn,"")),e,"")}}function Qn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=vn(e.prototype),c=e.apply(o,i);return nt(c)?c:o}}function Bg(e,i,o){var c=Qn(e);function l(){for(var d=arguments.length,w=C(d),_=d,R=bn(l);_--;)w[_]=arguments[_];var j=d<3&&w[0]!==R&&w[d-1]!==R?[]:Ii(w,R);if(d-=j.length,d<o)return wh(e,i,ho,l.placeholder,r,w,j,r,r,o-d);var M=this&&this!==Pe&&this instanceof l?c:e;return Lt(M,this,w)}return l}function gh(e){return function(i,o,c){var l=ke(i);if(!cr(i)){var d=ie(o,3);i=jt(i),o=function(_){return d(l[_],_,l)}}var w=e(i,o,c);return w>-1?l[d?i[w]:w]:r}}function yh(e){return ai(function(i){var o=i.length,c=o,l=Rr.prototype.thru;for(e&&i.reverse();c--;){var d=i[c];if(typeof d!="function")throw new Or(f);if(l&&!w&&go(d)=="wrapper")var w=new Rr([],!0)}for(c=w?c:o;++c<o;){d=i[c];var _=go(d),R=_=="wrapper"?rc(d):r;R&&oc(R[0])&&R[1]==(Q|ae|he|ve)&&!R[4].length&&R[9]==1?w=w[go(R[0])].apply(w,R[3]):w=d.length==1&&oc(d)?w[_]():w.thru(d)}return function(){var j=arguments,M=j[0];if(w&&j.length==1&&ge(M))return w.plant(M).value();for(var U=0,V=o?i[U].apply(this,j):M;++U<o;)V=i[U].call(this,V);return V}})}function ho(e,i,o,c,l,d,w,_,R,j){var M=i&Q,U=i&re,V=i&oe,X=i&(ae|te),ne=i&_t,we=V?r:Qn(e);function se(){for(var _e=arguments.length,Se=C(_e),br=_e;br--;)Se[br]=arguments[br];if(X)var tr=bn(se),_r=id(Se,tr);if(c&&(Se=hh(Se,c,l,X)),d&&(Se=lh(Se,d,w,X)),_e-=_r,X&&_e<j){var wt=Ii(Se,tr);return wh(e,i,ho,se.placeholder,o,Se,wt,_,R,j-_e)}var Ur=U?o:this,li=V?Ur[e]:e;return _e=Se.length,_?Se=ly(Se,_):ne&&_e>1&&Se.reverse(),M&&R<_e&&(Se.length=R),this&&this!==Pe&&this instanceof se&&(li=we||Qn(li)),li.apply(Ur,Se)}return se}function vh(e,i){return function(o,c){return wg(o,e,i(c),{})}}function lo(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=mr(o),c=mr(c)):(o=rh(o),c=rh(c)),l=e(o,c)}return l}}function Za(e){return ai(function(i){return i=Ze(i,vr(ie())),be(function(o){var c=this;return e(i,function(l){return Lt(l,c,o)})})})}function fo(e,i){i=i===r?" ":mr(i);var o=i.length;if(o<2)return o?Ba(i,e):i;var c=Ba(i,Zs(e/fn(i)));return ln(i)?Ri(jr(c),0,e).join(""):c.slice(0,e)}function Vg(e,i,o,c){var l=i&re,d=Qn(e);function w(){for(var _=-1,R=arguments.length,j=-1,M=c.length,U=C(M+R),V=this&&this!==Pe&&this instanceof w?d:e;++j<M;)U[j]=c[j];for(;R--;)U[j++]=arguments[++_];return Lt(V,l?o:this,U)}return w}function mh(e){return function(i,o,c){return c&&typeof c!="number"&&er(i,o,c)&&(o=c=r),i=hi(i),o===r?(o=i,i=0):o=hi(o),c=c===r?i<o?1:-1:hi(c),Cg(i,o,c,e)}}function po(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Nr(i),o=Nr(o)),e(i,o)}}function wh(e,i,o,c,l,d,w,_,R,j){var M=i&ae,U=M?w:r,V=M?r:w,X=M?d:r,ne=M?r:d;i|=M?he:pe,i&=~(M?pe:he),i&ce||(i&=~(re|oe));var we=[e,i,l,X,U,ne,V,_,R,j],se=o.apply(r,we);return oc(e)&&Ch(se,we),se.placeholder=c,Nh(se,e,i)}function Xa(e){var i=$t[e];return function(o,c){if(o=Nr(o),c=c==null?0:Gt(ye(c),292),c&&Nu(o)){var l=(Ne(o)+"e").split("e"),d=i(l[0]+"e"+(+l[1]+c));return l=(Ne(d)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var Gg=gn&&1/ks(new gn([,-0]))[1]==le?function(e){return new gn(e)}:_c;function bh(e){return function(i){var o=Wt(i);return o==me?Aa(i):o==Ce?hd(i):rd(i,e(i))}}function oi(e,i,o,c,l,d,w,_){var R=i&oe;if(!R&&typeof e!="function")throw new Or(f);var j=c?c.length:0;if(j||(i&=~(he|pe),c=l=r),w=w===r?w:Dt(ye(w),0),_=_===r?_:ye(_),j-=l?l.length:0,i&pe){var M=c,U=l;c=l=r}var V=R?r:rc(e),X=[e,i,o,c,l,M,U,d,w,_];if(V&&cy(X,V),e=X[0],i=X[1],o=X[2],c=X[3],l=X[4],_=X[9]=X[9]===r?R?0:e.length:Dt(X[9]-j,0),!_&&i&(ae|te)&&(i&=~(ae|te)),!i||i==re)var ne=Kg(e,i,o);else i==ae||i==te?ne=Bg(e,i,_):(i==he||i==(re|he))&&!l.length?ne=Vg(e,i,o,c):ne=ho.apply(r,X);var we=V?eh:Ch;return Nh(we(ne,X),e,i)}function _h(e,i,o,c){return e===r||qr(e,dn[o])&&!De.call(c,o)?i:e}function Eh(e,i,o,c,l,d){return nt(e)&&nt(i)&&(d.set(i,e),oo(e,i,r,Eh,d),d.delete(i)),e}function Wg(e){return Xn(e)?r:e}function Ih(e,i,o,c,l,d){var w=o&T,_=e.length,R=i.length;if(_!=R&&!(w&&R>_))return!1;var j=d.get(e),M=d.get(i);if(j&&M)return j==i&&M==e;var U=-1,V=!0,X=o&Y?new Hi:r;for(d.set(e,i),d.set(i,e);++U<_;){var ne=e[U],we=i[U];if(c)var se=w?c(we,ne,U,i,e,d):c(ne,we,U,e,i,d);if(se!==r){if(se)continue;V=!1;break}if(X){if(!Ia(i,function(_e,Se){if(!qn(X,Se)&&(ne===_e||l(ne,_e,o,c,d)))return X.push(Se)})){V=!1;break}}else if(!(ne===we||l(ne,we,o,c,d))){V=!1;break}}return d.delete(e),d.delete(i),V}function Jg(e,i,o,c,l,d,w){switch(o){case Me:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Re:return!(e.byteLength!=i.byteLength||!d(new Ws(e),new Ws(i)));case N:case A:case Oe:return qr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case tt:case Be:return e==i+"";case me:var _=Aa;case Ce:var R=c&T;if(_||(_=ks),e.size!=i.size&&!R)return!1;var j=w.get(e);if(j)return j==i;c|=Y,w.set(e,i);var M=Ih(_(e),_(i),c,l,d,w);return w.delete(e),M;case Ve:if(Kn)return Kn.call(e)==Kn.call(i)}return!1}function Qg(e,i,o,c,l,d){var w=o&T,_=ec(e),R=_.length,j=ec(i),M=j.length;if(R!=M&&!w)return!1;for(var U=R;U--;){var V=_[U];if(!(w?V in i:De.call(i,V)))return!1}var X=d.get(e),ne=d.get(i);if(X&&ne)return X==i&&ne==e;var we=!0;d.set(e,i),d.set(i,e);for(var se=w;++U<R;){V=_[U];var _e=e[V],Se=i[V];if(c)var br=w?c(Se,_e,V,i,e,d):c(_e,Se,V,e,i,d);if(!(br===r?_e===Se||l(_e,Se,o,c,d):br)){we=!1;break}se||(se=V=="constructor")}if(we&&!se){var tr=e.constructor,_r=i.constructor;tr!=_r&&"constructor"in e&&"constructor"in i&&!(typeof tr=="function"&&tr instanceof tr&&typeof _r=="function"&&_r instanceof _r)&&(we=!1)}return d.delete(e),d.delete(i),we}function ai(e){return cc(Ah(e,r,Mh),e+"")}function ec(e){return Hu(e,jt,nc)}function tc(e){return Hu(e,ur,xh)}var rc=eo?function(e){return eo.get(e)}:_c;function go(e){for(var i=e.name+"",o=yn[i],c=De.call(yn,i)?o.length:0;c--;){var l=o[c],d=l.func;if(d==null||d==e)return l.name}return i}function bn(e){var i=De.call(p,"placeholder")?p:e;return i.placeholder}function ie(){var e=p.iteratee||wc;return e=e===wc?Vu:e,arguments.length?e(arguments[0],arguments[1]):e}function yo(e,i){var o=e.__data__;return ny(i)?o[typeof i=="string"?"string":"hash"]:o.map}function ic(e){for(var i=jt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,Oh(l)]}return i}function Vi(e,i){var o=ad(e,i);return Bu(o)?o:r}function Yg(e){var i=De.call(e,zi),o=e[zi];try{e[zi]=r;var c=!0}catch{}var l=Vs.call(e);return c&&(i?e[zi]=o:delete e[zi]),l}var nc=Ca?function(e){return e==null?[]:(e=ke(e),_i(Ca(e),function(i){return Tu.call(e,i)}))}:Ec,xh=Ca?function(e){for(var i=[];e;)Ei(i,nc(e)),e=Js(e);return i}:Ec,Wt=Xt;(Na&&Wt(new Na(new ArrayBuffer(1)))!=Me||zn&&Wt(new zn)!=me||$a&&Wt($a.resolve())!=Et||gn&&Wt(new gn)!=Ce||kn&&Wt(new kn)!=Fe)&&(Wt=function(e){var i=Xt(e),o=i==Ie?e.constructor:r,c=o?Gi(o):"";if(c)switch(c){case $d:return Me;case Dd:return me;case Fd:return Et;case Ld:return Ce;case jd:return Fe}return i});function Zg(e,i,o){for(var c=-1,l=o.length;++c<l;){var d=o[c],w=d.size;switch(d.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Gt(i,e+w);break;case"takeRight":e=Dt(e,i-w);break}}return{start:e,end:i}}function Xg(e){var i=e.match(He);return i?i[1].split(Ot):[]}function Ph(e,i,o){i=Oi(i,e);for(var c=-1,l=i.length,d=!1;++c<l;){var w=Qr(i[c]);if(!(d=e!=null&&o(e,w)))break;e=e[w]}return d||++c!=l?d:(l=e==null?0:e.length,!!l&&Io(l)&&ci(w,l)&&(ge(e)||Wi(e)))}function ey(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&De.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Sh(e){return typeof e.constructor=="function"&&!Yn(e)?vn(Js(e)):{}}function ty(e,i,o){var c=e.constructor;switch(i){case Re:return Ya(e);case N:case A:return new c(+e);case Me:return Mg(e,o);case at:case $e:case It:case Nt:case Ht:case Kt:case Ft:case Qt:case sr:return ch(e,o);case me:return new c;case Oe:case Be:return new c(e);case tt:return qg(e);case Ce:return new c;case Ve:return Ug(e)}}function ry(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(pt,`{
/* [wrapped with `+i+`] */
`)}function iy(e){return ge(e)||Wi(e)||!!(Cu&&e&&e[Cu])}function ci(e,i){var o=typeof e;return i=i??k,!!i&&(o=="number"||o!="symbol"&&aa.test(e))&&e>-1&&e%1==0&&e<i}function er(e,i,o){if(!nt(o))return!1;var c=typeof i;return(c=="number"?cr(o)&&ci(i,o.length):c=="string"&&i in o)?qr(o[i],e):!1}function sc(e,i){if(ge(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||wr(e)?!0:xt.test(e)||!Ye.test(e)||i!=null&&e in ke(i)}function ny(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function oc(e){var i=go(e),o=p[i];if(typeof o!="function"||!(i in xe.prototype))return!1;if(e===o)return!0;var c=rc(o);return!!c&&e===c[0]}function sy(e){return!!Ou&&Ou in e}var oy=Ks?ui:Ic;function Yn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||dn;return e===o}function Oh(e){return e===e&&!nt(e)}function Rh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in ke(o))}}function ay(e){var i=_o(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function cy(e,i){var o=e[1],c=i[1],l=o|c,d=l<(re|oe|Q),w=c==Q&&o==ae||c==Q&&o==ve&&e[7].length<=i[8]||c==(Q|ve)&&i[7].length<=i[8]&&o==ae;if(!(d||w))return e;c&re&&(e[2]=i[2],l|=o&re?0:ce);var _=i[3];if(_){var R=e[3];e[3]=R?hh(R,_,i[4]):_,e[4]=R?Ii(e[3],E):i[4]}return _=i[5],_&&(R=e[5],e[5]=R?lh(R,_,i[6]):_,e[6]=R?Ii(e[5],E):i[6]),_=i[7],_&&(e[7]=_),c&Q&&(e[8]=e[8]==null?i[8]:Gt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function uy(e){var i=[];if(e!=null)for(var o in ke(e))i.push(o);return i}function hy(e){return Vs.call(e)}function Ah(e,i,o){return i=Dt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,d=Dt(c.length-i,0),w=C(d);++l<d;)w[l]=c[i+l];l=-1;for(var _=C(i+1);++l<i;)_[l]=c[l];return _[i]=o(w),Lt(e,this,_)}}function Th(e,i){return i.length<2?e:Bi(e,Tr(i,0,-1))}function ly(e,i){for(var o=e.length,c=Gt(i.length,o),l=ar(e);c--;){var d=i[c];e[c]=ci(d,o)?l[d]:r}return e}function ac(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Ch=$h(eh),Zn=Sd||function(e,i){return Pe.setTimeout(e,i)},cc=$h(Dg);function Nh(e,i,o){var c=i+"";return cc(e,ry(c,fy(Xg(c),o)))}function $h(e){var i=0,o=0;return function(){var c=Td(),l=kt-(c-o);if(o=c,l>0){if(++i>=zt)return arguments[0]}else i=0;return e.apply(r,arguments)}}function vo(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var d=Ka(o,l),w=e[d];e[d]=e[o],e[o]=w}return e.length=i,e}var Dh=ay(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Pt,function(o,c,l,d){i.push(l?d.replace(ta,"$1"):c||o)}),i});function Qr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-le?"-0":i}function Gi(e){if(e!=null){try{return Bs.call(e)}catch{}try{return e+""}catch{}}return""}function fy(e,i){return Sr(Di,function(o){var c="_."+o[0];i&o[1]&&!Us(e,c)&&e.push(c)}),e.sort()}function Fh(e){if(e instanceof xe)return e.clone();var i=new Rr(e.__wrapped__,e.__chain__);return i.__actions__=ar(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function py(e,i,o){(o?er(e,i,o):i===r)?i=1:i=Dt(ye(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,d=0,w=C(Zs(c/i));l<c;)w[d++]=Tr(e,l,l+=i);return w}function dy(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var d=e[i];d&&(l[c++]=d)}return l}function gy(){var e=arguments.length;if(!e)return[];for(var i=C(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Ei(ge(o)?ar(o):[o],Bt(i,1))}var yy=be(function(e,i){return mt(e)?Vn(e,Bt(i,1,mt,!0)):[]}),vy=be(function(e,i){var o=Cr(i);return mt(o)&&(o=r),mt(e)?Vn(e,Bt(i,1,mt,!0),ie(o,2)):[]}),my=be(function(e,i){var o=Cr(i);return mt(o)&&(o=r),mt(e)?Vn(e,Bt(i,1,mt,!0),r,o):[]});function wy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ye(i),Tr(e,i<0?0:i,c)):[]}function by(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ye(i),i=c-i,Tr(e,0,i<0?0:i)):[]}function _y(e,i){return e&&e.length?co(e,ie(i,3),!0,!0):[]}function Ey(e,i){return e&&e.length?co(e,ie(i,3),!0):[]}function Iy(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&er(e,i,o)&&(o=0,c=l),gg(e,i,o,c)):[]}function Lh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:ye(o);return l<0&&(l=Dt(c+l,0)),zs(e,ie(i,3),l)}function jh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=ye(o),l=o<0?Dt(c+l,0):Gt(l,c-1)),zs(e,ie(i,3),l,!0)}function Mh(e){var i=e==null?0:e.length;return i?Bt(e,1):[]}function xy(e){var i=e==null?0:e.length;return i?Bt(e,le):[]}function Py(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:ye(i),Bt(e,i)):[]}function Sy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function qh(e){return e&&e.length?e[0]:r}function Oy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:ye(o);return l<0&&(l=Dt(c+l,0)),hn(e,i,l)}function Ry(e){var i=e==null?0:e.length;return i?Tr(e,0,-1):[]}var Ay=be(function(e){var i=Ze(e,Ja);return i.length&&i[0]===e[0]?qa(i):[]}),Ty=be(function(e){var i=Cr(e),o=Ze(e,Ja);return i===Cr(o)?i=r:o.pop(),o.length&&o[0]===e[0]?qa(o,ie(i,2)):[]}),Cy=be(function(e){var i=Cr(e),o=Ze(e,Ja);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?qa(o,r,i):[]});function Ny(e,i){return e==null?"":Rd.call(e,i)}function Cr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function $y(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=ye(o),l=l<0?Dt(c+l,0):Gt(l,c-1)),i===i?fd(e,i,l):zs(e,wu,l,!0)}function Dy(e,i){return e&&e.length?Qu(e,ye(i)):r}var Fy=be(Uh);function Uh(e,i){return e&&e.length&&i&&i.length?Ha(e,i):e}function Ly(e,i,o){return e&&e.length&&i&&i.length?Ha(e,i,ie(o,2)):e}function jy(e,i,o){return e&&e.length&&i&&i.length?Ha(e,i,r,o):e}var My=ai(function(e,i){var o=e==null?0:e.length,c=Fa(e,i);return Xu(e,Ze(i,function(l){return ci(l,o)?+l:l}).sort(uh)),c});function qy(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],d=e.length;for(i=ie(i,3);++c<d;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return Xu(e,l),o}function uc(e){return e==null?e:Nd.call(e)}function Uy(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&er(e,i,o)?(i=0,o=c):(i=i==null?0:ye(i),o=o===r?c:ye(o)),Tr(e,i,o)):[]}function zy(e,i){return ao(e,i)}function ky(e,i,o){return Va(e,i,ie(o,2))}function Hy(e,i){var o=e==null?0:e.length;if(o){var c=ao(e,i);if(c<o&&qr(e[c],i))return c}return-1}function Ky(e,i){return ao(e,i,!0)}function By(e,i,o){return Va(e,i,ie(o,2),!0)}function Vy(e,i){var o=e==null?0:e.length;if(o){var c=ao(e,i,!0)-1;if(qr(e[c],i))return c}return-1}function Gy(e){return e&&e.length?th(e):[]}function Wy(e,i){return e&&e.length?th(e,ie(i,2)):[]}function Jy(e){var i=e==null?0:e.length;return i?Tr(e,1,i):[]}function Qy(e,i,o){return e&&e.length?(i=o||i===r?1:ye(i),Tr(e,0,i<0?0:i)):[]}function Yy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ye(i),i=c-i,Tr(e,i<0?0:i,c)):[]}function Zy(e,i){return e&&e.length?co(e,ie(i,3),!1,!0):[]}function Xy(e,i){return e&&e.length?co(e,ie(i,3)):[]}var ev=be(function(e){return Si(Bt(e,1,mt,!0))}),tv=be(function(e){var i=Cr(e);return mt(i)&&(i=r),Si(Bt(e,1,mt,!0),ie(i,2))}),rv=be(function(e){var i=Cr(e);return i=typeof i=="function"?i:r,Si(Bt(e,1,mt,!0),r,i)});function iv(e){return e&&e.length?Si(e):[]}function nv(e,i){return e&&e.length?Si(e,ie(i,2)):[]}function sv(e,i){return i=typeof i=="function"?i:r,e&&e.length?Si(e,r,i):[]}function hc(e){if(!(e&&e.length))return[];var i=0;return e=_i(e,function(o){if(mt(o))return i=Dt(o.length,i),!0}),Oa(i,function(o){return Ze(e,xa(o))})}function zh(e,i){if(!(e&&e.length))return[];var o=hc(e);return i==null?o:Ze(o,function(c){return Lt(i,r,c)})}var ov=be(function(e,i){return mt(e)?Vn(e,i):[]}),av=be(function(e){return Wa(_i(e,mt))}),cv=be(function(e){var i=Cr(e);return mt(i)&&(i=r),Wa(_i(e,mt),ie(i,2))}),uv=be(function(e){var i=Cr(e);return i=typeof i=="function"?i:r,Wa(_i(e,mt),r,i)}),hv=be(hc);function lv(e,i){return sh(e||[],i||[],Bn)}function fv(e,i){return sh(e||[],i||[],Jn)}var pv=be(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,zh(e,o)});function kh(e){var i=p(e);return i.__chain__=!0,i}function dv(e,i){return i(e),e}function mo(e,i){return i(e)}var gv=ai(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(d){return Fa(d,e)};return i>1||this.__actions__.length||!(c instanceof xe)||!ci(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:mo,args:[l],thisArg:r}),new Rr(c,this.__chain__).thru(function(d){return i&&!d.length&&d.push(r),d}))});function yv(){return kh(this)}function vv(){return new Rr(this.value(),this.__chain__)}function mv(){this.__values__===r&&(this.__values__=rl(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function wv(){return this}function bv(e){for(var i,o=this;o instanceof ro;){var c=Fh(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function _v(){var e=this.__wrapped__;if(e instanceof xe){var i=e;return this.__actions__.length&&(i=new xe(this)),i=i.reverse(),i.__actions__.push({func:mo,args:[uc],thisArg:r}),new Rr(i,this.__chain__)}return this.thru(uc)}function Ev(){return nh(this.__wrapped__,this.__actions__)}var Iv=uo(function(e,i,o){De.call(e,o)?++e[o]:si(e,o,1)});function xv(e,i,o){var c=ge(e)?vu:dg;return o&&er(e,i,o)&&(i=r),c(e,ie(i,3))}function Pv(e,i){var o=ge(e)?_i:zu;return o(e,ie(i,3))}var Sv=gh(Lh),Ov=gh(jh);function Rv(e,i){return Bt(wo(e,i),1)}function Av(e,i){return Bt(wo(e,i),le)}function Tv(e,i,o){return o=o===r?1:ye(o),Bt(wo(e,i),o)}function Hh(e,i){var o=ge(e)?Sr:Pi;return o(e,ie(i,3))}function Kh(e,i){var o=ge(e)?Jp:Uu;return o(e,ie(i,3))}var Cv=uo(function(e,i,o){De.call(e,o)?e[o].push(i):si(e,o,[i])});function Nv(e,i,o,c){e=cr(e)?e:En(e),o=o&&!c?ye(o):0;var l=e.length;return o<0&&(o=Dt(l+o,0)),xo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&hn(e,i,o)>-1}var $v=be(function(e,i,o){var c=-1,l=typeof i=="function",d=cr(e)?C(e.length):[];return Pi(e,function(w){d[++c]=l?Lt(i,w,o):Gn(w,i,o)}),d}),Dv=uo(function(e,i,o){si(e,o,i)});function wo(e,i){var o=ge(e)?Ze:Gu;return o(e,ie(i,3))}function Fv(e,i,o,c){return e==null?[]:(ge(i)||(i=i==null?[]:[i]),o=c?r:o,ge(o)||(o=o==null?[]:[o]),Yu(e,i,o))}var Lv=uo(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function jv(e,i,o){var c=ge(e)?Ea:_u,l=arguments.length<3;return c(e,ie(i,4),o,l,Pi)}function Mv(e,i,o){var c=ge(e)?Qp:_u,l=arguments.length<3;return c(e,ie(i,4),o,l,Uu)}function qv(e,i){var o=ge(e)?_i:zu;return o(e,Eo(ie(i,3)))}function Uv(e){var i=ge(e)?Lu:Ng;return i(e)}function zv(e,i,o){(o?er(e,i,o):i===r)?i=1:i=ye(i);var c=ge(e)?ug:$g;return c(e,i)}function kv(e){var i=ge(e)?hg:Fg;return i(e)}function Hv(e){if(e==null)return 0;if(cr(e))return xo(e)?fn(e):e.length;var i=Wt(e);return i==me||i==Ce?e.size:za(e).length}function Kv(e,i,o){var c=ge(e)?Ia:Lg;return o&&er(e,i,o)&&(i=r),c(e,ie(i,3))}var Bv=be(function(e,i){if(e==null)return[];var o=i.length;return o>1&&er(e,i[0],i[1])?i=[]:o>2&&er(i[0],i[1],i[2])&&(i=[i[0]]),Yu(e,Bt(i,1),[])}),bo=Pd||function(){return Pe.Date.now()};function Vv(e,i){if(typeof i!="function")throw new Or(f);return e=ye(e),function(){if(--e<1)return i.apply(this,arguments)}}function Bh(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,oi(e,Q,r,r,r,r,i)}function Vh(e,i){var o;if(typeof i!="function")throw new Or(f);return e=ye(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var lc=be(function(e,i,o){var c=re;if(o.length){var l=Ii(o,bn(lc));c|=he}return oi(e,c,i,o,l)}),Gh=be(function(e,i,o){var c=re|oe;if(o.length){var l=Ii(o,bn(Gh));c|=he}return oi(i,c,e,o,l)});function Wh(e,i,o){i=o?r:i;var c=oi(e,ae,r,r,r,r,r,i);return c.placeholder=Wh.placeholder,c}function Jh(e,i,o){i=o?r:i;var c=oi(e,te,r,r,r,r,r,i);return c.placeholder=Jh.placeholder,c}function Qh(e,i,o){var c,l,d,w,_,R,j=0,M=!1,U=!1,V=!0;if(typeof e!="function")throw new Or(f);i=Nr(i)||0,nt(o)&&(M=!!o.leading,U="maxWait"in o,d=U?Dt(Nr(o.maxWait)||0,i):d,V="trailing"in o?!!o.trailing:V);function X(wt){var Ur=c,li=l;return c=l=r,j=wt,w=e.apply(li,Ur),w}function ne(wt){return j=wt,_=Zn(_e,i),M?X(wt):w}function we(wt){var Ur=wt-R,li=wt-j,gl=i-Ur;return U?Gt(gl,d-li):gl}function se(wt){var Ur=wt-R,li=wt-j;return R===r||Ur>=i||Ur<0||U&&li>=d}function _e(){var wt=bo();if(se(wt))return Se(wt);_=Zn(_e,we(wt))}function Se(wt){return _=r,V&&c?X(wt):(c=l=r,w)}function br(){_!==r&&oh(_),j=0,c=R=l=_=r}function tr(){return _===r?w:Se(bo())}function _r(){var wt=bo(),Ur=se(wt);if(c=arguments,l=this,R=wt,Ur){if(_===r)return ne(R);if(U)return oh(_),_=Zn(_e,i),X(R)}return _===r&&(_=Zn(_e,i)),w}return _r.cancel=br,_r.flush=tr,_r}var Gv=be(function(e,i){return qu(e,1,i)}),Wv=be(function(e,i,o){return qu(e,Nr(i)||0,o)});function Jv(e){return oi(e,_t)}function _o(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Or(f);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],d=o.cache;if(d.has(l))return d.get(l);var w=e.apply(this,c);return o.cache=d.set(l,w)||d,w};return o.cache=new(_o.Cache||ni),o}_o.Cache=ni;function Eo(e){if(typeof e!="function")throw new Or(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Qv(e){return Vh(2,e)}var Yv=jg(function(e,i){i=i.length==1&&ge(i[0])?Ze(i[0],vr(ie())):Ze(Bt(i,1),vr(ie()));var o=i.length;return be(function(c){for(var l=-1,d=Gt(c.length,o);++l<d;)c[l]=i[l].call(this,c[l]);return Lt(e,this,c)})}),fc=be(function(e,i){var o=Ii(i,bn(fc));return oi(e,he,r,i,o)}),Yh=be(function(e,i){var o=Ii(i,bn(Yh));return oi(e,pe,r,i,o)}),Zv=ai(function(e,i){return oi(e,ve,r,r,r,i)});function Xv(e,i){if(typeof e!="function")throw new Or(f);return i=i===r?i:ye(i),be(e,i)}function em(e,i){if(typeof e!="function")throw new Or(f);return i=i==null?0:Dt(ye(i),0),be(function(o){var c=o[i],l=Ri(o,0,i);return c&&Ei(l,c),Lt(e,this,l)})}function tm(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Or(f);return nt(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),Qh(e,i,{leading:c,maxWait:i,trailing:l})}function rm(e){return Bh(e,1)}function im(e,i){return fc(Qa(i),e)}function nm(){if(!arguments.length)return[];var e=arguments[0];return ge(e)?e:[e]}function sm(e){return Ar(e,L)}function om(e,i){return i=typeof i=="function"?i:r,Ar(e,L,i)}function am(e){return Ar(e,x|L)}function cm(e,i){return i=typeof i=="function"?i:r,Ar(e,x|L,i)}function um(e,i){return i==null||Mu(e,i,jt(i))}function qr(e,i){return e===i||e!==e&&i!==i}var hm=po(Ma),lm=po(function(e,i){return e>=i}),Wi=Ku(function(){return arguments}())?Ku:function(e){return dt(e)&&De.call(e,"callee")&&!Tu.call(e,"callee")},ge=C.isArray,fm=Zt?vr(Zt):bg;function cr(e){return e!=null&&Io(e.length)&&!ui(e)}function mt(e){return dt(e)&&cr(e)}function pm(e){return e===!0||e===!1||dt(e)&&Xt(e)==N}var Ai=Od||Ic,dm=Lr?vr(Lr):_g;function gm(e){return dt(e)&&e.nodeType===1&&!Xn(e)}function ym(e){if(e==null)return!0;if(cr(e)&&(ge(e)||typeof e=="string"||typeof e.splice=="function"||Ai(e)||_n(e)||Wi(e)))return!e.length;var i=Wt(e);if(i==me||i==Ce)return!e.size;if(Yn(e))return!za(e).length;for(var o in e)if(De.call(e,o))return!1;return!0}function vm(e,i){return Wn(e,i)}function mm(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?Wn(e,i,r,o):!!c}function pc(e){if(!dt(e))return!1;var i=Xt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Xn(e)}function wm(e){return typeof e=="number"&&Nu(e)}function ui(e){if(!nt(e))return!1;var i=Xt(e);return i==Z||i==ue||i==D||i==gt}function Zh(e){return typeof e=="number"&&e==ye(e)}function Io(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=k}function nt(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function dt(e){return e!=null&&typeof e=="object"}var Xh=Pr?vr(Pr):Ig;function bm(e,i){return e===i||Ua(e,i,ic(i))}function _m(e,i,o){return o=typeof o=="function"?o:r,Ua(e,i,ic(i),o)}function Em(e){return el(e)&&e!=+e}function Im(e){if(oy(e))throw new fe(u);return Bu(e)}function xm(e){return e===null}function Pm(e){return e==null}function el(e){return typeof e=="number"||dt(e)&&Xt(e)==Oe}function Xn(e){if(!dt(e)||Xt(e)!=Ie)return!1;var i=Js(e);if(i===null)return!0;var o=De.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Bs.call(o)==_d}var dc=Gr?vr(Gr):xg;function Sm(e){return Zh(e)&&e>=-k&&e<=k}var tl=Mn?vr(Mn):Pg;function xo(e){return typeof e=="string"||!ge(e)&&dt(e)&&Xt(e)==Be}function wr(e){return typeof e=="symbol"||dt(e)&&Xt(e)==Ve}var _n=Ui?vr(Ui):Sg;function Om(e){return e===r}function Rm(e){return dt(e)&&Wt(e)==Fe}function Am(e){return dt(e)&&Xt(e)==Ge}var Tm=po(ka),Cm=po(function(e,i){return e<=i});function rl(e){if(!e)return[];if(cr(e))return xo(e)?jr(e):ar(e);if(Un&&e[Un])return ud(e[Un]());var i=Wt(e),o=i==me?Aa:i==Ce?ks:En;return o(e)}function hi(e){if(!e)return e===0?e:0;if(e=Nr(e),e===le||e===-le){var i=e<0?-1:1;return i*z}return e===e?e:0}function ye(e){var i=hi(e),o=i%1;return i===i?o?i-o:i:0}function il(e){return e?Ki(ye(e),0,K):0}function Nr(e){if(typeof e=="number")return e;if(wr(e))return H;if(nt(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=nt(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Eu(e);var o=na.test(e);return o||oa.test(e)?de(e.slice(2),o?2:8):ia.test(e)?H:+e}function nl(e){return Jr(e,ur(e))}function Nm(e){return e?Ki(ye(e),-k,k):e===0?e:0}function Ne(e){return e==null?"":mr(e)}var $m=mn(function(e,i){if(Yn(i)||cr(i)){Jr(i,jt(i),e);return}for(var o in i)De.call(i,o)&&Bn(e,o,i[o])}),sl=mn(function(e,i){Jr(i,ur(i),e)}),Po=mn(function(e,i,o,c){Jr(i,ur(i),e,c)}),Dm=mn(function(e,i,o,c){Jr(i,jt(i),e,c)}),Fm=ai(Fa);function Lm(e,i){var o=vn(e);return i==null?o:ju(o,i)}var jm=be(function(e,i){e=ke(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&er(i[0],i[1],l)&&(c=1);++o<c;)for(var d=i[o],w=ur(d),_=-1,R=w.length;++_<R;){var j=w[_],M=e[j];(M===r||qr(M,dn[j])&&!De.call(e,j))&&(e[j]=d[j])}return e}),Mm=be(function(e){return e.push(r,Eh),Lt(ol,r,e)});function qm(e,i){return mu(e,ie(i,3),Wr)}function Um(e,i){return mu(e,ie(i,3),ja)}function zm(e,i){return e==null?e:La(e,ie(i,3),ur)}function km(e,i){return e==null?e:ku(e,ie(i,3),ur)}function Hm(e,i){return e&&Wr(e,ie(i,3))}function Km(e,i){return e&&ja(e,ie(i,3))}function Bm(e){return e==null?[]:so(e,jt(e))}function Vm(e){return e==null?[]:so(e,ur(e))}function gc(e,i,o){var c=e==null?r:Bi(e,i);return c===r?o:c}function Gm(e,i){return e!=null&&Ph(e,i,yg)}function yc(e,i){return e!=null&&Ph(e,i,vg)}var Wm=vh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Vs.call(i)),e[i]=o},mc(hr)),Jm=vh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=Vs.call(i)),De.call(e,i)?e[i].push(o):e[i]=[o]},ie),Qm=be(Gn);function jt(e){return cr(e)?Fu(e):za(e)}function ur(e){return cr(e)?Fu(e,!0):Og(e)}function Ym(e,i){var o={};return i=ie(i,3),Wr(e,function(c,l,d){si(o,i(c,l,d),c)}),o}function Zm(e,i){var o={};return i=ie(i,3),Wr(e,function(c,l,d){si(o,l,i(c,l,d))}),o}var Xm=mn(function(e,i,o){oo(e,i,o)}),ol=mn(function(e,i,o,c){oo(e,i,o,c)}),e0=ai(function(e,i){var o={};if(e==null)return o;var c=!1;i=Ze(i,function(d){return d=Oi(d,e),c||(c=d.length>1),d}),Jr(e,tc(e),o),c&&(o=Ar(o,x|$|L,Wg));for(var l=i.length;l--;)Ga(o,i[l]);return o});function t0(e,i){return al(e,Eo(ie(i)))}var r0=ai(function(e,i){return e==null?{}:Ag(e,i)});function al(e,i){if(e==null)return{};var o=Ze(tc(e),function(c){return[c]});return i=ie(i),Zu(e,o,function(c,l){return i(c,l[0])})}function i0(e,i,o){i=Oi(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var d=e==null?r:e[Qr(i[c])];d===r&&(c=l,d=o),e=ui(d)?d.call(e):d}return e}function n0(e,i,o){return e==null?e:Jn(e,i,o)}function s0(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:Jn(e,i,o,c)}var cl=bh(jt),ul=bh(ur);function o0(e,i,o){var c=ge(e),l=c||Ai(e)||_n(e);if(i=ie(i,4),o==null){var d=e&&e.constructor;l?o=c?new d:[]:nt(e)?o=ui(d)?vn(Js(e)):{}:o={}}return(l?Sr:Wr)(e,function(w,_,R){return i(o,w,_,R)}),o}function a0(e,i){return e==null?!0:Ga(e,i)}function c0(e,i,o){return e==null?e:ih(e,i,Qa(o))}function u0(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:ih(e,i,Qa(o),c)}function En(e){return e==null?[]:Ra(e,jt(e))}function h0(e){return e==null?[]:Ra(e,ur(e))}function l0(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Nr(o),o=o===o?o:0),i!==r&&(i=Nr(i),i=i===i?i:0),Ki(Nr(e),i,o)}function f0(e,i,o){return i=hi(i),o===r?(o=i,i=0):o=hi(o),e=Nr(e),mg(e,i,o)}function p0(e,i,o){if(o&&typeof o!="boolean"&&er(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=hi(e),i===r?(i=e,e=0):i=hi(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=$u();return Gt(e+l*(i-e+Ue("1e-"+((l+"").length-1))),i)}return Ka(e,i)}var d0=wn(function(e,i,o){return i=i.toLowerCase(),e+(o?hl(i):i)});function hl(e){return vc(Ne(e).toLowerCase())}function ll(e){return e=Ne(e),e&&e.replace(ti,nd).replace(wa,"")}function g0(e,i,o){e=Ne(e),i=mr(i);var c=e.length;o=o===r?c:Ki(ye(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function y0(e){return e=Ne(e),e&&Qe.test(e)?e.replace(Fi,sd):e}function v0(e){return e=Ne(e),e&&St.test(e)?e.replace(lt,"\\$&"):e}var m0=wn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),w0=wn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),b0=dh("toLowerCase");function _0(e,i,o){e=Ne(e),i=ye(i);var c=i?fn(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return fo(Xs(l),o)+e+fo(Zs(l),o)}function E0(e,i,o){e=Ne(e),i=ye(i);var c=i?fn(e):0;return i&&c<i?e+fo(i-c,o):e}function I0(e,i,o){e=Ne(e),i=ye(i);var c=i?fn(e):0;return i&&c<i?fo(i-c,o)+e:e}function x0(e,i,o){return o||i==null?i=0:i&&(i=+i),Cd(Ne(e).replace(ft,""),i||0)}function P0(e,i,o){return(o?er(e,i,o):i===r)?i=1:i=ye(i),Ba(Ne(e),i)}function S0(){var e=arguments,i=Ne(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var O0=wn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function R0(e,i,o){return o&&typeof o!="number"&&er(e,i,o)&&(i=o=r),o=o===r?K:o>>>0,o?(e=Ne(e),e&&(typeof i=="string"||i!=null&&!dc(i))&&(i=mr(i),!i&&ln(e))?Ri(jr(e),0,o):e.split(i,o)):[]}var A0=wn(function(e,i,o){return e+(o?" ":"")+vc(i)});function T0(e,i,o){return e=Ne(e),o=o==null?0:Ki(ye(o),0,e.length),i=mr(i),e.slice(o,o+i.length)==i}function C0(e,i,o){var c=p.templateSettings;o&&er(e,i,o)&&(i=r),e=Ne(e),i=Po({},i,c,_h);var l=Po({},i.imports,c.imports,_h),d=jt(l),w=Ra(l,d),_,R,j=0,M=i.interpolate||rn,U="__p += '",V=Ta((i.escape||rn).source+"|"+M.source+"|"+(M===it?ra:rn).source+"|"+(i.evaluate||rn).source+"|$","g"),X="//# sourceURL="+(De.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ba+"]")+`
`;e.replace(V,function(se,_e,Se,br,tr,_r){return Se||(Se=br),U+=e.slice(j,_r).replace(ca,od),_e&&(_=!0,U+=`' +
__e(`+_e+`) +
'`),tr&&(R=!0,U+=`';
`+tr+`;
__p += '`),Se&&(U+=`' +
((__t = (`+Se+`)) == null ? '' : __t) +
'`),j=_r+se.length,se}),U+=`';
`;var ne=De.call(i,"variable")&&i.variable;if(!ne)U=`with (obj) {
`+U+`
}
`;else if(ea.test(ne))throw new fe(g);U=(R?U.replace(Br,""):U).replace(Yt,"$1").replace(ei,"$1;"),U="function("+(ne||"obj")+`) {
`+(ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+U+`return __p
}`;var we=pl(function(){return Te(d,X+"return "+U).apply(r,w)});if(we.source=U,pc(we))throw we;return we}function N0(e){return Ne(e).toLowerCase()}function $0(e){return Ne(e).toUpperCase()}function D0(e,i,o){if(e=Ne(e),e&&(o||i===r))return Eu(e);if(!e||!(i=mr(i)))return e;var c=jr(e),l=jr(i),d=Iu(c,l),w=xu(c,l)+1;return Ri(c,d,w).join("")}function F0(e,i,o){if(e=Ne(e),e&&(o||i===r))return e.slice(0,Su(e)+1);if(!e||!(i=mr(i)))return e;var c=jr(e),l=xu(c,jr(i))+1;return Ri(c,0,l).join("")}function L0(e,i,o){if(e=Ne(e),e&&(o||i===r))return e.replace(ft,"");if(!e||!(i=mr(i)))return e;var c=jr(e),l=Iu(c,jr(i));return Ri(c,l).join("")}function j0(e,i){var o=st,c=Ke;if(nt(i)){var l="separator"in i?i.separator:l;o="length"in i?ye(i.length):o,c="omission"in i?mr(i.omission):c}e=Ne(e);var d=e.length;if(ln(e)){var w=jr(e);d=w.length}if(o>=d)return e;var _=o-fn(c);if(_<1)return c;var R=w?Ri(w,0,_).join(""):e.slice(0,_);if(l===r)return R+c;if(w&&(_+=R.length-_),dc(l)){if(e.slice(_).search(l)){var j,M=R;for(l.global||(l=Ta(l.source,Ne(xr.exec(l))+"g")),l.lastIndex=0;j=l.exec(M);)var U=j.index;R=R.slice(0,U===r?_:U)}}else if(e.indexOf(mr(l),_)!=_){var V=R.lastIndexOf(l);V>-1&&(R=R.slice(0,V))}return R+c}function M0(e){return e=Ne(e),e&&ct.test(e)?e.replace(wi,pd):e}var q0=wn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),vc=dh("toUpperCase");function fl(e,i,o){return e=Ne(e),i=o?r:i,i===r?cd(e)?yd(e):Xp(e):e.match(i)||[]}var pl=be(function(e,i){try{return Lt(e,r,i)}catch(o){return pc(o)?o:new fe(o)}}),U0=ai(function(e,i){return Sr(i,function(o){o=Qr(o),si(e,o,lc(e[o],e))}),e});function z0(e){var i=e==null?0:e.length,o=ie();return e=i?Ze(e,function(c){if(typeof c[1]!="function")throw new Or(f);return[o(c[0]),c[1]]}):[],be(function(c){for(var l=-1;++l<i;){var d=e[l];if(Lt(d[0],this,c))return Lt(d[1],this,c)}})}function k0(e){return pg(Ar(e,x))}function mc(e){return function(){return e}}function H0(e,i){return e==null||e!==e?i:e}var K0=yh(),B0=yh(!0);function hr(e){return e}function wc(e){return Vu(typeof e=="function"?e:Ar(e,x))}function V0(e){return Wu(Ar(e,x))}function G0(e,i){return Ju(e,Ar(i,x))}var W0=be(function(e,i){return function(o){return Gn(o,e,i)}}),J0=be(function(e,i){return function(o){return Gn(e,o,i)}});function bc(e,i,o){var c=jt(i),l=so(i,c);o==null&&!(nt(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=so(i,jt(i)));var d=!(nt(o)&&"chain"in o)||!!o.chain,w=ui(e);return Sr(l,function(_){var R=i[_];e[_]=R,w&&(e.prototype[_]=function(){var j=this.__chain__;if(d||j){var M=e(this.__wrapped__),U=M.__actions__=ar(this.__actions__);return U.push({func:R,args:arguments,thisArg:e}),M.__chain__=j,M}return R.apply(e,Ei([this.value()],arguments))})}),e}function Q0(){return Pe._===this&&(Pe._=Ed),this}function _c(){}function Y0(e){return e=ye(e),be(function(i){return Qu(i,e)})}var Z0=Za(Ze),X0=Za(vu),e1=Za(Ia);function dl(e){return sc(e)?xa(Qr(e)):Tg(e)}function t1(e){return function(i){return e==null?r:Bi(e,i)}}var r1=mh(),i1=mh(!0);function Ec(){return[]}function Ic(){return!1}function n1(){return{}}function s1(){return""}function o1(){return!0}function a1(e,i){if(e=ye(e),e<1||e>k)return[];var o=K,c=Gt(e,K);i=ie(i),e-=K;for(var l=Oa(c,i);++o<e;)i(o);return l}function c1(e){return ge(e)?Ze(e,Qr):wr(e)?[e]:ar(Dh(Ne(e)))}function u1(e){var i=++bd;return Ne(e)+i}var h1=lo(function(e,i){return e+i},0),l1=Xa("ceil"),f1=lo(function(e,i){return e/i},1),p1=Xa("floor");function d1(e){return e&&e.length?no(e,hr,Ma):r}function g1(e,i){return e&&e.length?no(e,ie(i,2),Ma):r}function y1(e){return bu(e,hr)}function v1(e,i){return bu(e,ie(i,2))}function m1(e){return e&&e.length?no(e,hr,ka):r}function w1(e,i){return e&&e.length?no(e,ie(i,2),ka):r}var b1=lo(function(e,i){return e*i},1),_1=Xa("round"),E1=lo(function(e,i){return e-i},0);function I1(e){return e&&e.length?Sa(e,hr):0}function x1(e,i){return e&&e.length?Sa(e,ie(i,2)):0}return p.after=Vv,p.ary=Bh,p.assign=$m,p.assignIn=sl,p.assignInWith=Po,p.assignWith=Dm,p.at=Fm,p.before=Vh,p.bind=lc,p.bindAll=U0,p.bindKey=Gh,p.castArray=nm,p.chain=kh,p.chunk=py,p.compact=dy,p.concat=gy,p.cond=z0,p.conforms=k0,p.constant=mc,p.countBy=Iv,p.create=Lm,p.curry=Wh,p.curryRight=Jh,p.debounce=Qh,p.defaults=jm,p.defaultsDeep=Mm,p.defer=Gv,p.delay=Wv,p.difference=yy,p.differenceBy=vy,p.differenceWith=my,p.drop=wy,p.dropRight=by,p.dropRightWhile=_y,p.dropWhile=Ey,p.fill=Iy,p.filter=Pv,p.flatMap=Rv,p.flatMapDeep=Av,p.flatMapDepth=Tv,p.flatten=Mh,p.flattenDeep=xy,p.flattenDepth=Py,p.flip=Jv,p.flow=K0,p.flowRight=B0,p.fromPairs=Sy,p.functions=Bm,p.functionsIn=Vm,p.groupBy=Cv,p.initial=Ry,p.intersection=Ay,p.intersectionBy=Ty,p.intersectionWith=Cy,p.invert=Wm,p.invertBy=Jm,p.invokeMap=$v,p.iteratee=wc,p.keyBy=Dv,p.keys=jt,p.keysIn=ur,p.map=wo,p.mapKeys=Ym,p.mapValues=Zm,p.matches=V0,p.matchesProperty=G0,p.memoize=_o,p.merge=Xm,p.mergeWith=ol,p.method=W0,p.methodOf=J0,p.mixin=bc,p.negate=Eo,p.nthArg=Y0,p.omit=e0,p.omitBy=t0,p.once=Qv,p.orderBy=Fv,p.over=Z0,p.overArgs=Yv,p.overEvery=X0,p.overSome=e1,p.partial=fc,p.partialRight=Yh,p.partition=Lv,p.pick=r0,p.pickBy=al,p.property=dl,p.propertyOf=t1,p.pull=Fy,p.pullAll=Uh,p.pullAllBy=Ly,p.pullAllWith=jy,p.pullAt=My,p.range=r1,p.rangeRight=i1,p.rearg=Zv,p.reject=qv,p.remove=qy,p.rest=Xv,p.reverse=uc,p.sampleSize=zv,p.set=n0,p.setWith=s0,p.shuffle=kv,p.slice=Uy,p.sortBy=Bv,p.sortedUniq=Gy,p.sortedUniqBy=Wy,p.split=R0,p.spread=em,p.tail=Jy,p.take=Qy,p.takeRight=Yy,p.takeRightWhile=Zy,p.takeWhile=Xy,p.tap=dv,p.throttle=tm,p.thru=mo,p.toArray=rl,p.toPairs=cl,p.toPairsIn=ul,p.toPath=c1,p.toPlainObject=nl,p.transform=o0,p.unary=rm,p.union=ev,p.unionBy=tv,p.unionWith=rv,p.uniq=iv,p.uniqBy=nv,p.uniqWith=sv,p.unset=a0,p.unzip=hc,p.unzipWith=zh,p.update=c0,p.updateWith=u0,p.values=En,p.valuesIn=h0,p.without=ov,p.words=fl,p.wrap=im,p.xor=av,p.xorBy=cv,p.xorWith=uv,p.zip=hv,p.zipObject=lv,p.zipObjectDeep=fv,p.zipWith=pv,p.entries=cl,p.entriesIn=ul,p.extend=sl,p.extendWith=Po,bc(p,p),p.add=h1,p.attempt=pl,p.camelCase=d0,p.capitalize=hl,p.ceil=l1,p.clamp=l0,p.clone=sm,p.cloneDeep=am,p.cloneDeepWith=cm,p.cloneWith=om,p.conformsTo=um,p.deburr=ll,p.defaultTo=H0,p.divide=f1,p.endsWith=g0,p.eq=qr,p.escape=y0,p.escapeRegExp=v0,p.every=xv,p.find=Sv,p.findIndex=Lh,p.findKey=qm,p.findLast=Ov,p.findLastIndex=jh,p.findLastKey=Um,p.floor=p1,p.forEach=Hh,p.forEachRight=Kh,p.forIn=zm,p.forInRight=km,p.forOwn=Hm,p.forOwnRight=Km,p.get=gc,p.gt=hm,p.gte=lm,p.has=Gm,p.hasIn=yc,p.head=qh,p.identity=hr,p.includes=Nv,p.indexOf=Oy,p.inRange=f0,p.invoke=Qm,p.isArguments=Wi,p.isArray=ge,p.isArrayBuffer=fm,p.isArrayLike=cr,p.isArrayLikeObject=mt,p.isBoolean=pm,p.isBuffer=Ai,p.isDate=dm,p.isElement=gm,p.isEmpty=ym,p.isEqual=vm,p.isEqualWith=mm,p.isError=pc,p.isFinite=wm,p.isFunction=ui,p.isInteger=Zh,p.isLength=Io,p.isMap=Xh,p.isMatch=bm,p.isMatchWith=_m,p.isNaN=Em,p.isNative=Im,p.isNil=Pm,p.isNull=xm,p.isNumber=el,p.isObject=nt,p.isObjectLike=dt,p.isPlainObject=Xn,p.isRegExp=dc,p.isSafeInteger=Sm,p.isSet=tl,p.isString=xo,p.isSymbol=wr,p.isTypedArray=_n,p.isUndefined=Om,p.isWeakMap=Rm,p.isWeakSet=Am,p.join=Ny,p.kebabCase=m0,p.last=Cr,p.lastIndexOf=$y,p.lowerCase=w0,p.lowerFirst=b0,p.lt=Tm,p.lte=Cm,p.max=d1,p.maxBy=g1,p.mean=y1,p.meanBy=v1,p.min=m1,p.minBy=w1,p.stubArray=Ec,p.stubFalse=Ic,p.stubObject=n1,p.stubString=s1,p.stubTrue=o1,p.multiply=b1,p.nth=Dy,p.noConflict=Q0,p.noop=_c,p.now=bo,p.pad=_0,p.padEnd=E0,p.padStart=I0,p.parseInt=x0,p.random=p0,p.reduce=jv,p.reduceRight=Mv,p.repeat=P0,p.replace=S0,p.result=i0,p.round=_1,p.runInContext=S,p.sample=Uv,p.size=Hv,p.snakeCase=O0,p.some=Kv,p.sortedIndex=zy,p.sortedIndexBy=ky,p.sortedIndexOf=Hy,p.sortedLastIndex=Ky,p.sortedLastIndexBy=By,p.sortedLastIndexOf=Vy,p.startCase=A0,p.startsWith=T0,p.subtract=E1,p.sum=I1,p.sumBy=x1,p.template=C0,p.times=a1,p.toFinite=hi,p.toInteger=ye,p.toLength=il,p.toLower=N0,p.toNumber=Nr,p.toSafeInteger=Nm,p.toString=Ne,p.toUpper=$0,p.trim=D0,p.trimEnd=F0,p.trimStart=L0,p.truncate=j0,p.unescape=M0,p.uniqueId=u1,p.upperCase=q0,p.upperFirst=vc,p.each=Hh,p.eachRight=Kh,p.first=qh,bc(p,function(){var e={};return Wr(p,function(i,o){De.call(p.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),p.VERSION=s,Sr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){p[e].placeholder=p}),Sr(["drop","take"],function(e,i){xe.prototype[e]=function(o){o=o===r?1:Dt(ye(o),0);var c=this.__filtered__&&!i?new xe(this):this.clone();return c.__filtered__?c.__takeCount__=Gt(o,c.__takeCount__):c.__views__.push({size:Gt(o,K),type:e+(c.__dir__<0?"Right":"")}),c},xe.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Sr(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==b||o==J;xe.prototype[e]=function(l){var d=this.clone();return d.__iteratees__.push({iteratee:ie(l,3),type:o}),d.__filtered__=d.__filtered__||c,d}}),Sr(["head","last"],function(e,i){var o="take"+(i?"Right":"");xe.prototype[e]=function(){return this[o](1).value()[0]}}),Sr(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");xe.prototype[e]=function(){return this.__filtered__?new xe(this):this[o](1)}}),xe.prototype.compact=function(){return this.filter(hr)},xe.prototype.find=function(e){return this.filter(e).head()},xe.prototype.findLast=function(e){return this.reverse().find(e)},xe.prototype.invokeMap=be(function(e,i){return typeof e=="function"?new xe(this):this.map(function(o){return Gn(o,e,i)})}),xe.prototype.reject=function(e){return this.filter(Eo(ie(e)))},xe.prototype.slice=function(e,i){e=ye(e);var o=this;return o.__filtered__&&(e>0||i<0)?new xe(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=ye(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},xe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},xe.prototype.toArray=function(){return this.take(K)},Wr(xe.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=p[c?"take"+(i=="last"?"Right":""):i],d=c||/^find/.test(i);l&&(p.prototype[i]=function(){var w=this.__wrapped__,_=c?[1]:arguments,R=w instanceof xe,j=_[0],M=R||ge(w),U=function(_e){var Se=l.apply(p,Ei([_e],_));return c&&V?Se[0]:Se};M&&o&&typeof j=="function"&&j.length!=1&&(R=M=!1);var V=this.__chain__,X=!!this.__actions__.length,ne=d&&!V,we=R&&!X;if(!d&&M){w=we?w:new xe(this);var se=e.apply(w,_);return se.__actions__.push({func:mo,args:[U],thisArg:r}),new Rr(se,V)}return ne&&we?e.apply(this,_):(se=this.thru(U),ne?c?se.value()[0]:se.value():se)})}),Sr(["pop","push","shift","sort","splice","unshift"],function(e){var i=Hs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);p.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var d=this.value();return i.apply(ge(d)?d:[],l)}return this[o](function(w){return i.apply(ge(w)?w:[],l)})}}),Wr(xe.prototype,function(e,i){var o=p[i];if(o){var c=o.name+"";De.call(yn,c)||(yn[c]=[]),yn[c].push({name:i,func:o})}}),yn[ho(r,oe).name]=[{name:"wrapper",func:r}],xe.prototype.clone=Md,xe.prototype.reverse=qd,xe.prototype.value=Ud,p.prototype.at=gv,p.prototype.chain=yv,p.prototype.commit=vv,p.prototype.next=mv,p.prototype.plant=bv,p.prototype.reverse=_v,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=Ev,p.prototype.first=p.prototype.head,Un&&(p.prototype[Un]=wv),p},pn=vd();vt?((vt.exports=pn)._=pn,ze._=pn):Pe._=pn}).call(os)})(Yc,Yc.exports);var gP=Object.defineProperty,yP=Object.defineProperties,vP=Object.getOwnPropertyDescriptors,Cf=Object.getOwnPropertySymbols,mP=Object.prototype.hasOwnProperty,wP=Object.prototype.propertyIsEnumerable,Nf=(n,t,r)=>t in n?gP(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,Co=(n,t)=>{for(var r in t||(t={}))mP.call(t,r)&&Nf(n,r,t[r]);if(Cf)for(var r of Cf(t))wP.call(t,r)&&Nf(n,r,t[r]);return n},bP=(n,t)=>yP(n,vP(t));function Ni(n,t,r){var s;const a=X1(n);return((s=t.rpcMap)==null?void 0:s[a.reference])||`${dP}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function tn(n){return n.includes(":")?n.split(":")[1]:n}function Vp(n){return n.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function _P(n,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(n));if(!r.length)return[];const s=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;s.push(...u)}),s}function EP(n={},t={}){const r=$f(n),s=$f(t);return Yc.exports.merge(r,s)}function $f(n){var t,r,s,a;const u={};if(!An(n))return u;for(const[f,g]of Object.entries(n)){const m=su(f)?[f]:g.chains,y=g.methods||[],E=g.events||[],x=g.rpcMap||{},$=as(f);u[$]=bP(Co(Co({},u[$]),g),{chains:Pc(m,(t=u[$])==null?void 0:t.chains),methods:Pc(y,(r=u[$])==null?void 0:r.methods),events:Pc(E,(s=u[$])==null?void 0:s.events),rpcMap:Co(Co({},x),(a=u[$])==null?void 0:a.rpcMap)})}return u}function IP(n){return n.includes(":")?n.split(":")[2]:n}function xP(n){const t={};for(const[r,s]of Object.entries(n)){const a=s.methods||[],u=s.events||[],f=s.accounts||[],g=su(r)?[r]:s.chains?s.chains:Vp(s.accounts);t[r]={chains:g,methods:a,events:u,accounts:f}}return t}function jc(n){return typeof n=="number"?n:n.includes("0x")?parseInt(n,16):n.includes(":")?Number(n.split(":")[1]):Number(n)}const Gp={},Xe=n=>Gp[n],Mc=(n,t)=>{Gp[n]=t};class PP{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class SP{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const s=r||Ni(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=parseInt(tn(r));t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,s;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class OP{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class RP{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class AP{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const s=this.getCardanoRPCUrl(r),a=tn(r);t[a]=this.createHttpProvider(a,s)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||this.getCardanoRPCUrl(t);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class TP{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class CP{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;const a=tn(r);t[a]=this.createHttpProvider(a,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);return new vi(new $i(s,Xe("disableProviderPing")))}}class NP{constructor(t){this.name="near",this.namespace=t.namespace,this.events=Xe("events"),this.client=Xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const s=r||Ni(`${this.name}:${t}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,s)}this.events.emit(mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var s;t[r]=this.createHttpProvider(r,(s=this.namespace.rpcMap)==null?void 0:s[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const s=this.createHttpProvider(t,r);s&&(this.httpProviders[t]=s)}createHttpProvider(t,r){const s=r||Ni(t,this.namespace);return typeof s>"u"?void 0:new vi(new $i(s,Xe("disableProviderPing")))}}var $P=Object.defineProperty,DP=Object.defineProperties,FP=Object.getOwnPropertyDescriptors,Df=Object.getOwnPropertySymbols,LP=Object.prototype.hasOwnProperty,jP=Object.prototype.propertyIsEnumerable,Ff=(n,t,r)=>t in n?$P(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,No=(n,t)=>{for(var r in t||(t={}))LP.call(t,r)&&Ff(n,r,t[r]);if(Df)for(var r of Df(t))jP.call(t,r)&&Ff(n,r,t[r]);return n},qc=(n,t)=>DP(n,FP(t));class gu{constructor(t){this.events=new Ut,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Go(Jo({level:(t==null?void 0:t.logger)||Af})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new gu(t);return await r.initialize(),r}async request(t,r){const[s,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:No({},t),chainId:`${s}:${a}`,topic:this.session.topic})}sendAsync(t,r,s){this.request(t,s).then(a=>r(null,a)).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:bt("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=xP(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==Kp)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[s,a]=this.validateChain(t);this.getProvider(s).setDefaultChain(a,r)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Xr(r)){for(const s of r)t.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await rP.init({logger:this.providerOpts.logger||Af,relayUrl:this.providerOpts.relayUrl||lP,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>as(r)))];Mc("client",this.client),Mc("events",this.events),Mc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const s=_P(r,this.session),a=Vp(s),u=EP(this.namespaces,this.optionalNamespaces),f=qc(No({},u[r]),{accounts:s,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new SP({namespace:f});break;case"solana":this.rpcProviders[r]=new OP({namespace:f});break;case"cosmos":this.rpcProviders[r]=new RP({namespace:f});break;case"polkadot":this.rpcProviders[r]=new PP({namespace:f});break;case"cip34":this.rpcProviders[r]=new AP({namespace:f});break;case"elrond":this.rpcProviders[r]=new TP({namespace:f});break;case"multiversx":this.rpcProviders[r]=new CP({namespace:f});break;case"near":this.rpcProviders[r]=new NP({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:s}=r;if(s.name==="accountsChanged"){const a=s.data;a&&Xr(a)&&this.events.emit("accountsChanged",a.map(IP))}else if(s.name==="chainChanged"){const a=r.chainId,u=r.event.data,f=as(a),g=jc(a)!==jc(u)?`${f}:${jc(u)}`:a;this.onChainChanged(g)}else this.events.emit(s.name,s.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var s;const{namespaces:a}=r,u=(s=this.client)==null?void 0:s.session.get(t);this.session=qc(No({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",qc(No({},bt("USER_DISCONNECTED")),{data:t.topic}))}),this.on(mi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:s,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",s)}validateChain(t){const[r,s]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,s];if(r&&!Object.keys(this.namespaces||{}).map(f=>as(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&s)return[r,s];const a=as(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var s;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((s=this.namespaces[a])!=null?s:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Tf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Tf}/${t}`)}}const MP=gu,qP="wc",UP="ethereum_provider",zP=`${qP}@2:${UP}:`,kP="https://rpc.walletconnect.com/v1/",Zc=["eth_sendTransaction","personal_sign"],HP=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Xc=["chainChanged","accountsChanged"],KP=["chainChanged","accountsChanged","message","disconnect","connect"];var BP=Object.defineProperty,VP=Object.defineProperties,GP=Object.getOwnPropertyDescriptors,Lf=Object.getOwnPropertySymbols,WP=Object.prototype.hasOwnProperty,JP=Object.prototype.propertyIsEnumerable,jf=(n,t,r)=>t in n?BP(n,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[t]=r,us=(n,t)=>{for(var r in t||(t={}))WP.call(t,r)&&jf(n,r,t[r]);if(Lf)for(var r of Lf(t))JP.call(t,r)&&jf(n,r,t[r]);return n},Mf=(n,t)=>VP(n,GP(t));function Ko(n){return Number(n[0].split(":")[1])}function Uc(n){return`0x${n.toString(16)}`}function QP(n){const{chains:t,optionalChains:r,methods:s,optionalMethods:a,events:u,optionalEvents:f,rpcMap:g}=n;if(!Xr(t))throw new Error("Invalid chains");const m={chains:t,methods:s||Zc,events:u||Xc,rpcMap:us({},t.length?{[Ko(t)]:g[Ko(t)]}:{})},y=u==null?void 0:u.filter(L=>!Xc.includes(L)),E=s==null?void 0:s.filter(L=>!Zc.includes(L));if(!r&&!f&&!a&&!(y!=null&&y.length)&&!(E!=null&&E.length))return{required:t.length?m:void 0};const x=(y==null?void 0:y.length)&&(E==null?void 0:E.length)||!r,$={chains:[...new Set(x?m.chains.concat(r||[]):r)],methods:[...new Set(m.methods.concat(a!=null&&a.length?a:HP))],events:[...new Set(m.events.concat(f!=null&&f.length?f:KP))],rpcMap:g};return{required:t.length?m:void 0,optional:r.length?$:void 0}}class yu{constructor(){this.events=new Ut.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=zP,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new yu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:s}=QP(this.rpc);try{const a=await new Promise(async(f,g)=>{var m;this.rpc.showQrModal&&((m=this.modal)==null||m.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Mf(us({namespaces:us({},r&&{[this.namespace]:r})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{f(y)}).catch(y=>{g(new Error(y.message))})});if(!a)return;const u=ew(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:Uc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:s}=r;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Uc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",Mf(us({},bt("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,s;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(s=this.modal)==null||s.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Uc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,s,a]=t.split(":");return{chainId:`${r}:${s}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,s;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(s=t==null?void 0:t.optionalChains)!=null?s:[],f=a.concat(u);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=a.length?(t==null?void 0:t.methods)||Zc:[],m=a.length?(t==null?void 0:t.events)||Xc:[],y=(t==null?void 0:t.optionalMethods)||[],E=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),$=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map(L=>this.formatChainId(L)),optionalChains:u.map(L=>this.formatChainId(L)),methods:g,events:m,optionalMethods:y,optionalEvents:E,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:$,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const s={};return t.forEach(a=>{s[a]=this.getRpcUrl(a,r)}),s}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Ko(this.rpc.chains):Ko(this.rpc.optionalChains),this.signer=await MP.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:s}=await P1(()=>import("./chunk-f28fdbb0.js").then(a=>a.i),["js/chunk-f28fdbb0.js","js/app-a93d0564.js"]);r=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(us({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:s,rpcMap:a}=t;r&&Xr(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),s&&Xr(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(u=>this.formatChainId(u)),s.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var s;return((s=this.rpc.rpcMap)==null?void 0:s[t])||`${kP}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const yS=yu;export{yS as EthereumProvider,KP as OPTIONAL_EVENTS,HP as OPTIONAL_METHODS,Xc as REQUIRED_EVENTS,Zc as REQUIRED_METHODS,yu as default};
//# sourceMappingURL=chunk-042a6f46.js.map
