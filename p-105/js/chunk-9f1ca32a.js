import{a0 as E,S as $,i as R,s as V,f as k,h as G,j as M,k as v,l as y,o as U,p as g,q as F,r as C,u as P,v as m,n as K,L as W,M as H,c as Q,a as j,m as z,N as J,t as X,b as Z,d as ee,g as te}from"./chunk-dd975def.js";import{q as L,f as ie,m as Y}from"./app-5c09a141.js";import{a_ as ae,a$ as ce,b0 as re,b1 as ne,aC as oe,b2 as se,b3 as le,b4 as ue,b5 as de,as as fe}from"./chunk-8016f002.js";import{p as w,g as N,I as S,$ as D,t as _,r as he,x as ge}from"./chunk-e0c46928.js";import{f as I,P as A,e as T,m as O}from"./chunk-65793be5.js";import{o as me}from"./chunk-113b1735.js";import{e as b,S as B,a as f}from"./chunk-d0451701.js";import{K as _e,o as ke,a as ve}from"./chunk-c7fd296c.js";import{K as ye}from"./chunk-5c669679.js";import{T as Ce}from"./chunk-ff1e8403.js";import{o as Se,R as pe}from"./chunk-29571520.js";import{l as x}from"./chunk-2bd84ce4.js";function Ue(i){const e=E(I),a=i?`?${L.stringify(i)}`:"";N(`${e(A.FIAT_DEPOSIT.pathname)}${a}`)}function we(i){const{LG:e,statusCode:a}=i,t=w.create(ye,{statusCode:a,passLG:e});t.$on("finish",function(){t.$destroy(),be()}),t.$on("close",function(){t.$destroy()})}function be(){const i=E(I);N(i(A.ACCOUNT_VERIFICATION.pathname)+"?"+L.stringify({popupKycEntry:"Kyc"}))}function Ee(i){let e,a,t,n,c,r,s;return{c(){e=k("div"),a=k("div"),t=k("i"),n=G(""),c=M(),r=k("div"),this.h()},l(o){e=v(o,"DIV",{class:!0});var u=y(e);a=v(u,"DIV",{class:!0});var h=y(a);t=v(h,"I",{class:!0});var l=y(t);n=U(l,""),l.forEach(g),h.forEach(g),c=F(u),r=v(u,"DIV",{class:!0}),y(r).forEach(g),u.forEach(g),this.h()},h(){C(t,"class","ok-img iconfont f14 cf svelte-1ais7vr"),C(a,"class","checked-icon svelte-1ais7vr"),C(r,"class","triangle-badge svelte-1ais7vr"),C(e,"class","check-box svelte-1ais7vr"),e.hidden=s=!i[0]},m(o,u){P(o,e,u),m(e,a),m(a,t),m(t,n),m(e,c),m(e,r)},p(o,[u]){u&1&&s!==(s=!o[0])&&(e.hidden=s)},i:K,o:K,d(o){o&&g(e)}}}function Le(i,e,a){let{checked:t}=e;return i.$$set=n=>{"checked"in n&&a(0,t=n.checked)},[t]}class We extends ${constructor(e){super(),R(this,e,Le,Ee,V,{checked:0})}}async function De(i){const e=w.create(Ce,i);return new Promise(a=>{e.$on("write-successful",function(t){e.$destroy(),a(t.detail)}),e.$on("close",function(){e.$destroy(),a(null)})})}function Ie(i,{LG:e}){var n;const a=(n=i==null?void 0:i.error)==null?void 0:n.code;return Object.values(_e).find(c=>c===a)?(ke({kycStatusCode:a,LG:e}),!0):a===100618?De({LG:e}):!1}function Ae(i,{LG:e}){var n;const a=(n=i==null?void 0:i.error)==null?void 0:n.code,t=ae[a];return a&&t?(a===70022?w.create(ce,{LG:e}):a===70023?w.create(re,{LG:e}):a===70024?w.create(ne,{LG:e}):we({LG:e,statusCode:a}),!1):!0}function Ke(i,{LG:e}){var n;const a=(n=i==null?void 0:i.error)==null?void 0:n.code,t=pe[a];return t?(Se({limitType:t,LG:e}),!0):!1}function He(i){return b([{name:"withMainAccount",step:()=>he.pipe(ie(e=>!!e.userId),ge(1),_(e=>{if(!e.isMain)throw ve(i.LG,i==null?void 0:i.introduction),new f("show check main account dialog")}),Y(e=>e))}],i)}function Qe(i){return b([{name:"validateKYC",step(e,a){const{side:t="buy",LG:n}=a;return S(()=>D.postKycValidate({side:t})).pipe(T(c=>{var o;if(c!=null&&c.data)throw new B(!0);const r=Ie(c,i);if(r===!0)throw new f(((o=c==null?void 0:c.error)==null?void 0:o.message)||"kyc checksum failure");if(r)return r;const s=c==null?void 0:c.error;if(s)throw O.send("toast","error",s),new f(s.message)}),_(c=>{if(!c)throw new f("A mobile phone number is required")}),T(oe.getAllKycSummary),_(c=>{const{advanceKycStatus:r,basicKycStatus:s}=(c==null?void 0:c.data)||{};if(!(r==="Verified"&&s==="Verified")){const o=E(I);throw window.location.assign(o(A.ACCOUNT_VERIFICATION.pathname)+"?"+L.stringify({popupKycEntry:"Kyc"})),new f("phone number checksum failure")}}))}}],i)}function je(i){return b([{name:"getLegendKYCStatus",step(e,a){return S(se.getKycApprovedStatusV2).pipe(_(t=>{const{data:n}=t;if(n)throw new B(!0)}))}},{name:"getPhemexKYCStatus",step(e,a){return S(D.getPhemexAndLegendKYCStatus).pipe(_(t=>{var r,s;if(!Ae(t,a))throw new f((r=t==null?void 0:t.error)==null?void 0:r.message);const c=t==null?void 0:t.error;if(c)throw O.send("toast","error",c),new f((s=t==null?void 0:t.error)==null?void 0:s.message)}),Y(()=>e))}},{name:"writeLegendQuestionnaire",step(e,a){const{error:t,data:n}=e,{LG:c}=a,r=le[t==null?void 0:t.code];if(r){if(r==="WRITE_QUESTIONNAIRE")return S(()=>ue({LG:c})).pipe(_(s=>{if(!s)throw new f("write questionnaire failed")}));if(r)return S(()=>de({LG:i==null?void 0:i.LG,legendKycStatus:r})).pipe(_(s=>{if(!s)throw new f("query kyc failed")}))}throw t}}],i)}function ze(i){return b([{name:"checkRiskLimitForLegendChannel",step(e,a){const{LG:t,side:n,fiatCurrency:c,digitalCurrency:r}=a,s=n==="sell"?["CP_B2C_CREDIT_DEBIT_SELL"]:["CP_B2C_CREDIT_DEBIT_LEGEND_BUY"];return S(()=>D.checkRisk({checkPoint:s,fiatCurrency:c,digitalCurrency:r})).pipe(_(o=>{var l;if(Ke(o,{LG:t}))throw new f((l=o==null?void 0:o.error)==null?void 0:l.message);const h=o==null?void 0:o.error;if(h){const d=h==null?void 0:h.message;throw me({LG:t,content:d}),new f(d)}}))}}],i)}function Te(i){let e,a,t,n,c,r,s=i[1](x.YouHaveReadAnd,{Disclaimer:`<a href="https://phemex.com/help-center/disclaimer-bank-transfer" target="term-service">${i[1](x.Disclaimer)}</a>`,LegendTrading:'<a href="https://legendtrading.com" target="privacy-policy">Legend Trading</a>'})+"",o;function u(l){i[2](l)}let h={class:"product-checkbox"};return i[0]!==void 0&&(h.checked=i[0]),t=new fe({props:h}),W.push(()=>H(t,"checked",u)),{c(){e=k("div"),a=k("div"),Q(t.$$.fragment),c=M(),r=k("div"),this.h()},l(l){e=v(l,"DIV",{class:!0});var d=y(e);a=v(d,"DIV",{class:!0});var p=y(a);j(t.$$.fragment,p),p.forEach(g),c=F(d),r=v(d,"DIV",{class:!0});var q=y(r);q.forEach(g),d.forEach(g),this.h()},h(){C(a,"class","agree-service pr svelte-rpvk26"),C(r,"class","ml6"),C(e,"class","service-box df mt28 svelte-rpvk26")},m(l,d){P(l,e,d),m(e,a),z(t,a,null),m(e,c),m(e,r),r.innerHTML=s,o=!0},p(l,[d]){const p={};!n&&d&1&&(n=!0,p.checked=l[0],J(()=>n=!1)),t.$set(p)},i(l){o||(X(t.$$.fragment,l),o=!0)},o(l){Z(t.$$.fragment,l),o=!1},d(l){l&&g(e),ee(t)}}}function xe(i,e,a){let{isAgreeService:t}=e;const n=te("LG");function c(r){t=r,a(0,t)}return i.$$set=r=>{"isAgreeService"in r&&a(0,t=r.isAgreeService)},[t,n,c]}class Je extends ${constructor(e){super(),R(this,e,xe,Te,V,{isAgreeService:0})}}export{We as B,Je as F,Qe as a,Ie as b,Ke as c,je as d,He as e,ze as f,Ue as g};
//# sourceMappingURL=chunk-9f1ca32a.js.map
