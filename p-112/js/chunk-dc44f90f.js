import{aV as f,aW as x,ar as M,aX as w,aN as $,az as L,$ as P,M as A,B as a}from"./chunk-707a9f2f.js";import{a as F}from"./chunk-d2488ba6.js";import{S as u,B as o,m as l}from"./app-7aa7d139.js";const b=new u,g=new u,v=new o(p()),d=new o([]),Q=new o(null),Y=new o(null),Z=new o(0),_=new o(0),S=new o([]),h=new o([]),R=new o([]),T=new o("--");g.pipe(f(w),x(e=>U(e)),l(G)).subscribe(e=>v.next(e));v.pipe(l(X)).subscribe(e=>T.next(e));d.pipe(l(y)).subscribe(e=>S.next(e));d.pipe(l(W)).subscribe(e=>h.next(e));d.pipe(l(I)).subscribe(e=>R.next(e));M([v,$]).pipe(l(N)).subscribe(e=>d.next(e));async function U(e){b.next(!0);const{data:t,error:i}=await L.getProduct(e);if(b.next(!1),t)return t;if(i)return P.send("toast","error",i),p()}const D=new u,k=new o([]);D.pipe(f(w),x(()=>j())).subscribe(e=>k.next(e));async function j(){const{data:e,error:t}=await F.getTasksList();return e?e.rows:(t&&P.send("toast","error",t),[])}const q=new u,B=new o(p());q.pipe(f(w),x(e=>O(e))).subscribe(e=>B.next(e));async function O(e){const{data:t,error:i}=await L.getProductOnly(e);if(t)return t;if(i)return P.send("toast","error",i),p()}function p(){return{total:0,rows:[]}}const ee=new u,te=new o(V());function V(){return{id:1,name:"activity",productId:202,beginTime:1630944e6,endTime:1631808e6,minUsdtEv:1e10,minBtcEv:3e5,multiplier:100}}function y(e){return e.map(t=>{const{currency:i,rateEr:r,userMinLimitEv:n,userMaxLimitEv:s}=t,c=t.poolMaxLimitEv<t.userMaxLimitEv?t.poolMaxLimitEv:t.userMaxLimitEv;return{...t,coinUrl:A.getUrl(i),rate:a.floor(r,2,6),userMinLimit:i==="USDT"?a.floor(t.userMinLimitEv,0,8):a.parseFloat(n,8,8),calcMaxLimit:i==="USDT"?a.floor(c,0,8):a.parseFloat(c,8,8),calcMaxLimitEv:c}})}function W(e){const i=e.filter(({calculationPeriodMultiplier:r})=>r===1).map(r=>({...r,ladderApyVos:r.ladderApyVos?r.ladderApyVos.map(n=>({...n,lowerAmount:String(a.delimit(a.floor(n.lowerAmountEv,r.valuePrecision,r.valueScale))).split(".")[0],upperAmount:String(a.delimit(a.floor(n.upperAmountEv,r.valuePrecision,r.valueScale))).split(".")[0],ratio:a.floor(n.ratioEr,2,6)})):[]}));return y(i)}function C(e,t){const i={productId:t.productId,calculationPeriodMultiplier:t.calculationPeriodMultiplier,rateEr:t.rateEr,valuePrecision:t.valuePrecision};return(e.calculationPeriodList?[...e.calculationPeriodList,i]:[i]).sort((n,s)=>n.calculationPeriodMultiplier-s.calculationPeriodMultiplier)}function z(e,t,i){if(!e[t.currency]){const r=i.filter(n=>n.currency===t.currency);return r[r.length>1?1:0]}return e[t.currency]}function I(e){const i=e.filter(({calculationPeriodMultiplier:n})=>n!==1).reduce((n,s,c,E)=>{const m=z(n,s,E);return m.calculationPeriodList=C(m,s),{...n,[s.currency]:m}},{}),r=Object.values(i).map(n=>n);return y(r)}function N([e,t]){return e.rows.reduce((i,r,n)=>{const s=t.find(({currency:c})=>c===r.currency);return s?[...i,{...r,valuePrecision:s.valuePrecision,valueScale:s.valueScale,name:s.name}]:i},[])}function X(e){const t=e.rows.map(r=>r.rateEr);if(t.length<1)return"--";const i=Math.max(...t);return a.floor(i,2,6)}function G(e){if(e&&e.rows)return{...e,rows:e.rows.map(t=>({...t,productType:t.calculationPeriodMultiplier===1?1:2}))}}export{Z as a,_ as b,Q as c,Y as d,h as e,R as f,T as g,S as h,te as i,B as j,q as k,D as l,ee as m,v as p,g as q,k as t};
//# sourceMappingURL=chunk-dc44f90f.js.map
